/*!
 * MIT License
 * 
 * Copyright (c) 2018 Marco Bolis
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 * 
 */
/*
@license-banner-plugin
mainloop.js@1.0.4
  author: Isaac Sukin (http://www.isaacsukin.com/)
  license: MIT
  repository: git://github.com/IceCreamYou/MainLoop.js.git
codemirror@5.44.0
  author: Marijn Haverbeke <marijnh@gmail.com> (http://marijnhaverbeke.nl)
  license: MIT
  repository: git+https://github.com/codemirror/CodeMirror.git
css-loader@2.1.1
  author: Tobias Koppers @sokra
  license: MIT
  repository: git+https://github.com/webpack-contrib/css-loader.git
style-loader@0.23.1
  author: Tobias Koppers @sokra
  license: MIT
  repository: git+https://github.com/webpack-contrib/style-loader.git
js-interpreter@1.4.6
  author: Amin Marashi
  license: Apache-2.0
  repository: git+https://github.com/aminmarashi/JS-Interpreter.git
*/!function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=4)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.deg2rad=function(t){return t/180*Math.PI},e.rad2deg=function(t){return 180*t/Math.PI};var i=function(){function t(t,e){void 0===t&&(t=0),void 0===e&&(e=0),this.x=t,this.y=e}return t.x=function(e){return new t(e,0)},t.y=function(e){return new t(0,e)},t.polar=function(e,r){return t.y(r).rotate(e)},t.prototype.plus=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.minus=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.scale=function(e){return new t(e*this.x,e*this.y)},t.prototype.rotate=function(e){return new t(this.x*Math.cos(e)-this.y*Math.sin(e),this.x*Math.sin(e)+this.y*Math.cos(e))},t.prototype.segmentTo=function(t){return new o(this,t)},t.prototype.segmentBy=function(t){return new o(this,this.plus(t))},t.prototype.toString=function(){return"("+this.x+","+this.y+")"},t}();function n(t){return new i(t[0],t[1])}e.Vector2d=i,function(t){t.ORIGIN=new t}(i=e.Vector2d||(e.Vector2d={})),e.Vector2d=i,e.coords2Vector2d=n;var o=function(){function t(t,e){this.from=t instanceof i?t:n(t),this.to=e instanceof i?e:n(e)}return Object.defineProperty(t.prototype,"length",{get:function(){if(void 0===this._length){var t=this.to.minus(this.from);this._length=Math.sqrt(t.x*t.x+t.y*t.y)}return this._length},enumerable:!0,configurable:!0}),t.prototype.draw=function(t){t.beginPath(),t.moveTo(this.from.x,this.from.y),t.lineTo(this.to.x,this.to.y),t.stroke()},t.prototype.lerp=function(e){if(e<0||e>1)throw new Error("Cannot generate line with ratio="+e);var r=this.to.minus(this.from).scale(e);return new t(this.from,this.from.plus(r))},t.prototype.scaled=function(e){return new t(this.from.scale(e),this.to.scale(e))},t.prototype.toString=function(){return this.from+"->"+this.to},t}();e.Segment=o;var s=function(){function t(t){void 0===t&&(t=[]),this.fragments=t.map(function(t){return t instanceof o?t:new o((e=t)[0],e[1]);var e})}return t.prototype.draw=function(t){t.save(),this.fragments.forEach(function(e){return e.draw(t)}),t.restore()},t.prototype.push=function(e){return new t(this.fragments.concat(e))},Object.defineProperty(t.prototype,"totalLength",{get:function(){for(var t=0,e=0;e<this.fragments.length;e++){t+=this.fragments[e].length}return t},enumerable:!0,configurable:!0}),t.prototype.scaled=function(e){return new t(this.fragments.map(function(t){return t.scaled(e)}))},t.prototype.toString=function(){return this.fragments.join(", ")},t}();e.Path=s},function(t,e,r){var i,n;
/**
 * mainloop.js 1.0.3-20170529
 *
 * @author Isaac Sukin (http://www.isaacsukin.com/)
 * @license MIT
 */!function(o){function s(t){if(a=k(s),!(t<u+m)){for(c+=t-u,u=t,C(t,c),t>d+f&&(h=p*g*1e3/(t-d)+(1-p)*h,d=t,g=0),g++,v=0;c>=l;)if(N(l),c-=l,++v>=240){w=!0;break}P(c/l),T(h,w),w=!1}}var a,l=1e3/60,c=0,u=0,h=60,p=.9,f=1e3,d=0,g=0,v=0,m=0,y=!1,b=!1,w=!1,x="object"==typeof window?window:o,k=x.requestAnimationFrame||function(){var t,e,r=Date.now();return function(i){return t=Date.now(),e=Math.max(0,l-(t-r)),r=t+e,setTimeout(function(){i(t+e)},e)}}(),S=x.cancelAnimationFrame||clearTimeout,E=function(){},C=E,N=E,P=E,T=E;o.MainLoop={getSimulationTimestep:function(){return l},setSimulationTimestep:function(t){return l=t,this},getFPS:function(){return h},getMaxAllowedFPS:function(){return 1e3/m},setMaxAllowedFPS:function(t){return void 0===t&&(t=1/0),0===t?this.stop():m=1e3/t,this},resetFrameDelta:function(){var t=c;return c=0,t},setBegin:function(t){return C=t||C,this},setUpdate:function(t){return N=t||N,this},setDraw:function(t){return P=t||P,this},setEnd:function(t){return T=t||T,this},start:function(){return b||(b=!0,a=k(function(t){P(1),y=!0,u=t,d=t,g=0,a=k(s)})),this},stop:function(){return y=!1,b=!1,S(a),this},isRunning:function(){return y}},i=o.MainLoop,void 0===(n="function"==typeof i?i.call(e,r,e,t):i)||(t.exports=n)}(this)},function(t,e,r){t.exports=function(){"use strict";var t=navigator.userAgent,e=navigator.platform,r=/gecko\/\d/i.test(t),i=/MSIE \d/.test(t),n=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(t),o=/Edge\/(\d+)/.exec(t),s=i||n||o,a=s&&(i?document.documentMode||6:+(o||n)[1]),l=!o&&/WebKit\//.test(t),c=l&&/Qt\/\d+\.\d+/.test(t),u=!o&&/Chrome\//.test(t),h=/Opera\//.test(t),p=/Apple Computer/.test(navigator.vendor),f=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(t),d=/PhantomJS/.test(t),g=!o&&/AppleWebKit/.test(t)&&/Mobile\/\w+/.test(t),v=/Android/.test(t),m=g||v||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(t),y=g||/Mac/.test(e),b=/\bCrOS\b/.test(t),w=/win/i.test(e),x=h&&t.match(/Version\/(\d*\.\d*)/);x&&(x=Number(x[1])),x&&x>=15&&(h=!1,l=!0);var k=y&&(c||h&&(null==x||x<12.11)),S=r||s&&a>=9;function E(t){return new RegExp("(^|\\s)"+t+"(?:$|\\s)\\s*")}var C,N=function(t,e){var r=t.className,i=E(e).exec(r);if(i){var n=r.slice(i.index+i[0].length);t.className=r.slice(0,i.index)+(n?i[1]+n:"")}};function P(t){for(var e=t.childNodes.length;e>0;--e)t.removeChild(t.firstChild);return t}function T(t,e){return P(t).appendChild(e)}function A(t,e,r,i){var n=document.createElement(t);if(r&&(n.className=r),i&&(n.style.cssText=i),"string"==typeof e)n.appendChild(document.createTextNode(e));else if(e)for(var o=0;o<e.length;++o)n.appendChild(e[o]);return n}function R(t,e,r,i){var n=A(t,e,r,i);return n.setAttribute("role","presentation"),n}function O(t,e){if(3==e.nodeType&&(e=e.parentNode),t.contains)return t.contains(e);do{if(11==e.nodeType&&(e=e.host),e==t)return!0}while(e=e.parentNode)}function L(){var t;try{t=document.activeElement}catch(e){t=document.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function _(t,e){var r=t.className;E(e).test(r)||(t.className+=(r?" ":"")+e)}function M(t,e){for(var r=t.split(" "),i=0;i<r.length;i++)r[i]&&!E(r[i]).test(e)&&(e+=" "+r[i]);return e}C=document.createRange?function(t,e,r,i){var n=document.createRange();return n.setEnd(i||t,r),n.setStart(t,e),n}:function(t,e,r){var i=document.body.createTextRange();try{i.moveToElementText(t.parentNode)}catch(t){return i}return i.collapse(!0),i.moveEnd("character",r),i.moveStart("character",e),i};var I=function(t){t.select()};function D(t){var e=Array.prototype.slice.call(arguments,1);return function(){return t.apply(null,e)}}function F(t,e,r){for(var i in e||(e={}),t)!t.hasOwnProperty(i)||!1===r&&e.hasOwnProperty(i)||(e[i]=t[i]);return e}function B(t,e,r,i,n){null==e&&-1==(e=t.search(/[^\s\u00a0]/))&&(e=t.length);for(var o=i||0,s=n||0;;){var a=t.indexOf("\t",o);if(a<0||a>=e)return s+(e-o);s+=a-o,s+=r-s%r,o=a+1}}g?I=function(t){t.selectionStart=0,t.selectionEnd=t.value.length}:s&&(I=function(t){try{t.select()}catch(t){}});var U=function(){this.id=null};function j(t,e){for(var r=0;r<t.length;++r)if(t[r]==e)return r;return-1}U.prototype.set=function(t,e){clearTimeout(this.id),this.id=setTimeout(e,t)};var W=30,V={toString:function(){return"CodeMirror.Pass"}},z={scroll:!1},H={origin:"*mouse"},Y={origin:"+move"};function G(t,e,r){for(var i=0,n=0;;){var o=t.indexOf("\t",i);-1==o&&(o=t.length);var s=o-i;if(o==t.length||n+s>=e)return i+Math.min(s,e-n);if(n+=o-i,i=o+1,(n+=r-n%r)>=e)return i}}var q=[""];function X(t){for(;q.length<=t;)q.push(K(q)+" ");return q[t]}function K(t){return t[t.length-1]}function $(t,e){for(var r=[],i=0;i<t.length;i++)r[i]=e(t[i],i);return r}function J(){}function Z(t,e){var r;return Object.create?r=Object.create(t):(J.prototype=t,r=new J),e&&F(e,r),r}var Q=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;function tt(t){return/\w/.test(t)||t>""&&(t.toUpperCase()!=t.toLowerCase()||Q.test(t))}function et(t,e){return e?!!(e.source.indexOf("\\w")>-1&&tt(t))||e.test(t):tt(t)}function rt(t){for(var e in t)if(t.hasOwnProperty(e)&&t[e])return!1;return!0}var it=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function nt(t){return t.charCodeAt(0)>=768&&it.test(t)}function ot(t,e,r){for(;(r<0?e>0:e<t.length)&&nt(t.charAt(e));)e+=r;return e}function st(t,e,r){for(var i=e>r?-1:1;;){if(e==r)return e;var n=(e+r)/2,o=i<0?Math.ceil(n):Math.floor(n);if(o==e)return t(o)?e:r;t(o)?r=o:e=o+i}}function at(t,e,i){var n=this;this.input=i,n.scrollbarFiller=A("div",null,"CodeMirror-scrollbar-filler"),n.scrollbarFiller.setAttribute("cm-not-content","true"),n.gutterFiller=A("div",null,"CodeMirror-gutter-filler"),n.gutterFiller.setAttribute("cm-not-content","true"),n.lineDiv=R("div",null,"CodeMirror-code"),n.selectionDiv=A("div",null,null,"position: relative; z-index: 1"),n.cursorDiv=A("div",null,"CodeMirror-cursors"),n.measure=A("div",null,"CodeMirror-measure"),n.lineMeasure=A("div",null,"CodeMirror-measure"),n.lineSpace=R("div",[n.measure,n.lineMeasure,n.selectionDiv,n.cursorDiv,n.lineDiv],null,"position: relative; outline: none");var o=R("div",[n.lineSpace],"CodeMirror-lines");n.mover=A("div",[o],null,"position: relative"),n.sizer=A("div",[n.mover],"CodeMirror-sizer"),n.sizerWidth=null,n.heightForcer=A("div",null,null,"position: absolute; height: "+W+"px; width: 1px;"),n.gutters=A("div",null,"CodeMirror-gutters"),n.lineGutter=null,n.scroller=A("div",[n.sizer,n.heightForcer,n.gutters],"CodeMirror-scroll"),n.scroller.setAttribute("tabIndex","-1"),n.wrapper=A("div",[n.scrollbarFiller,n.gutterFiller,n.scroller],"CodeMirror"),s&&a<8&&(n.gutters.style.zIndex=-1,n.scroller.style.paddingRight=0),l||r&&m||(n.scroller.draggable=!0),t&&(t.appendChild?t.appendChild(n.wrapper):t(n.wrapper)),n.viewFrom=n.viewTo=e.first,n.reportedViewFrom=n.reportedViewTo=e.first,n.view=[],n.renderedView=null,n.externalMeasured=null,n.viewOffset=0,n.lastWrapHeight=n.lastWrapWidth=0,n.updateLineNumbers=null,n.nativeBarWidth=n.barHeight=n.barWidth=0,n.scrollbarsClipped=!1,n.lineNumWidth=n.lineNumInnerWidth=n.lineNumChars=null,n.alignWidgets=!1,n.cachedCharWidth=n.cachedTextHeight=n.cachedPaddingH=null,n.maxLine=null,n.maxLineLength=0,n.maxLineChanged=!1,n.wheelDX=n.wheelDY=n.wheelStartX=n.wheelStartY=null,n.shift=!1,n.selForContextMenu=null,n.activeTouch=null,i.init(n)}function lt(t,e){if((e-=t.first)<0||e>=t.size)throw new Error("There is no line "+(e+t.first)+" in the document.");for(var r=t;!r.lines;)for(var i=0;;++i){var n=r.children[i],o=n.chunkSize();if(e<o){r=n;break}e-=o}return r.lines[e]}function ct(t,e,r){var i=[],n=e.line;return t.iter(e.line,r.line+1,function(t){var o=t.text;n==r.line&&(o=o.slice(0,r.ch)),n==e.line&&(o=o.slice(e.ch)),i.push(o),++n}),i}function ut(t,e,r){var i=[];return t.iter(e,r,function(t){i.push(t.text)}),i}function ht(t,e){var r=e-t.height;if(r)for(var i=t;i;i=i.parent)i.height+=r}function pt(t){if(null==t.parent)return null;for(var e=t.parent,r=j(e.lines,t),i=e.parent;i;e=i,i=i.parent)for(var n=0;i.children[n]!=e;++n)r+=i.children[n].chunkSize();return r+e.first}function ft(t,e){var r=t.first;t:do{for(var i=0;i<t.children.length;++i){var n=t.children[i],o=n.height;if(e<o){t=n;continue t}e-=o,r+=n.chunkSize()}return r}while(!t.lines);for(var s=0;s<t.lines.length;++s){var a=t.lines[s],l=a.height;if(e<l)break;e-=l}return r+s}function dt(t,e){return e>=t.first&&e<t.first+t.size}function gt(t,e){return String(t.lineNumberFormatter(e+t.firstLineNumber))}function vt(t,e,r){if(void 0===r&&(r=null),!(this instanceof vt))return new vt(t,e,r);this.line=t,this.ch=e,this.sticky=r}function mt(t,e){return t.line-e.line||t.ch-e.ch}function yt(t,e){return t.sticky==e.sticky&&0==mt(t,e)}function bt(t){return vt(t.line,t.ch)}function wt(t,e){return mt(t,e)<0?e:t}function xt(t,e){return mt(t,e)<0?t:e}function kt(t,e){return Math.max(t.first,Math.min(e,t.first+t.size-1))}function St(t,e){if(e.line<t.first)return vt(t.first,0);var r=t.first+t.size-1;return e.line>r?vt(r,lt(t,r).text.length):function(t,e){var r=t.ch;return null==r||r>e?vt(t.line,e):r<0?vt(t.line,0):t}(e,lt(t,e.line).text.length)}function Et(t,e){for(var r=[],i=0;i<e.length;i++)r[i]=St(t,e[i]);return r}var Ct=!1,Nt=!1;function Pt(t,e,r){this.marker=t,this.from=e,this.to=r}function Tt(t,e){if(t)for(var r=0;r<t.length;++r){var i=t[r];if(i.marker==e)return i}}function At(t,e){for(var r,i=0;i<t.length;++i)t[i]!=e&&(r||(r=[])).push(t[i]);return r}function Rt(t,e){if(e.full)return null;var r=dt(t,e.from.line)&&lt(t,e.from.line).markedSpans,i=dt(t,e.to.line)&&lt(t,e.to.line).markedSpans;if(!r&&!i)return null;var n=e.from.ch,o=e.to.ch,s=0==mt(e.from,e.to),a=function(t,e,r){var i;if(t)for(var n=0;n<t.length;++n){var o=t[n],s=o.marker,a=null==o.from||(s.inclusiveLeft?o.from<=e:o.from<e);if(a||o.from==e&&"bookmark"==s.type&&(!r||!o.marker.insertLeft)){var l=null==o.to||(s.inclusiveRight?o.to>=e:o.to>e);(i||(i=[])).push(new Pt(s,o.from,l?null:o.to))}}return i}(r,n,s),l=function(t,e,r){var i;if(t)for(var n=0;n<t.length;++n){var o=t[n],s=o.marker,a=null==o.to||(s.inclusiveRight?o.to>=e:o.to>e);if(a||o.from==e&&"bookmark"==s.type&&(!r||o.marker.insertLeft)){var l=null==o.from||(s.inclusiveLeft?o.from<=e:o.from<e);(i||(i=[])).push(new Pt(s,l?null:o.from-e,null==o.to?null:o.to-e))}}return i}(i,o,s),c=1==e.text.length,u=K(e.text).length+(c?n:0);if(a)for(var h=0;h<a.length;++h){var p=a[h];if(null==p.to){var f=Tt(l,p.marker);f?c&&(p.to=null==f.to?null:f.to+u):p.to=n}}if(l)for(var d=0;d<l.length;++d){var g=l[d];if(null!=g.to&&(g.to+=u),null==g.from){var v=Tt(a,g.marker);v||(g.from=u,c&&(a||(a=[])).push(g))}else g.from+=u,c&&(a||(a=[])).push(g)}a&&(a=Ot(a)),l&&l!=a&&(l=Ot(l));var m=[a];if(!c){var y,b=e.text.length-2;if(b>0&&a)for(var w=0;w<a.length;++w)null==a[w].to&&(y||(y=[])).push(new Pt(a[w].marker,null,null));for(var x=0;x<b;++x)m.push(y);m.push(l)}return m}function Ot(t){for(var e=0;e<t.length;++e){var r=t[e];null!=r.from&&r.from==r.to&&!1!==r.marker.clearWhenEmpty&&t.splice(e--,1)}return t.length?t:null}function Lt(t){var e=t.markedSpans;if(e){for(var r=0;r<e.length;++r)e[r].marker.detachLine(t);t.markedSpans=null}}function _t(t,e){if(e){for(var r=0;r<e.length;++r)e[r].marker.attachLine(t);t.markedSpans=e}}function Mt(t){return t.inclusiveLeft?-1:0}function It(t){return t.inclusiveRight?1:0}function Dt(t,e){var r=t.lines.length-e.lines.length;if(0!=r)return r;var i=t.find(),n=e.find(),o=mt(i.from,n.from)||Mt(t)-Mt(e);if(o)return-o;var s=mt(i.to,n.to)||It(t)-It(e);return s||e.id-t.id}function Ft(t,e){var r,i=Nt&&t.markedSpans;if(i)for(var n=void 0,o=0;o<i.length;++o)(n=i[o]).marker.collapsed&&null==(e?n.from:n.to)&&(!r||Dt(r,n.marker)<0)&&(r=n.marker);return r}function Bt(t){return Ft(t,!0)}function Ut(t){return Ft(t,!1)}function jt(t,e){var r,i=Nt&&t.markedSpans;if(i)for(var n=0;n<i.length;++n){var o=i[n];o.marker.collapsed&&(null==o.from||o.from<e)&&(null==o.to||o.to>e)&&(!r||Dt(r,o.marker)<0)&&(r=o.marker)}return r}function Wt(t,e,r,i,n){var o=lt(t,e),s=Nt&&o.markedSpans;if(s)for(var a=0;a<s.length;++a){var l=s[a];if(l.marker.collapsed){var c=l.marker.find(0),u=mt(c.from,r)||Mt(l.marker)-Mt(n),h=mt(c.to,i)||It(l.marker)-It(n);if(!(u>=0&&h<=0||u<=0&&h>=0)&&(u<=0&&(l.marker.inclusiveRight&&n.inclusiveLeft?mt(c.to,r)>=0:mt(c.to,r)>0)||u>=0&&(l.marker.inclusiveRight&&n.inclusiveLeft?mt(c.from,i)<=0:mt(c.from,i)<0)))return!0}}}function Vt(t){for(var e;e=Bt(t);)t=e.find(-1,!0).line;return t}function zt(t,e){var r=lt(t,e),i=Vt(r);return r==i?e:pt(i)}function Ht(t,e){if(e>t.lastLine())return e;var r,i=lt(t,e);if(!Yt(t,i))return e;for(;r=Ut(i);)i=r.find(1,!0).line;return pt(i)+1}function Yt(t,e){var r=Nt&&e.markedSpans;if(r)for(var i=void 0,n=0;n<r.length;++n)if((i=r[n]).marker.collapsed){if(null==i.from)return!0;if(!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&Gt(t,e,i))return!0}}function Gt(t,e,r){if(null==r.to){var i=r.marker.find(1,!0);return Gt(t,i.line,Tt(i.line.markedSpans,r.marker))}if(r.marker.inclusiveRight&&r.to==e.text.length)return!0;for(var n=void 0,o=0;o<e.markedSpans.length;++o)if((n=e.markedSpans[o]).marker.collapsed&&!n.marker.widgetNode&&n.from==r.to&&(null==n.to||n.to!=r.from)&&(n.marker.inclusiveLeft||r.marker.inclusiveRight)&&Gt(t,e,n))return!0}function qt(t){t=Vt(t);for(var e=0,r=t.parent,i=0;i<r.lines.length;++i){var n=r.lines[i];if(n==t)break;e+=n.height}for(var o=r.parent;o;o=(r=o).parent)for(var s=0;s<o.children.length;++s){var a=o.children[s];if(a==r)break;e+=a.height}return e}function Xt(t){if(0==t.height)return 0;for(var e,r=t.text.length,i=t;e=Bt(i);){var n=e.find(0,!0);i=n.from.line,r+=n.from.ch-n.to.ch}for(i=t;e=Ut(i);){var o=e.find(0,!0);r-=i.text.length-o.from.ch,i=o.to.line,r+=i.text.length-o.to.ch}return r}function Kt(t){var e=t.display,r=t.doc;e.maxLine=lt(r,r.first),e.maxLineLength=Xt(e.maxLine),e.maxLineChanged=!0,r.iter(function(t){var r=Xt(t);r>e.maxLineLength&&(e.maxLineLength=r,e.maxLine=t)})}var $t=null;function Jt(t,e,r){var i;$t=null;for(var n=0;n<t.length;++n){var o=t[n];if(o.from<e&&o.to>e)return n;o.to==e&&(o.from!=o.to&&"before"==r?i=n:$t=n),o.from==e&&(o.from!=o.to&&"before"!=r?i=n:$t=n)}return null!=i?i:$t}var Zt=function(){var t="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",e="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111";var r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,n=/[LRr]/,o=/[Lb1n]/,s=/[1n]/;function a(t,e,r){this.level=t,this.from=e,this.to=r}return function(l,c){var u,h="ltr"==c?"L":"R";if(0==l.length||"ltr"==c&&!r.test(l))return!1;for(var p=l.length,f=[],d=0;d<p;++d)f.push((u=l.charCodeAt(d))<=247?t.charAt(u):1424<=u&&u<=1524?"R":1536<=u&&u<=1785?e.charAt(u-1536):1774<=u&&u<=2220?"r":8192<=u&&u<=8203?"w":8204==u?"b":"L");for(var g=0,v=h;g<p;++g){var m=f[g];"m"==m?f[g]=v:v=m}for(var y=0,b=h;y<p;++y){var w=f[y];"1"==w&&"r"==b?f[y]="n":n.test(w)&&(b=w,"r"==w&&(f[y]="R"))}for(var x=1,k=f[0];x<p-1;++x){var S=f[x];"+"==S&&"1"==k&&"1"==f[x+1]?f[x]="1":","!=S||k!=f[x+1]||"1"!=k&&"n"!=k||(f[x]=k),k=S}for(var E=0;E<p;++E){var C=f[E];if(","==C)f[E]="N";else if("%"==C){var N=void 0;for(N=E+1;N<p&&"%"==f[N];++N);for(var P=E&&"!"==f[E-1]||N<p&&"1"==f[N]?"1":"N",T=E;T<N;++T)f[T]=P;E=N-1}}for(var A=0,R=h;A<p;++A){var O=f[A];"L"==R&&"1"==O?f[A]="L":n.test(O)&&(R=O)}for(var L=0;L<p;++L)if(i.test(f[L])){var _=void 0;for(_=L+1;_<p&&i.test(f[_]);++_);for(var M="L"==(L?f[L-1]:h),I="L"==(_<p?f[_]:h),D=M==I?M?"L":"R":h,F=L;F<_;++F)f[F]=D;L=_-1}for(var B,U=[],j=0;j<p;)if(o.test(f[j])){var W=j;for(++j;j<p&&o.test(f[j]);++j);U.push(new a(0,W,j))}else{var V=j,z=U.length;for(++j;j<p&&"L"!=f[j];++j);for(var H=V;H<j;)if(s.test(f[H])){V<H&&U.splice(z,0,new a(1,V,H));var Y=H;for(++H;H<j&&s.test(f[H]);++H);U.splice(z,0,new a(2,Y,H)),V=H}else++H;V<j&&U.splice(z,0,new a(1,V,j))}return"ltr"==c&&(1==U[0].level&&(B=l.match(/^\s+/))&&(U[0].from=B[0].length,U.unshift(new a(0,0,B[0].length))),1==K(U).level&&(B=l.match(/\s+$/))&&(K(U).to-=B[0].length,U.push(new a(0,p-B[0].length,p)))),"rtl"==c?U.reverse():U}}();function Qt(t,e){var r=t.order;return null==r&&(r=t.order=Zt(t.text,e)),r}var te=[],ee=function(t,e,r){if(t.addEventListener)t.addEventListener(e,r,!1);else if(t.attachEvent)t.attachEvent("on"+e,r);else{var i=t._handlers||(t._handlers={});i[e]=(i[e]||te).concat(r)}};function re(t,e){return t._handlers&&t._handlers[e]||te}function ie(t,e,r){if(t.removeEventListener)t.removeEventListener(e,r,!1);else if(t.detachEvent)t.detachEvent("on"+e,r);else{var i=t._handlers,n=i&&i[e];if(n){var o=j(n,r);o>-1&&(i[e]=n.slice(0,o).concat(n.slice(o+1)))}}}function ne(t,e){var r=re(t,e);if(r.length)for(var i=Array.prototype.slice.call(arguments,2),n=0;n<r.length;++n)r[n].apply(null,i)}function oe(t,e,r){return"string"==typeof e&&(e={type:e,preventDefault:function(){this.defaultPrevented=!0}}),ne(t,r||e.type,t,e),he(e)||e.codemirrorIgnore}function se(t){var e=t._handlers&&t._handlers.cursorActivity;if(e)for(var r=t.curOp.cursorActivityHandlers||(t.curOp.cursorActivityHandlers=[]),i=0;i<e.length;++i)-1==j(r,e[i])&&r.push(e[i])}function ae(t,e){return re(t,e).length>0}function le(t){t.prototype.on=function(t,e){ee(this,t,e)},t.prototype.off=function(t,e){ie(this,t,e)}}function ce(t){t.preventDefault?t.preventDefault():t.returnValue=!1}function ue(t){t.stopPropagation?t.stopPropagation():t.cancelBubble=!0}function he(t){return null!=t.defaultPrevented?t.defaultPrevented:0==t.returnValue}function pe(t){ce(t),ue(t)}function fe(t){return t.target||t.srcElement}function de(t){var e=t.which;return null==e&&(1&t.button?e=1:2&t.button?e=3:4&t.button&&(e=2)),y&&t.ctrlKey&&1==e&&(e=3),e}var ge,ve,me=function(){if(s&&a<9)return!1;var t=A("div");return"draggable"in t||"dragDrop"in t}();function ye(t){if(null==ge){var e=A("span","​");T(t,A("span",[e,document.createTextNode("x")])),0!=t.firstChild.offsetHeight&&(ge=e.offsetWidth<=1&&e.offsetHeight>2&&!(s&&a<8))}var r=ge?A("span","​"):A("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px");return r.setAttribute("cm-text",""),r}function be(t){if(null!=ve)return ve;var e=T(t,document.createTextNode("AخA")),r=C(e,0,1).getBoundingClientRect(),i=C(e,1,2).getBoundingClientRect();return P(t),!(!r||r.left==r.right)&&(ve=i.right-r.right<3)}var we,xe=3!="\n\nb".split(/\n/).length?function(t){for(var e=0,r=[],i=t.length;e<=i;){var n=t.indexOf("\n",e);-1==n&&(n=t.length);var o=t.slice(e,"\r"==t.charAt(n-1)?n-1:n),s=o.indexOf("\r");-1!=s?(r.push(o.slice(0,s)),e+=s+1):(r.push(o),e=n+1)}return r}:function(t){return t.split(/\r\n?|\n/)},ke=window.getSelection?function(t){try{return t.selectionStart!=t.selectionEnd}catch(t){return!1}}:function(t){var e;try{e=t.ownerDocument.selection.createRange()}catch(t){}return!(!e||e.parentElement()!=t)&&0!=e.compareEndPoints("StartToEnd",e)},Se="oncopy"in(we=A("div"))||(we.setAttribute("oncopy","return;"),"function"==typeof we.oncopy),Ee=null,Ce={},Ne={};function Pe(t){if("string"==typeof t&&Ne.hasOwnProperty(t))t=Ne[t];else if(t&&"string"==typeof t.name&&Ne.hasOwnProperty(t.name)){var e=Ne[t.name];"string"==typeof e&&(e={name:e}),(t=Z(e,t)).name=e.name}else{if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+xml$/.test(t))return Pe("application/xml");if("string"==typeof t&&/^[\w\-]+\/[\w\-]+\+json$/.test(t))return Pe("application/json")}return"string"==typeof t?{name:t}:t||{name:"null"}}function Te(t,e){e=Pe(e);var r=Ce[e.name];if(!r)return Te(t,"text/plain");var i=r(t,e);if(Ae.hasOwnProperty(e.name)){var n=Ae[e.name];for(var o in n)n.hasOwnProperty(o)&&(i.hasOwnProperty(o)&&(i["_"+o]=i[o]),i[o]=n[o])}if(i.name=e.name,e.helperType&&(i.helperType=e.helperType),e.modeProps)for(var s in e.modeProps)i[s]=e.modeProps[s];return i}var Ae={};function Re(t,e){var r=Ae.hasOwnProperty(t)?Ae[t]:Ae[t]={};F(e,r)}function Oe(t,e){if(!0===e)return e;if(t.copyState)return t.copyState(e);var r={};for(var i in e){var n=e[i];n instanceof Array&&(n=n.concat([])),r[i]=n}return r}function Le(t,e){for(var r;t.innerMode&&(r=t.innerMode(e))&&r.mode!=t;)e=r.state,t=r.mode;return r||{mode:t,state:e}}function _e(t,e,r){return!t.startState||t.startState(e,r)}var Me=function(t,e,r){this.pos=this.start=0,this.string=t,this.tabSize=e||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=r};Me.prototype.eol=function(){return this.pos>=this.string.length},Me.prototype.sol=function(){return this.pos==this.lineStart},Me.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},Me.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},Me.prototype.eat=function(t){var e=this.string.charAt(this.pos);if("string"==typeof t?e==t:e&&(t.test?t.test(e):t(e)))return++this.pos,e},Me.prototype.eatWhile=function(t){for(var e=this.pos;this.eat(t););return this.pos>e},Me.prototype.eatSpace=function(){for(var t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>t},Me.prototype.skipToEnd=function(){this.pos=this.string.length},Me.prototype.skipTo=function(t){var e=this.string.indexOf(t,this.pos);if(e>-1)return this.pos=e,!0},Me.prototype.backUp=function(t){this.pos-=t},Me.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=B(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?B(this.string,this.lineStart,this.tabSize):0)},Me.prototype.indentation=function(){return B(this.string,null,this.tabSize)-(this.lineStart?B(this.string,this.lineStart,this.tabSize):0)},Me.prototype.match=function(t,e,r){if("string"!=typeof t){var i=this.string.slice(this.pos).match(t);return i&&i.index>0?null:(i&&!1!==e&&(this.pos+=i[0].length),i)}var n=function(t){return r?t.toLowerCase():t},o=this.string.substr(this.pos,t.length);if(n(o)==n(t))return!1!==e&&(this.pos+=t.length),!0},Me.prototype.current=function(){return this.string.slice(this.start,this.pos)},Me.prototype.hideFirstChars=function(t,e){this.lineStart+=t;try{return e()}finally{this.lineStart-=t}},Me.prototype.lookAhead=function(t){var e=this.lineOracle;return e&&e.lookAhead(t)},Me.prototype.baseToken=function(){var t=this.lineOracle;return t&&t.baseToken(this.pos)};var Ie=function(t,e){this.state=t,this.lookAhead=e},De=function(t,e,r,i){this.state=e,this.doc=t,this.line=r,this.maxLookAhead=i||0,this.baseTokens=null,this.baseTokenPos=1};function Fe(t,e,r,i){var n=[t.state.modeGen],o={};Ge(t,e.text,t.doc.mode,r,function(t,e){return n.push(t,e)},o,i);for(var s=r.state,a=function(i){r.baseTokens=n;var a=t.state.overlays[i],l=1,c=0;r.state=!0,Ge(t,e.text,a.mode,r,function(t,e){for(var r=l;c<t;){var i=n[l];i>t&&n.splice(l,1,t,n[l+1],i),l+=2,c=Math.min(t,i)}if(e)if(a.opaque)n.splice(r,l-r,t,"overlay "+e),l=r+2;else for(;r<l;r+=2){var o=n[r+1];n[r+1]=(o?o+" ":"")+"overlay "+e}},o),r.state=s,r.baseTokens=null,r.baseTokenPos=1},l=0;l<t.state.overlays.length;++l)a(l);return{styles:n,classes:o.bgClass||o.textClass?o:null}}function Be(t,e,r){if(!e.styles||e.styles[0]!=t.state.modeGen){var i=Ue(t,pt(e)),n=e.text.length>t.options.maxHighlightLength&&Oe(t.doc.mode,i.state),o=Fe(t,e,i);n&&(i.state=n),e.stateAfter=i.save(!n),e.styles=o.styles,o.classes?e.styleClasses=o.classes:e.styleClasses&&(e.styleClasses=null),r===t.doc.highlightFrontier&&(t.doc.modeFrontier=Math.max(t.doc.modeFrontier,++t.doc.highlightFrontier))}return e.styles}function Ue(t,e,r){var i=t.doc,n=t.display;if(!i.mode.startState)return new De(i,!0,e);var o=function(t,e,r){for(var i,n,o=t.doc,s=r?-1:e-(t.doc.mode.innerMode?1e3:100),a=e;a>s;--a){if(a<=o.first)return o.first;var l=lt(o,a-1),c=l.stateAfter;if(c&&(!r||a+(c instanceof Ie?c.lookAhead:0)<=o.modeFrontier))return a;var u=B(l.text,null,t.options.tabSize);(null==n||i>u)&&(n=a-1,i=u)}return n}(t,e,r),s=o>i.first&&lt(i,o-1).stateAfter,a=s?De.fromSaved(i,s,o):new De(i,_e(i.mode),o);return i.iter(o,e,function(r){je(t,r.text,a);var i=a.line;r.stateAfter=i==e-1||i%5==0||i>=n.viewFrom&&i<n.viewTo?a.save():null,a.nextLine()}),r&&(i.modeFrontier=a.line),a}function je(t,e,r,i){var n=t.doc.mode,o=new Me(e,t.options.tabSize,r);for(o.start=o.pos=i||0,""==e&&We(n,r.state);!o.eol();)Ve(n,o,r.state),o.start=o.pos}function We(t,e){if(t.blankLine)return t.blankLine(e);if(t.innerMode){var r=Le(t,e);return r.mode.blankLine?r.mode.blankLine(r.state):void 0}}function Ve(t,e,r,i){for(var n=0;n<10;n++){i&&(i[0]=Le(t,r).mode);var o=t.token(e,r);if(e.pos>e.start)return o}throw new Error("Mode "+t.name+" failed to advance stream.")}De.prototype.lookAhead=function(t){var e=this.doc.getLine(this.line+t);return null!=e&&t>this.maxLookAhead&&(this.maxLookAhead=t),e},De.prototype.baseToken=function(t){if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=t;)this.baseTokenPos+=2;var e=this.baseTokens[this.baseTokenPos+1];return{type:e&&e.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-t}},De.prototype.nextLine=function(){this.line++,this.maxLookAhead>0&&this.maxLookAhead--},De.fromSaved=function(t,e,r){return e instanceof Ie?new De(t,Oe(t.mode,e.state),r,e.lookAhead):new De(t,Oe(t.mode,e),r)},De.prototype.save=function(t){var e=!1!==t?Oe(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new Ie(e,this.maxLookAhead):e};var ze=function(t,e,r){this.start=t.start,this.end=t.pos,this.string=t.current(),this.type=e||null,this.state=r};function He(t,e,r,i){var n,o=t.doc,s=o.mode;e=St(o,e);var a,l=lt(o,e.line),c=Ue(t,e.line,r),u=new Me(l.text,t.options.tabSize,c);for(i&&(a=[]);(i||u.pos<e.ch)&&!u.eol();)u.start=u.pos,n=Ve(s,u,c.state),i&&a.push(new ze(u,n,Oe(o.mode,c.state)));return i?a:new ze(u,n,c.state)}function Ye(t,e){if(t)for(;;){var r=t.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!r)break;t=t.slice(0,r.index)+t.slice(r.index+r[0].length);var i=r[1]?"bgClass":"textClass";null==e[i]?e[i]=r[2]:new RegExp("(?:^|s)"+r[2]+"(?:$|s)").test(e[i])||(e[i]+=" "+r[2])}return t}function Ge(t,e,r,i,n,o,s){var a=r.flattenSpans;null==a&&(a=t.options.flattenSpans);var l,c=0,u=null,h=new Me(e,t.options.tabSize,i),p=t.options.addModeClass&&[null];for(""==e&&Ye(We(r,i.state),o);!h.eol();){if(h.pos>t.options.maxHighlightLength?(a=!1,s&&je(t,e,i,h.pos),h.pos=e.length,l=null):l=Ye(Ve(r,h,i.state,p),o),p){var f=p[0].name;f&&(l="m-"+(l?f+" "+l:f))}if(!a||u!=l){for(;c<h.start;)c=Math.min(h.start,c+5e3),n(c,u);u=l}h.start=h.pos}for(;c<h.pos;){var d=Math.min(h.pos,c+5e3);n(d,u),c=d}}var qe=function(t,e,r){this.text=t,_t(this,e),this.height=r?r(this):1};function Xe(t){t.parent=null,Lt(t)}qe.prototype.lineNo=function(){return pt(this)},le(qe);var Ke={},$e={};function Je(t,e){if(!t||/^\s*$/.test(t))return null;var r=e.addModeClass?$e:Ke;return r[t]||(r[t]=t.replace(/\S+/g,"cm-$&"))}function Ze(t,e){var r=R("span",null,null,l?"padding-right: .1px":null),i={pre:R("pre",[r],"CodeMirror-line"),content:r,col:0,pos:0,cm:t,trailingSpace:!1,splitSpaces:t.getOption("lineWrapping")};e.measure={};for(var n=0;n<=(e.rest?e.rest.length:0);n++){var o=n?e.rest[n-1]:e.line,s=void 0;i.pos=0,i.addToken=tr,be(t.display.measure)&&(s=Qt(o,t.doc.direction))&&(i.addToken=er(i.addToken,s)),i.map=[];var a=e!=t.display.externalMeasured&&pt(o);ir(o,i,Be(t,o,a)),o.styleClasses&&(o.styleClasses.bgClass&&(i.bgClass=M(o.styleClasses.bgClass,i.bgClass||"")),o.styleClasses.textClass&&(i.textClass=M(o.styleClasses.textClass,i.textClass||""))),0==i.map.length&&i.map.push(0,0,i.content.appendChild(ye(t.display.measure))),0==n?(e.measure.map=i.map,e.measure.cache={}):((e.measure.maps||(e.measure.maps=[])).push(i.map),(e.measure.caches||(e.measure.caches=[])).push({}))}if(l){var c=i.content.lastChild;(/\bcm-tab\b/.test(c.className)||c.querySelector&&c.querySelector(".cm-tab"))&&(i.content.className="cm-tab-wrap-hack")}return ne(t,"renderLine",t,e.line,i.pre),i.pre.className&&(i.textClass=M(i.pre.className,i.textClass||"")),i}function Qe(t){var e=A("span","•","cm-invalidchar");return e.title="\\u"+t.charCodeAt(0).toString(16),e.setAttribute("aria-label",e.title),e}function tr(t,e,r,i,n,o,l){if(e){var c,u=t.splitSpaces?function(t,e){if(t.length>1&&!/  /.test(t))return t;for(var r=e,i="",n=0;n<t.length;n++){var o=t.charAt(n);" "!=o||!r||n!=t.length-1&&32!=t.charCodeAt(n+1)||(o=" "),i+=o,r=" "==o}return i}(e,t.trailingSpace):e,h=t.cm.state.specialChars,p=!1;if(h.test(e)){c=document.createDocumentFragment();for(var f=0;;){h.lastIndex=f;var d=h.exec(e),g=d?d.index-f:e.length-f;if(g){var v=document.createTextNode(u.slice(f,f+g));s&&a<9?c.appendChild(A("span",[v])):c.appendChild(v),t.map.push(t.pos,t.pos+g,v),t.col+=g,t.pos+=g}if(!d)break;f+=g+1;var m=void 0;if("\t"==d[0]){var y=t.cm.options.tabSize,b=y-t.col%y;(m=c.appendChild(A("span",X(b),"cm-tab"))).setAttribute("role","presentation"),m.setAttribute("cm-text","\t"),t.col+=b}else"\r"==d[0]||"\n"==d[0]?((m=c.appendChild(A("span","\r"==d[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",d[0]),t.col+=1):((m=t.cm.options.specialCharPlaceholder(d[0])).setAttribute("cm-text",d[0]),s&&a<9?c.appendChild(A("span",[m])):c.appendChild(m),t.col+=1);t.map.push(t.pos,t.pos+1,m),t.pos++}}else t.col+=e.length,c=document.createTextNode(u),t.map.push(t.pos,t.pos+e.length,c),s&&a<9&&(p=!0),t.pos+=e.length;if(t.trailingSpace=32==u.charCodeAt(e.length-1),r||i||n||p||o){var w=r||"";i&&(w+=i),n&&(w+=n);var x=A("span",[c],w,o);if(l)for(var k in l)l.hasOwnProperty(k)&&"style"!=k&&"class"!=k&&x.setAttribute(k,l[k]);return t.content.appendChild(x)}t.content.appendChild(c)}}function er(t,e){return function(r,i,n,o,s,a,l){n=n?n+" cm-force-border":"cm-force-border";for(var c=r.pos,u=c+i.length;;){for(var h=void 0,p=0;p<e.length&&!((h=e[p]).to>c&&h.from<=c);p++);if(h.to>=u)return t(r,i,n,o,s,a,l);t(r,i.slice(0,h.to-c),n,o,null,a,l),o=null,i=i.slice(h.to-c),c=h.to}}}function rr(t,e,r,i){var n=!i&&r.widgetNode;n&&t.map.push(t.pos,t.pos+e,n),!i&&t.cm.display.input.needsContentAttribute&&(n||(n=t.content.appendChild(document.createElement("span"))),n.setAttribute("cm-marker",r.id)),n&&(t.cm.display.input.setUneditable(n),t.content.appendChild(n)),t.pos+=e,t.trailingSpace=!1}function ir(t,e,r){var i=t.markedSpans,n=t.text,o=0;if(i)for(var s,a,l,c,u,h,p,f=n.length,d=0,g=1,v="",m=0;;){if(m==d){l=c=u=a="",p=null,h=null,m=1/0;for(var y=[],b=void 0,w=0;w<i.length;++w){var x=i[w],k=x.marker;if("bookmark"==k.type&&x.from==d&&k.widgetNode)y.push(k);else if(x.from<=d&&(null==x.to||x.to>d||k.collapsed&&x.to==d&&x.from==d)){if(null!=x.to&&x.to!=d&&m>x.to&&(m=x.to,c=""),k.className&&(l+=" "+k.className),k.css&&(a=(a?a+";":"")+k.css),k.startStyle&&x.from==d&&(u+=" "+k.startStyle),k.endStyle&&x.to==m&&(b||(b=[])).push(k.endStyle,x.to),k.title&&((p||(p={})).title=k.title),k.attributes)for(var S in k.attributes)(p||(p={}))[S]=k.attributes[S];k.collapsed&&(!h||Dt(h.marker,k)<0)&&(h=x)}else x.from>d&&m>x.from&&(m=x.from)}if(b)for(var E=0;E<b.length;E+=2)b[E+1]==m&&(c+=" "+b[E]);if(!h||h.from==d)for(var C=0;C<y.length;++C)rr(e,0,y[C]);if(h&&(h.from||0)==d){if(rr(e,(null==h.to?f+1:h.to)-d,h.marker,null==h.from),null==h.to)return;h.to==d&&(h=!1)}}if(d>=f)break;for(var N=Math.min(f,m);;){if(v){var P=d+v.length;if(!h){var T=P>N?v.slice(0,N-d):v;e.addToken(e,T,s?s+l:l,u,d+T.length==m?c:"",a,p)}if(P>=N){v=v.slice(N-d),d=N;break}d=P,u=""}v=n.slice(o,o=r[g++]),s=Je(r[g++],e.cm.options)}}else for(var A=1;A<r.length;A+=2)e.addToken(e,n.slice(o,o=r[A]),Je(r[A+1],e.cm.options))}function nr(t,e,r){this.line=e,this.rest=function(t){for(var e,r;e=Ut(t);)t=e.find(1,!0).line,(r||(r=[])).push(t);return r}(e),this.size=this.rest?pt(K(this.rest))-r+1:1,this.node=this.text=null,this.hidden=Yt(t,e)}function or(t,e,r){for(var i,n=[],o=e;o<r;o=i){var s=new nr(t.doc,lt(t.doc,o),o);i=o+s.size,n.push(s)}return n}var sr=null,ar=null;function lr(t,e){var r=re(t,e);if(r.length){var i,n=Array.prototype.slice.call(arguments,2);sr?i=sr.delayedCallbacks:ar?i=ar:(i=ar=[],setTimeout(cr,0));for(var o=function(t){i.push(function(){return r[t].apply(null,n)})},s=0;s<r.length;++s)o(s)}}function cr(){var t=ar;ar=null;for(var e=0;e<t.length;++e)t[e]()}function ur(t,e,r,i){for(var n=0;n<e.changes.length;n++){var o=e.changes[n];"text"==o?fr(t,e):"gutter"==o?gr(t,e,r,i):"class"==o?dr(t,e):"widget"==o&&vr(t,e,i)}e.changes=null}function hr(t){return t.node==t.text&&(t.node=A("div",null,null,"position: relative"),t.text.parentNode&&t.text.parentNode.replaceChild(t.node,t.text),t.node.appendChild(t.text),s&&a<8&&(t.node.style.zIndex=2)),t.node}function pr(t,e){var r=t.display.externalMeasured;return r&&r.line==e.line?(t.display.externalMeasured=null,e.measure=r.measure,r.built):Ze(t,e)}function fr(t,e){var r=e.text.className,i=pr(t,e);e.text==e.node&&(e.node=i.pre),e.text.parentNode.replaceChild(i.pre,e.text),e.text=i.pre,i.bgClass!=e.bgClass||i.textClass!=e.textClass?(e.bgClass=i.bgClass,e.textClass=i.textClass,dr(t,e)):r&&(e.text.className=r)}function dr(t,e){!function(t,e){var r=e.bgClass?e.bgClass+" "+(e.line.bgClass||""):e.line.bgClass;if(r&&(r+=" CodeMirror-linebackground"),e.background)r?e.background.className=r:(e.background.parentNode.removeChild(e.background),e.background=null);else if(r){var i=hr(e);e.background=i.insertBefore(A("div",null,r),i.firstChild),t.display.input.setUneditable(e.background)}}(t,e),e.line.wrapClass?hr(e).className=e.line.wrapClass:e.node!=e.text&&(e.node.className="");var r=e.textClass?e.textClass+" "+(e.line.textClass||""):e.line.textClass;e.text.className=r||""}function gr(t,e,r,i){if(e.gutter&&(e.node.removeChild(e.gutter),e.gutter=null),e.gutterBackground&&(e.node.removeChild(e.gutterBackground),e.gutterBackground=null),e.line.gutterClass){var n=hr(e);e.gutterBackground=A("div",null,"CodeMirror-gutter-background "+e.line.gutterClass,"left: "+(t.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px; width: "+i.gutterTotalWidth+"px"),t.display.input.setUneditable(e.gutterBackground),n.insertBefore(e.gutterBackground,e.text)}var o=e.line.gutterMarkers;if(t.options.lineNumbers||o){var s=hr(e),a=e.gutter=A("div",null,"CodeMirror-gutter-wrapper","left: "+(t.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px");if(t.display.input.setUneditable(a),s.insertBefore(a,e.text),e.line.gutterClass&&(a.className+=" "+e.line.gutterClass),!t.options.lineNumbers||o&&o["CodeMirror-linenumbers"]||(e.lineNumber=a.appendChild(A("div",gt(t.options,r),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+i.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+t.display.lineNumInnerWidth+"px"))),o)for(var l=0;l<t.options.gutters.length;++l){var c=t.options.gutters[l],u=o.hasOwnProperty(c)&&o[c];u&&a.appendChild(A("div",[u],"CodeMirror-gutter-elt","left: "+i.gutterLeft[c]+"px; width: "+i.gutterWidth[c]+"px"))}}}function vr(t,e,r){e.alignable&&(e.alignable=null);for(var i=e.node.firstChild,n=void 0;i;i=n)n=i.nextSibling,"CodeMirror-linewidget"==i.className&&e.node.removeChild(i);yr(t,e,r)}function mr(t,e,r,i){var n=pr(t,e);return e.text=e.node=n.pre,n.bgClass&&(e.bgClass=n.bgClass),n.textClass&&(e.textClass=n.textClass),dr(t,e),gr(t,e,r,i),yr(t,e,i),e.node}function yr(t,e,r){if(br(t,e.line,e,r,!0),e.rest)for(var i=0;i<e.rest.length;i++)br(t,e.rest[i],e,r,!1)}function br(t,e,r,i,n){if(e.widgets)for(var o=hr(r),s=0,a=e.widgets;s<a.length;++s){var l=a[s],c=A("div",[l.node],"CodeMirror-linewidget");l.handleMouseEvents||c.setAttribute("cm-ignore-events","true"),wr(l,c,r,i),t.display.input.setUneditable(c),n&&l.above?o.insertBefore(c,r.gutter||r.text):o.appendChild(c),lr(l,"redraw")}}function wr(t,e,r,i){if(t.noHScroll){(r.alignable||(r.alignable=[])).push(e);var n=i.wrapperWidth;e.style.left=i.fixedPos+"px",t.coverGutter||(n-=i.gutterTotalWidth,e.style.paddingLeft=i.gutterTotalWidth+"px"),e.style.width=n+"px"}t.coverGutter&&(e.style.zIndex=5,e.style.position="relative",t.noHScroll||(e.style.marginLeft=-i.gutterTotalWidth+"px"))}function xr(t){if(null!=t.height)return t.height;var e=t.doc.cm;if(!e)return 0;if(!O(document.body,t.node)){var r="position: relative;";t.coverGutter&&(r+="margin-left: -"+e.display.gutters.offsetWidth+"px;"),t.noHScroll&&(r+="width: "+e.display.wrapper.clientWidth+"px;"),T(e.display.measure,A("div",[t.node],null,r))}return t.height=t.node.parentNode.offsetHeight}function kr(t,e){for(var r=fe(e);r!=t.wrapper;r=r.parentNode)if(!r||1==r.nodeType&&"true"==r.getAttribute("cm-ignore-events")||r.parentNode==t.sizer&&r!=t.mover)return!0}function Sr(t){return t.lineSpace.offsetTop}function Er(t){return t.mover.offsetHeight-t.lineSpace.offsetHeight}function Cr(t){if(t.cachedPaddingH)return t.cachedPaddingH;var e=T(t.measure,A("pre","x")),r=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,i={left:parseInt(r.paddingLeft),right:parseInt(r.paddingRight)};return isNaN(i.left)||isNaN(i.right)||(t.cachedPaddingH=i),i}function Nr(t){return W-t.display.nativeBarWidth}function Pr(t){return t.display.scroller.clientWidth-Nr(t)-t.display.barWidth}function Tr(t){return t.display.scroller.clientHeight-Nr(t)-t.display.barHeight}function Ar(t,e,r){if(t.line==e)return{map:t.measure.map,cache:t.measure.cache};for(var i=0;i<t.rest.length;i++)if(t.rest[i]==e)return{map:t.measure.maps[i],cache:t.measure.caches[i]};for(var n=0;n<t.rest.length;n++)if(pt(t.rest[n])>r)return{map:t.measure.maps[n],cache:t.measure.caches[n],before:!0}}function Rr(t,e,r,i){return _r(t,Lr(t,e),r,i)}function Or(t,e){if(e>=t.display.viewFrom&&e<t.display.viewTo)return t.display.view[li(t,e)];var r=t.display.externalMeasured;return r&&e>=r.lineN&&e<r.lineN+r.size?r:void 0}function Lr(t,e){var r=pt(e),i=Or(t,r);i&&!i.text?i=null:i&&i.changes&&(ur(t,i,r,ii(t)),t.curOp.forceUpdate=!0),i||(i=function(t,e){var r=pt(e=Vt(e)),i=t.display.externalMeasured=new nr(t.doc,e,r);i.lineN=r;var n=i.built=Ze(t,i);return i.text=n.pre,T(t.display.lineMeasure,n.pre),i}(t,e));var n=Ar(i,e,r);return{line:e,view:i,rect:null,map:n.map,cache:n.cache,before:n.before,hasHeights:!1}}function _r(t,e,r,i,n){e.before&&(r=-1);var o,l=r+(i||"");return e.cache.hasOwnProperty(l)?o=e.cache[l]:(e.rect||(e.rect=e.view.text.getBoundingClientRect()),e.hasHeights||(function(t,e,r){var i=t.options.lineWrapping,n=i&&Pr(t);if(!e.measure.heights||i&&e.measure.width!=n){var o=e.measure.heights=[];if(i){e.measure.width=n;for(var s=e.text.firstChild.getClientRects(),a=0;a<s.length-1;a++){var l=s[a],c=s[a+1];Math.abs(l.bottom-c.bottom)>2&&o.push((l.bottom+c.top)/2-r.top)}}o.push(r.bottom-r.top)}}(t,e.view,e.rect),e.hasHeights=!0),(o=function(t,e,r,i){var n,o=Dr(e.map,r,i),l=o.node,c=o.start,u=o.end,h=o.collapse;if(3==l.nodeType){for(var p=0;p<4;p++){for(;c&&nt(e.line.text.charAt(o.coverStart+c));)--c;for(;o.coverStart+u<o.coverEnd&&nt(e.line.text.charAt(o.coverStart+u));)++u;if((n=s&&a<9&&0==c&&u==o.coverEnd-o.coverStart?l.parentNode.getBoundingClientRect():Fr(C(l,c,u).getClientRects(),i)).left||n.right||0==c)break;u=c,c-=1,h="right"}s&&a<11&&(n=function(t,e){if(!window.screen||null==screen.logicalXDPI||screen.logicalXDPI==screen.deviceXDPI||!function(t){if(null!=Ee)return Ee;var e=T(t,A("span","x")),r=e.getBoundingClientRect(),i=C(e,0,1).getBoundingClientRect();return Ee=Math.abs(r.left-i.left)>1}(t))return e;var r=screen.logicalXDPI/screen.deviceXDPI,i=screen.logicalYDPI/screen.deviceYDPI;return{left:e.left*r,right:e.right*r,top:e.top*i,bottom:e.bottom*i}}(t.display.measure,n))}else{var f;c>0&&(h=i="right"),n=t.options.lineWrapping&&(f=l.getClientRects()).length>1?f["right"==i?f.length-1:0]:l.getBoundingClientRect()}if(s&&a<9&&!c&&(!n||!n.left&&!n.right)){var d=l.parentNode.getClientRects()[0];n=d?{left:d.left,right:d.left+ri(t.display),top:d.top,bottom:d.bottom}:Ir}for(var g=n.top-e.rect.top,v=n.bottom-e.rect.top,m=(g+v)/2,y=e.view.measure.heights,b=0;b<y.length-1&&!(m<y[b]);b++);var w=b?y[b-1]:0,x=y[b],k={left:("right"==h?n.right:n.left)-e.rect.left,right:("left"==h?n.left:n.right)-e.rect.left,top:w,bottom:x};return n.left||n.right||(k.bogus=!0),t.options.singleCursorHeightPerLine||(k.rtop=g,k.rbottom=v),k}(t,e,r,i)).bogus||(e.cache[l]=o)),{left:o.left,right:o.right,top:n?o.rtop:o.top,bottom:n?o.rbottom:o.bottom}}var Mr,Ir={left:0,right:0,top:0,bottom:0};function Dr(t,e,r){for(var i,n,o,s,a,l,c=0;c<t.length;c+=3)if(a=t[c],l=t[c+1],e<a?(n=0,o=1,s="left"):e<l?o=1+(n=e-a):(c==t.length-3||e==l&&t[c+3]>e)&&(n=(o=l-a)-1,e>=l&&(s="right")),null!=n){if(i=t[c+2],a==l&&r==(i.insertLeft?"left":"right")&&(s=r),"left"==r&&0==n)for(;c&&t[c-2]==t[c-3]&&t[c-1].insertLeft;)i=t[2+(c-=3)],s="left";if("right"==r&&n==l-a)for(;c<t.length-3&&t[c+3]==t[c+4]&&!t[c+5].insertLeft;)i=t[(c+=3)+2],s="right";break}return{node:i,start:n,end:o,collapse:s,coverStart:a,coverEnd:l}}function Fr(t,e){var r=Ir;if("left"==e)for(var i=0;i<t.length&&(r=t[i]).left==r.right;i++);else for(var n=t.length-1;n>=0&&(r=t[n]).left==r.right;n--);return r}function Br(t){if(t.measure&&(t.measure.cache={},t.measure.heights=null,t.rest))for(var e=0;e<t.rest.length;e++)t.measure.caches[e]={}}function Ur(t){t.display.externalMeasure=null,P(t.display.lineMeasure);for(var e=0;e<t.display.view.length;e++)Br(t.display.view[e])}function jr(t){Ur(t),t.display.cachedCharWidth=t.display.cachedTextHeight=t.display.cachedPaddingH=null,t.options.lineWrapping||(t.display.maxLineChanged=!0),t.display.lineNumChars=null}function Wr(){return u&&v?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Vr(){return u&&v?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function zr(t){var e=0;if(t.widgets)for(var r=0;r<t.widgets.length;++r)t.widgets[r].above&&(e+=xr(t.widgets[r]));return e}function Hr(t,e,r,i,n){if(!n){var o=zr(e);r.top+=o,r.bottom+=o}if("line"==i)return r;i||(i="local");var s=qt(e);if("local"==i?s+=Sr(t.display):s-=t.display.viewOffset,"page"==i||"window"==i){var a=t.display.lineSpace.getBoundingClientRect();s+=a.top+("window"==i?0:Vr());var l=a.left+("window"==i?0:Wr());r.left+=l,r.right+=l}return r.top+=s,r.bottom+=s,r}function Yr(t,e,r){if("div"==r)return e;var i=e.left,n=e.top;if("page"==r)i-=Wr(),n-=Vr();else if("local"==r||!r){var o=t.display.sizer.getBoundingClientRect();i+=o.left,n+=o.top}var s=t.display.lineSpace.getBoundingClientRect();return{left:i-s.left,top:n-s.top}}function Gr(t,e,r,i,n){return i||(i=lt(t.doc,e.line)),Hr(t,i,Rr(t,i,e.ch,n),r)}function qr(t,e,r,i,n,o){function s(e,s){var a=_r(t,n,e,s?"right":"left",o);return s?a.left=a.right:a.right=a.left,Hr(t,i,a,r)}i=i||lt(t.doc,e.line),n||(n=Lr(t,i));var a=Qt(i,t.doc.direction),l=e.ch,c=e.sticky;if(l>=i.text.length?(l=i.text.length,c="before"):l<=0&&(l=0,c="after"),!a)return s("before"==c?l-1:l,"before"==c);function u(t,e,r){var i=a[e],n=1==i.level;return s(r?t-1:t,n!=r)}var h=Jt(a,l,c),p=$t,f=u(l,h,"before"==c);return null!=p&&(f.other=u(l,p,"before"!=c)),f}function Xr(t,e){var r=0;e=St(t.doc,e),t.options.lineWrapping||(r=ri(t.display)*e.ch);var i=lt(t.doc,e.line),n=qt(i)+Sr(t.display);return{left:r,right:r,top:n,bottom:n+i.height}}function Kr(t,e,r,i,n){var o=vt(t,e,r);return o.xRel=n,i&&(o.outside=!0),o}function $r(t,e,r){var i=t.doc;if((r+=t.display.viewOffset)<0)return Kr(i.first,0,null,!0,-1);var n=ft(i,r),o=i.first+i.size-1;if(n>o)return Kr(i.first+i.size-1,lt(i,o).text.length,null,!0,1);e<0&&(e=0);for(var s=lt(i,n);;){var a=ti(t,s,n,e,r),l=jt(s,a.ch+(a.xRel>0?1:0));if(!l)return a;var c=l.find(1);if(c.line==n)return c;s=lt(i,n=c.line)}}function Jr(t,e,r,i){i-=zr(e);var n=e.text.length,o=st(function(e){return _r(t,r,e-1).bottom<=i},n,0);return n=st(function(e){return _r(t,r,e).top>i},o,n),{begin:o,end:n}}function Zr(t,e,r,i){r||(r=Lr(t,e));var n=Hr(t,e,_r(t,r,i),"line").top;return Jr(t,e,r,n)}function Qr(t,e,r,i){return!(t.bottom<=r)&&(t.top>r||(i?t.left:t.right)>e)}function ti(t,e,r,i,n){n-=qt(e);var o=Lr(t,e),s=zr(e),a=0,l=e.text.length,c=!0,u=Qt(e,t.doc.direction);if(u){var h=(t.options.lineWrapping?function(t,e,r,i,n,o,s){var a=Jr(t,e,i,s),l=a.begin,c=a.end;/\s/.test(e.text.charAt(c-1))&&c--;for(var u=null,h=null,p=0;p<n.length;p++){var f=n[p];if(!(f.from>=c||f.to<=l)){var d=1!=f.level,g=_r(t,i,d?Math.min(c,f.to)-1:Math.max(l,f.from)).right,v=g<o?o-g+1e9:g-o;(!u||h>v)&&(u=f,h=v)}}return u||(u=n[n.length-1]),u.from<l&&(u={from:l,to:u.to,level:u.level}),u.to>c&&(u={from:u.from,to:c,level:u.level}),u}:function(t,e,r,i,n,o,s){var a=st(function(a){var l=n[a],c=1!=l.level;return Qr(qr(t,vt(r,c?l.to:l.from,c?"before":"after"),"line",e,i),o,s,!0)},0,n.length-1),l=n[a];if(a>0){var c=1!=l.level,u=qr(t,vt(r,c?l.from:l.to,c?"after":"before"),"line",e,i);Qr(u,o,s,!0)&&u.top>s&&(l=n[a-1])}return l})(t,e,r,o,u,i,n);c=1!=h.level,a=c?h.from:h.to-1,l=c?h.to:h.from-1}var p,f,d=null,g=null,v=st(function(e){var r=_r(t,o,e);return r.top+=s,r.bottom+=s,!!Qr(r,i,n,!1)&&(r.top<=n&&r.left<=i&&(d=e,g=r),!0)},a,l),m=!1;if(g){var y=i-g.left<g.right-i,b=y==c;v=d+(b?0:1),f=b?"after":"before",p=y?g.left:g.right}else{c||v!=l&&v!=a||v++,f=0==v?"after":v==e.text.length?"before":_r(t,o,v-(c?1:0)).bottom+s<=n==c?"after":"before";var w=qr(t,vt(r,v,f),"line",e,o);p=w.left,m=n<w.top||n>=w.bottom}return v=ot(e.text,v,1),Kr(r,v,f,m,i-p)}function ei(t){if(null!=t.cachedTextHeight)return t.cachedTextHeight;if(null==Mr){Mr=A("pre");for(var e=0;e<49;++e)Mr.appendChild(document.createTextNode("x")),Mr.appendChild(A("br"));Mr.appendChild(document.createTextNode("x"))}T(t.measure,Mr);var r=Mr.offsetHeight/50;return r>3&&(t.cachedTextHeight=r),P(t.measure),r||1}function ri(t){if(null!=t.cachedCharWidth)return t.cachedCharWidth;var e=A("span","xxxxxxxxxx"),r=A("pre",[e]);T(t.measure,r);var i=e.getBoundingClientRect(),n=(i.right-i.left)/10;return n>2&&(t.cachedCharWidth=n),n||10}function ii(t){for(var e=t.display,r={},i={},n=e.gutters.clientLeft,o=e.gutters.firstChild,s=0;o;o=o.nextSibling,++s)r[t.options.gutters[s]]=o.offsetLeft+o.clientLeft+n,i[t.options.gutters[s]]=o.clientWidth;return{fixedPos:ni(e),gutterTotalWidth:e.gutters.offsetWidth,gutterLeft:r,gutterWidth:i,wrapperWidth:e.wrapper.clientWidth}}function ni(t){return t.scroller.getBoundingClientRect().left-t.sizer.getBoundingClientRect().left}function oi(t){var e=ei(t.display),r=t.options.lineWrapping,i=r&&Math.max(5,t.display.scroller.clientWidth/ri(t.display)-3);return function(n){if(Yt(t.doc,n))return 0;var o=0;if(n.widgets)for(var s=0;s<n.widgets.length;s++)n.widgets[s].height&&(o+=n.widgets[s].height);return r?o+(Math.ceil(n.text.length/i)||1)*e:o+e}}function si(t){var e=t.doc,r=oi(t);e.iter(function(t){var e=r(t);e!=t.height&&ht(t,e)})}function ai(t,e,r,i){var n=t.display;if(!r&&"true"==fe(e).getAttribute("cm-not-content"))return null;var o,s,a=n.lineSpace.getBoundingClientRect();try{o=e.clientX-a.left,s=e.clientY-a.top}catch(e){return null}var l,c=$r(t,o,s);if(i&&1==c.xRel&&(l=lt(t.doc,c.line).text).length==c.ch){var u=B(l,l.length,t.options.tabSize)-l.length;c=vt(c.line,Math.max(0,Math.round((o-Cr(t.display).left)/ri(t.display))-u))}return c}function li(t,e){if(e>=t.display.viewTo)return null;if((e-=t.display.viewFrom)<0)return null;for(var r=t.display.view,i=0;i<r.length;i++)if((e-=r[i].size)<0)return i}function ci(t){t.display.input.showSelection(t.display.input.prepareSelection())}function ui(t,e){void 0===e&&(e=!0);for(var r=t.doc,i={},n=i.cursors=document.createDocumentFragment(),o=i.selection=document.createDocumentFragment(),s=0;s<r.sel.ranges.length;s++)if(e||s!=r.sel.primIndex){var a=r.sel.ranges[s];if(!(a.from().line>=t.display.viewTo||a.to().line<t.display.viewFrom)){var l=a.empty();(l||t.options.showCursorWhenSelecting)&&hi(t,a.head,n),l||fi(t,a,o)}}return i}function hi(t,e,r){var i=qr(t,e,"div",null,null,!t.options.singleCursorHeightPerLine),n=r.appendChild(A("div"," ","CodeMirror-cursor"));if(n.style.left=i.left+"px",n.style.top=i.top+"px",n.style.height=Math.max(0,i.bottom-i.top)*t.options.cursorHeight+"px",i.other){var o=r.appendChild(A("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"));o.style.display="",o.style.left=i.other.left+"px",o.style.top=i.other.top+"px",o.style.height=.85*(i.other.bottom-i.other.top)+"px"}}function pi(t,e){return t.top-e.top||t.left-e.left}function fi(t,e,r){var i=t.display,n=t.doc,o=document.createDocumentFragment(),s=Cr(t.display),a=s.left,l=Math.max(i.sizerWidth,Pr(t)-i.sizer.offsetLeft)-s.right,c="ltr"==n.direction;function u(t,e,r,i){e<0&&(e=0),e=Math.round(e),i=Math.round(i),o.appendChild(A("div",null,"CodeMirror-selected","position: absolute; left: "+t+"px;\n                             top: "+e+"px; width: "+(null==r?l-t:r)+"px;\n                             height: "+(i-e)+"px"))}function h(e,r,i){var o,s,h=lt(n,e),p=h.text.length;function f(r,i){return Gr(t,vt(e,r),"div",h,i)}function d(e,r,i){var n=Zr(t,h,null,e),o="ltr"==r==("after"==i)?"left":"right",s="after"==i?n.begin:n.end-(/\s/.test(h.text.charAt(n.end-1))?2:1);return f(s,o)[o]}var g=Qt(h,n.direction);return function(t,e,r,i){if(!t)return i(e,r,"ltr",0);for(var n=!1,o=0;o<t.length;++o){var s=t[o];(s.from<r&&s.to>e||e==r&&s.to==e)&&(i(Math.max(s.from,e),Math.min(s.to,r),1==s.level?"rtl":"ltr",o),n=!0)}n||i(e,r,"ltr")}(g,r||0,null==i?p:i,function(t,e,n,h){var v="ltr"==n,m=f(t,v?"left":"right"),y=f(e-1,v?"right":"left"),b=null==r&&0==t,w=null==i&&e==p,x=0==h,k=!g||h==g.length-1;if(y.top-m.top<=3){var S=(c?b:w)&&x,E=(c?w:b)&&k,C=S?a:(v?m:y).left,N=E?l:(v?y:m).right;u(C,m.top,N-C,m.bottom)}else{var P,T,A,R;v?(P=c&&b&&x?a:m.left,T=c?l:d(t,n,"before"),A=c?a:d(e,n,"after"),R=c&&w&&k?l:y.right):(P=c?d(t,n,"before"):a,T=!c&&b&&x?l:m.right,A=!c&&w&&k?a:y.left,R=c?d(e,n,"after"):l),u(P,m.top,T-P,m.bottom),m.bottom<y.top&&u(a,m.bottom,null,y.top),u(A,y.top,R-A,y.bottom)}(!o||pi(m,o)<0)&&(o=m),pi(y,o)<0&&(o=y),(!s||pi(m,s)<0)&&(s=m),pi(y,s)<0&&(s=y)}),{start:o,end:s}}var p=e.from(),f=e.to();if(p.line==f.line)h(p.line,p.ch,f.ch);else{var d=lt(n,p.line),g=lt(n,f.line),v=Vt(d)==Vt(g),m=h(p.line,p.ch,v?d.text.length+1:null).end,y=h(f.line,v?0:null,f.ch).start;v&&(m.top<y.top-2?(u(m.right,m.top,null,m.bottom),u(a,y.top,y.left,y.bottom)):u(m.right,m.top,y.left-m.right,m.bottom)),m.bottom<y.top&&u(a,m.bottom,null,y.top)}r.appendChild(o)}function di(t){if(t.state.focused){var e=t.display;clearInterval(e.blinker);var r=!0;e.cursorDiv.style.visibility="",t.options.cursorBlinkRate>0?e.blinker=setInterval(function(){return e.cursorDiv.style.visibility=(r=!r)?"":"hidden"},t.options.cursorBlinkRate):t.options.cursorBlinkRate<0&&(e.cursorDiv.style.visibility="hidden")}}function gi(t){t.state.focused||(t.display.input.focus(),mi(t))}function vi(t){t.state.delayingBlurEvent=!0,setTimeout(function(){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1,yi(t))},100)}function mi(t,e){t.state.delayingBlurEvent&&(t.state.delayingBlurEvent=!1),"nocursor"!=t.options.readOnly&&(t.state.focused||(ne(t,"focus",t,e),t.state.focused=!0,_(t.display.wrapper,"CodeMirror-focused"),t.curOp||t.display.selForContextMenu==t.doc.sel||(t.display.input.reset(),l&&setTimeout(function(){return t.display.input.reset(!0)},20)),t.display.input.receivedFocus()),di(t))}function yi(t,e){t.state.delayingBlurEvent||(t.state.focused&&(ne(t,"blur",t,e),t.state.focused=!1,N(t.display.wrapper,"CodeMirror-focused")),clearInterval(t.display.blinker),setTimeout(function(){t.state.focused||(t.display.shift=!1)},150))}function bi(t){for(var e=t.display,r=e.lineDiv.offsetTop,i=0;i<e.view.length;i++){var n=e.view[i],o=t.options.lineWrapping,l=void 0,c=0;if(!n.hidden){if(s&&a<8){var u=n.node.offsetTop+n.node.offsetHeight;l=u-r,r=u}else{var h=n.node.getBoundingClientRect();l=h.bottom-h.top,!o&&n.text.firstChild&&(c=n.text.firstChild.getBoundingClientRect().right-h.left-1)}var p=n.line.height-l;if((p>.005||p<-.005)&&(ht(n.line,l),wi(n.line),n.rest))for(var f=0;f<n.rest.length;f++)wi(n.rest[f]);if(c>t.display.sizerWidth){var d=Math.ceil(c/ri(t.display));d>t.display.maxLineLength&&(t.display.maxLineLength=d,t.display.maxLine=n.line,t.display.maxLineChanged=!0)}}}}function wi(t){if(t.widgets)for(var e=0;e<t.widgets.length;++e){var r=t.widgets[e],i=r.node.parentNode;i&&(r.height=i.offsetHeight)}}function xi(t,e,r){var i=r&&null!=r.top?Math.max(0,r.top):t.scroller.scrollTop;i=Math.floor(i-Sr(t));var n=r&&null!=r.bottom?r.bottom:i+t.wrapper.clientHeight,o=ft(e,i),s=ft(e,n);if(r&&r.ensure){var a=r.ensure.from.line,l=r.ensure.to.line;a<o?(o=a,s=ft(e,qt(lt(e,a))+t.wrapper.clientHeight)):Math.min(l,e.lastLine())>=s&&(o=ft(e,qt(lt(e,l))-t.wrapper.clientHeight),s=l)}return{from:o,to:Math.max(s,o+1)}}function ki(t){var e=t.display,r=e.view;if(e.alignWidgets||e.gutters.firstChild&&t.options.fixedGutter){for(var i=ni(e)-e.scroller.scrollLeft+t.doc.scrollLeft,n=e.gutters.offsetWidth,o=i+"px",s=0;s<r.length;s++)if(!r[s].hidden){t.options.fixedGutter&&(r[s].gutter&&(r[s].gutter.style.left=o),r[s].gutterBackground&&(r[s].gutterBackground.style.left=o));var a=r[s].alignable;if(a)for(var l=0;l<a.length;l++)a[l].style.left=o}t.options.fixedGutter&&(e.gutters.style.left=i+n+"px")}}function Si(t){if(!t.options.lineNumbers)return!1;var e=t.doc,r=gt(t.options,e.first+e.size-1),i=t.display;if(r.length!=i.lineNumChars){var n=i.measure.appendChild(A("div",[A("div",r)],"CodeMirror-linenumber CodeMirror-gutter-elt")),o=n.firstChild.offsetWidth,s=n.offsetWidth-o;return i.lineGutter.style.width="",i.lineNumInnerWidth=Math.max(o,i.lineGutter.offsetWidth-s)+1,i.lineNumWidth=i.lineNumInnerWidth+s,i.lineNumChars=i.lineNumInnerWidth?r.length:-1,i.lineGutter.style.width=i.lineNumWidth+"px",cn(t),!0}return!1}function Ei(t,e){var r=t.display,i=ei(t.display);e.top<0&&(e.top=0);var n=t.curOp&&null!=t.curOp.scrollTop?t.curOp.scrollTop:r.scroller.scrollTop,o=Tr(t),s={};e.bottom-e.top>o&&(e.bottom=e.top+o);var a=t.doc.height+Er(r),l=e.top<i,c=e.bottom>a-i;if(e.top<n)s.scrollTop=l?0:e.top;else if(e.bottom>n+o){var u=Math.min(e.top,(c?a:e.bottom)-o);u!=n&&(s.scrollTop=u)}var h=t.curOp&&null!=t.curOp.scrollLeft?t.curOp.scrollLeft:r.scroller.scrollLeft,p=Pr(t)-(t.options.fixedGutter?r.gutters.offsetWidth:0),f=e.right-e.left>p;return f&&(e.right=e.left+p),e.left<10?s.scrollLeft=0:e.left<h?s.scrollLeft=Math.max(0,e.left-(f?0:10)):e.right>p+h-3&&(s.scrollLeft=e.right+(f?0:10)-p),s}function Ci(t,e){null!=e&&(Ti(t),t.curOp.scrollTop=(null==t.curOp.scrollTop?t.doc.scrollTop:t.curOp.scrollTop)+e)}function Ni(t){Ti(t);var e=t.getCursor();t.curOp.scrollToPos={from:e,to:e,margin:t.options.cursorScrollMargin}}function Pi(t,e,r){null==e&&null==r||Ti(t),null!=e&&(t.curOp.scrollLeft=e),null!=r&&(t.curOp.scrollTop=r)}function Ti(t){var e=t.curOp.scrollToPos;if(e){t.curOp.scrollToPos=null;var r=Xr(t,e.from),i=Xr(t,e.to);Ai(t,r,i,e.margin)}}function Ai(t,e,r,i){var n=Ei(t,{left:Math.min(e.left,r.left),top:Math.min(e.top,r.top)-i,right:Math.max(e.right,r.right),bottom:Math.max(e.bottom,r.bottom)+i});Pi(t,n.scrollLeft,n.scrollTop)}function Ri(t,e){Math.abs(t.doc.scrollTop-e)<2||(r||ln(t,{top:e}),Oi(t,e,!0),r&&ln(t),rn(t,100))}function Oi(t,e,r){e=Math.min(t.display.scroller.scrollHeight-t.display.scroller.clientHeight,e),(t.display.scroller.scrollTop!=e||r)&&(t.doc.scrollTop=e,t.display.scrollbars.setScrollTop(e),t.display.scroller.scrollTop!=e&&(t.display.scroller.scrollTop=e))}function Li(t,e,r,i){e=Math.min(e,t.display.scroller.scrollWidth-t.display.scroller.clientWidth),(r?e==t.doc.scrollLeft:Math.abs(t.doc.scrollLeft-e)<2)&&!i||(t.doc.scrollLeft=e,ki(t),t.display.scroller.scrollLeft!=e&&(t.display.scroller.scrollLeft=e),t.display.scrollbars.setScrollLeft(e))}function _i(t){var e=t.display,r=e.gutters.offsetWidth,i=Math.round(t.doc.height+Er(t.display));return{clientHeight:e.scroller.clientHeight,viewHeight:e.wrapper.clientHeight,scrollWidth:e.scroller.scrollWidth,clientWidth:e.scroller.clientWidth,viewWidth:e.wrapper.clientWidth,barLeft:t.options.fixedGutter?r:0,docHeight:i,scrollHeight:i+Nr(t)+e.barHeight,nativeBarWidth:e.nativeBarWidth,gutterWidth:r}}var Mi=function(t,e,r){this.cm=r;var i=this.vert=A("div",[A("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),n=this.horiz=A("div",[A("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");i.tabIndex=n.tabIndex=-1,t(i),t(n),ee(i,"scroll",function(){i.clientHeight&&e(i.scrollTop,"vertical")}),ee(n,"scroll",function(){n.clientWidth&&e(n.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,s&&a<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")};Mi.prototype.update=function(t){var e=t.scrollWidth>t.clientWidth+1,r=t.scrollHeight>t.clientHeight+1,i=t.nativeBarWidth;if(r){this.vert.style.display="block",this.vert.style.bottom=e?i+"px":"0";var n=t.viewHeight-(e?i:0);this.vert.firstChild.style.height=Math.max(0,t.scrollHeight-t.clientHeight+n)+"px"}else this.vert.style.display="",this.vert.firstChild.style.height="0";if(e){this.horiz.style.display="block",this.horiz.style.right=r?i+"px":"0",this.horiz.style.left=t.barLeft+"px";var o=t.viewWidth-t.barLeft-(r?i:0);this.horiz.firstChild.style.width=Math.max(0,t.scrollWidth-t.clientWidth+o)+"px"}else this.horiz.style.display="",this.horiz.firstChild.style.width="0";return!this.checkedZeroWidth&&t.clientHeight>0&&(0==i&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:r?i:0,bottom:e?i:0}},Mi.prototype.setScrollLeft=function(t){this.horiz.scrollLeft!=t&&(this.horiz.scrollLeft=t),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},Mi.prototype.setScrollTop=function(t){this.vert.scrollTop!=t&&(this.vert.scrollTop=t),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},Mi.prototype.zeroWidthHack=function(){var t=y&&!f?"12px":"18px";this.horiz.style.height=this.vert.style.width=t,this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new U,this.disableVert=new U},Mi.prototype.enableZeroWidthBar=function(t,e,r){t.style.pointerEvents="auto",e.set(1e3,function i(){var n=t.getBoundingClientRect(),o="vert"==r?document.elementFromPoint(n.right-1,(n.top+n.bottom)/2):document.elementFromPoint((n.right+n.left)/2,n.bottom-1);o!=t?t.style.pointerEvents="none":e.set(1e3,i)})},Mi.prototype.clear=function(){var t=this.horiz.parentNode;t.removeChild(this.horiz),t.removeChild(this.vert)};var Ii=function(){};function Di(t,e){e||(e=_i(t));var r=t.display.barWidth,i=t.display.barHeight;Fi(t,e);for(var n=0;n<4&&r!=t.display.barWidth||i!=t.display.barHeight;n++)r!=t.display.barWidth&&t.options.lineWrapping&&bi(t),Fi(t,_i(t)),r=t.display.barWidth,i=t.display.barHeight}function Fi(t,e){var r=t.display,i=r.scrollbars.update(e);r.sizer.style.paddingRight=(r.barWidth=i.right)+"px",r.sizer.style.paddingBottom=(r.barHeight=i.bottom)+"px",r.heightForcer.style.borderBottom=i.bottom+"px solid transparent",i.right&&i.bottom?(r.scrollbarFiller.style.display="block",r.scrollbarFiller.style.height=i.bottom+"px",r.scrollbarFiller.style.width=i.right+"px"):r.scrollbarFiller.style.display="",i.bottom&&t.options.coverGutterNextToScrollbar&&t.options.fixedGutter?(r.gutterFiller.style.display="block",r.gutterFiller.style.height=i.bottom+"px",r.gutterFiller.style.width=e.gutterWidth+"px"):r.gutterFiller.style.display=""}Ii.prototype.update=function(){return{bottom:0,right:0}},Ii.prototype.setScrollLeft=function(){},Ii.prototype.setScrollTop=function(){},Ii.prototype.clear=function(){};var Bi={native:Mi,null:Ii};function Ui(t){t.display.scrollbars&&(t.display.scrollbars.clear(),t.display.scrollbars.addClass&&N(t.display.wrapper,t.display.scrollbars.addClass)),t.display.scrollbars=new Bi[t.options.scrollbarStyle](function(e){t.display.wrapper.insertBefore(e,t.display.scrollbarFiller),ee(e,"mousedown",function(){t.state.focused&&setTimeout(function(){return t.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,r){"horizontal"==r?Li(t,e):Ri(t,e)},t),t.display.scrollbars.addClass&&_(t.display.wrapper,t.display.scrollbars.addClass)}var ji=0;function Wi(t){var e;t.curOp={cm:t,viewChanged:!1,startHeight:t.doc.height,forceUpdate:!1,updateInput:0,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++ji},e=t.curOp,sr?sr.ops.push(e):e.ownsGroup=sr={ops:[e],delayedCallbacks:[]}}function Vi(t){var e=t.curOp;e&&function(t,e){var r=t.ownsGroup;if(r)try{!function(t){var e=t.delayedCallbacks,r=0;do{for(;r<e.length;r++)e[r].call(null);for(var i=0;i<t.ops.length;i++){var n=t.ops[i];if(n.cursorActivityHandlers)for(;n.cursorActivityCalled<n.cursorActivityHandlers.length;)n.cursorActivityHandlers[n.cursorActivityCalled++].call(null,n.cm)}}while(r<e.length)}(r)}finally{sr=null,e(r)}}(e,function(t){for(var e=0;e<t.ops.length;e++)t.ops[e].cm.curOp=null;!function(t){for(var e=t.ops,r=0;r<e.length;r++)zi(e[r]);for(var i=0;i<e.length;i++)(n=e[i]).updatedDisplay=n.mustUpdate&&sn(n.cm,n.update);for(var n,o=0;o<e.length;o++)Hi(e[o]);for(var s=0;s<e.length;s++)Yi(e[s]);for(var a=0;a<e.length;a++)Gi(e[a])}(t)})}function zi(t){var e=t.cm,r=e.display;!function(t){var e=t.display;!e.scrollbarsClipped&&e.scroller.offsetWidth&&(e.nativeBarWidth=e.scroller.offsetWidth-e.scroller.clientWidth,e.heightForcer.style.height=Nr(t)+"px",e.sizer.style.marginBottom=-e.nativeBarWidth+"px",e.sizer.style.borderRightWidth=Nr(t)+"px",e.scrollbarsClipped=!0)}(e),t.updateMaxLine&&Kt(e),t.mustUpdate=t.viewChanged||t.forceUpdate||null!=t.scrollTop||t.scrollToPos&&(t.scrollToPos.from.line<r.viewFrom||t.scrollToPos.to.line>=r.viewTo)||r.maxLineChanged&&e.options.lineWrapping,t.update=t.mustUpdate&&new on(e,t.mustUpdate&&{top:t.scrollTop,ensure:t.scrollToPos},t.forceUpdate)}function Hi(t){var e=t.cm,r=e.display;t.updatedDisplay&&bi(e),t.barMeasure=_i(e),r.maxLineChanged&&!e.options.lineWrapping&&(t.adjustWidthTo=Rr(e,r.maxLine,r.maxLine.text.length).left+3,e.display.sizerWidth=t.adjustWidthTo,t.barMeasure.scrollWidth=Math.max(r.scroller.clientWidth,r.sizer.offsetLeft+t.adjustWidthTo+Nr(e)+e.display.barWidth),t.maxScrollLeft=Math.max(0,r.sizer.offsetLeft+t.adjustWidthTo-Pr(e))),(t.updatedDisplay||t.selectionChanged)&&(t.preparedSelection=r.input.prepareSelection())}function Yi(t){var e=t.cm;null!=t.adjustWidthTo&&(e.display.sizer.style.minWidth=t.adjustWidthTo+"px",t.maxScrollLeft<e.doc.scrollLeft&&Li(e,Math.min(e.display.scroller.scrollLeft,t.maxScrollLeft),!0),e.display.maxLineChanged=!1);var r=t.focus&&t.focus==L();t.preparedSelection&&e.display.input.showSelection(t.preparedSelection,r),(t.updatedDisplay||t.startHeight!=e.doc.height)&&Di(e,t.barMeasure),t.updatedDisplay&&un(e,t.barMeasure),t.selectionChanged&&di(e),e.state.focused&&t.updateInput&&e.display.input.reset(t.typing),r&&gi(t.cm)}function Gi(t){var e=t.cm,r=e.display,i=e.doc;if(t.updatedDisplay&&an(e,t.update),null==r.wheelStartX||null==t.scrollTop&&null==t.scrollLeft&&!t.scrollToPos||(r.wheelStartX=r.wheelStartY=null),null!=t.scrollTop&&Oi(e,t.scrollTop,t.forceScroll),null!=t.scrollLeft&&Li(e,t.scrollLeft,!0,!0),t.scrollToPos){var n=function(t,e,r,i){var n;null==i&&(i=0),t.options.lineWrapping||e!=r||(e=e.ch?vt(e.line,"before"==e.sticky?e.ch-1:e.ch,"after"):e,r="before"==e.sticky?vt(e.line,e.ch+1,"before"):e);for(var o=0;o<5;o++){var s=!1,a=qr(t,e),l=r&&r!=e?qr(t,r):a;n={left:Math.min(a.left,l.left),top:Math.min(a.top,l.top)-i,right:Math.max(a.left,l.left),bottom:Math.max(a.bottom,l.bottom)+i};var c=Ei(t,n),u=t.doc.scrollTop,h=t.doc.scrollLeft;if(null!=c.scrollTop&&(Ri(t,c.scrollTop),Math.abs(t.doc.scrollTop-u)>1&&(s=!0)),null!=c.scrollLeft&&(Li(t,c.scrollLeft),Math.abs(t.doc.scrollLeft-h)>1&&(s=!0)),!s)break}return n}(e,St(i,t.scrollToPos.from),St(i,t.scrollToPos.to),t.scrollToPos.margin);!function(t,e){if(!oe(t,"scrollCursorIntoView")){var r=t.display,i=r.sizer.getBoundingClientRect(),n=null;if(e.top+i.top<0?n=!0:e.bottom+i.top>(window.innerHeight||document.documentElement.clientHeight)&&(n=!1),null!=n&&!d){var o=A("div","​",null,"position: absolute;\n                         top: "+(e.top-r.viewOffset-Sr(t.display))+"px;\n                         height: "+(e.bottom-e.top+Nr(t)+r.barHeight)+"px;\n                         left: "+e.left+"px; width: "+Math.max(2,e.right-e.left)+"px;");t.display.lineSpace.appendChild(o),o.scrollIntoView(n),t.display.lineSpace.removeChild(o)}}}(e,n)}var o=t.maybeHiddenMarkers,s=t.maybeUnhiddenMarkers;if(o)for(var a=0;a<o.length;++a)o[a].lines.length||ne(o[a],"hide");if(s)for(var l=0;l<s.length;++l)s[l].lines.length&&ne(s[l],"unhide");r.wrapper.offsetHeight&&(i.scrollTop=e.display.scroller.scrollTop),t.changeObjs&&ne(e,"changes",e,t.changeObjs),t.update&&t.update.finish()}function qi(t,e){if(t.curOp)return e();Wi(t);try{return e()}finally{Vi(t)}}function Xi(t,e){return function(){if(t.curOp)return e.apply(t,arguments);Wi(t);try{return e.apply(t,arguments)}finally{Vi(t)}}}function Ki(t){return function(){if(this.curOp)return t.apply(this,arguments);Wi(this);try{return t.apply(this,arguments)}finally{Vi(this)}}}function $i(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);Wi(e);try{return t.apply(this,arguments)}finally{Vi(e)}}}function Ji(t,e,r,i){null==e&&(e=t.doc.first),null==r&&(r=t.doc.first+t.doc.size),i||(i=0);var n=t.display;if(i&&r<n.viewTo&&(null==n.updateLineNumbers||n.updateLineNumbers>e)&&(n.updateLineNumbers=e),t.curOp.viewChanged=!0,e>=n.viewTo)Nt&&zt(t.doc,e)<n.viewTo&&Qi(t);else if(r<=n.viewFrom)Nt&&Ht(t.doc,r+i)>n.viewFrom?Qi(t):(n.viewFrom+=i,n.viewTo+=i);else if(e<=n.viewFrom&&r>=n.viewTo)Qi(t);else if(e<=n.viewFrom){var o=tn(t,r,r+i,1);o?(n.view=n.view.slice(o.index),n.viewFrom=o.lineN,n.viewTo+=i):Qi(t)}else if(r>=n.viewTo){var s=tn(t,e,e,-1);s?(n.view=n.view.slice(0,s.index),n.viewTo=s.lineN):Qi(t)}else{var a=tn(t,e,e,-1),l=tn(t,r,r+i,1);a&&l?(n.view=n.view.slice(0,a.index).concat(or(t,a.lineN,l.lineN)).concat(n.view.slice(l.index)),n.viewTo+=i):Qi(t)}var c=n.externalMeasured;c&&(r<c.lineN?c.lineN+=i:e<c.lineN+c.size&&(n.externalMeasured=null))}function Zi(t,e,r){t.curOp.viewChanged=!0;var i=t.display,n=t.display.externalMeasured;if(n&&e>=n.lineN&&e<n.lineN+n.size&&(i.externalMeasured=null),!(e<i.viewFrom||e>=i.viewTo)){var o=i.view[li(t,e)];if(null!=o.node){var s=o.changes||(o.changes=[]);-1==j(s,r)&&s.push(r)}}}function Qi(t){t.display.viewFrom=t.display.viewTo=t.doc.first,t.display.view=[],t.display.viewOffset=0}function tn(t,e,r,i){var n,o=li(t,e),s=t.display.view;if(!Nt||r==t.doc.first+t.doc.size)return{index:o,lineN:r};for(var a=t.display.viewFrom,l=0;l<o;l++)a+=s[l].size;if(a!=e){if(i>0){if(o==s.length-1)return null;n=a+s[o].size-e,o++}else n=a-e;e+=n,r+=n}for(;zt(t.doc,r)!=r;){if(o==(i<0?0:s.length-1))return null;r+=i*s[o-(i<0?1:0)].size,o+=i}return{index:o,lineN:r}}function en(t){for(var e=t.display.view,r=0,i=0;i<e.length;i++){var n=e[i];n.hidden||n.node&&!n.changes||++r}return r}function rn(t,e){t.doc.highlightFrontier<t.display.viewTo&&t.state.highlight.set(e,D(nn,t))}function nn(t){var e=t.doc;if(!(e.highlightFrontier>=t.display.viewTo)){var r=+new Date+t.options.workTime,i=Ue(t,e.highlightFrontier),n=[];e.iter(i.line,Math.min(e.first+e.size,t.display.viewTo+500),function(o){if(i.line>=t.display.viewFrom){var s=o.styles,a=o.text.length>t.options.maxHighlightLength?Oe(e.mode,i.state):null,l=Fe(t,o,i,!0);a&&(i.state=a),o.styles=l.styles;var c=o.styleClasses,u=l.classes;u?o.styleClasses=u:c&&(o.styleClasses=null);for(var h=!s||s.length!=o.styles.length||c!=u&&(!c||!u||c.bgClass!=u.bgClass||c.textClass!=u.textClass),p=0;!h&&p<s.length;++p)h=s[p]!=o.styles[p];h&&n.push(i.line),o.stateAfter=i.save(),i.nextLine()}else o.text.length<=t.options.maxHighlightLength&&je(t,o.text,i),o.stateAfter=i.line%5==0?i.save():null,i.nextLine();if(+new Date>r)return rn(t,t.options.workDelay),!0}),e.highlightFrontier=i.line,e.modeFrontier=Math.max(e.modeFrontier,i.line),n.length&&qi(t,function(){for(var e=0;e<n.length;e++)Zi(t,n[e],"text")})}}var on=function(t,e,r){var i=t.display;this.viewport=e,this.visible=xi(i,t.doc,e),this.editorIsHidden=!i.wrapper.offsetWidth,this.wrapperHeight=i.wrapper.clientHeight,this.wrapperWidth=i.wrapper.clientWidth,this.oldDisplayWidth=Pr(t),this.force=r,this.dims=ii(t),this.events=[]};function sn(t,e){var r=t.display,i=t.doc;if(e.editorIsHidden)return Qi(t),!1;if(!e.force&&e.visible.from>=r.viewFrom&&e.visible.to<=r.viewTo&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo)&&r.renderedView==r.view&&0==en(t))return!1;Si(t)&&(Qi(t),e.dims=ii(t));var n=i.first+i.size,o=Math.max(e.visible.from-t.options.viewportMargin,i.first),s=Math.min(n,e.visible.to+t.options.viewportMargin);r.viewFrom<o&&o-r.viewFrom<20&&(o=Math.max(i.first,r.viewFrom)),r.viewTo>s&&r.viewTo-s<20&&(s=Math.min(n,r.viewTo)),Nt&&(o=zt(t.doc,o),s=Ht(t.doc,s));var a=o!=r.viewFrom||s!=r.viewTo||r.lastWrapHeight!=e.wrapperHeight||r.lastWrapWidth!=e.wrapperWidth;!function(t,e,r){var i=t.display;0==i.view.length||e>=i.viewTo||r<=i.viewFrom?(i.view=or(t,e,r),i.viewFrom=e):(i.viewFrom>e?i.view=or(t,e,i.viewFrom).concat(i.view):i.viewFrom<e&&(i.view=i.view.slice(li(t,e))),i.viewFrom=e,i.viewTo<r?i.view=i.view.concat(or(t,i.viewTo,r)):i.viewTo>r&&(i.view=i.view.slice(0,li(t,r)))),i.viewTo=r}(t,o,s),r.viewOffset=qt(lt(t.doc,r.viewFrom)),t.display.mover.style.top=r.viewOffset+"px";var c=en(t);if(!a&&0==c&&!e.force&&r.renderedView==r.view&&(null==r.updateLineNumbers||r.updateLineNumbers>=r.viewTo))return!1;var u=function(t){if(t.hasFocus())return null;var e=L();if(!e||!O(t.display.lineDiv,e))return null;var r={activeElt:e};if(window.getSelection){var i=window.getSelection();i.anchorNode&&i.extend&&O(t.display.lineDiv,i.anchorNode)&&(r.anchorNode=i.anchorNode,r.anchorOffset=i.anchorOffset,r.focusNode=i.focusNode,r.focusOffset=i.focusOffset)}return r}(t);return c>4&&(r.lineDiv.style.display="none"),function(t,e,r){var i=t.display,n=t.options.lineNumbers,o=i.lineDiv,s=o.firstChild;function a(e){var r=e.nextSibling;return l&&y&&t.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),r}for(var c=i.view,u=i.viewFrom,h=0;h<c.length;h++){var p=c[h];if(p.hidden);else if(p.node&&p.node.parentNode==o){for(;s!=p.node;)s=a(s);var f=n&&null!=e&&e<=u&&p.lineNumber;p.changes&&(j(p.changes,"gutter")>-1&&(f=!1),ur(t,p,u,r)),f&&(P(p.lineNumber),p.lineNumber.appendChild(document.createTextNode(gt(t.options,u)))),s=p.node.nextSibling}else{var d=mr(t,p,u,r);o.insertBefore(d,s)}u+=p.size}for(;s;)s=a(s)}(t,r.updateLineNumbers,e.dims),c>4&&(r.lineDiv.style.display=""),r.renderedView=r.view,function(t){if(t&&t.activeElt&&t.activeElt!=L()&&(t.activeElt.focus(),t.anchorNode&&O(document.body,t.anchorNode)&&O(document.body,t.focusNode))){var e=window.getSelection(),r=document.createRange();r.setEnd(t.anchorNode,t.anchorOffset),r.collapse(!1),e.removeAllRanges(),e.addRange(r),e.extend(t.focusNode,t.focusOffset)}}(u),P(r.cursorDiv),P(r.selectionDiv),r.gutters.style.height=r.sizer.style.minHeight=0,a&&(r.lastWrapHeight=e.wrapperHeight,r.lastWrapWidth=e.wrapperWidth,rn(t,400)),r.updateLineNumbers=null,!0}function an(t,e){for(var r=e.viewport,i=!0;(i&&t.options.lineWrapping&&e.oldDisplayWidth!=Pr(t)||(r&&null!=r.top&&(r={top:Math.min(t.doc.height+Er(t.display)-Tr(t),r.top)}),e.visible=xi(t.display,t.doc,r),!(e.visible.from>=t.display.viewFrom&&e.visible.to<=t.display.viewTo)))&&sn(t,e);i=!1){bi(t);var n=_i(t);ci(t),Di(t,n),un(t,n),e.force=!1}e.signal(t,"update",t),t.display.viewFrom==t.display.reportedViewFrom&&t.display.viewTo==t.display.reportedViewTo||(e.signal(t,"viewportChange",t,t.display.viewFrom,t.display.viewTo),t.display.reportedViewFrom=t.display.viewFrom,t.display.reportedViewTo=t.display.viewTo)}function ln(t,e){var r=new on(t,e);if(sn(t,r)){bi(t),an(t,r);var i=_i(t);ci(t),Di(t,i),un(t,i),r.finish()}}function cn(t){var e=t.display.gutters.offsetWidth;t.display.sizer.style.marginLeft=e+"px"}function un(t,e){t.display.sizer.style.minHeight=e.docHeight+"px",t.display.heightForcer.style.top=e.docHeight+"px",t.display.gutters.style.height=e.docHeight+t.display.barHeight+Nr(t)+"px"}function hn(t){var e=t.display.gutters,r=t.options.gutters;P(e);for(var i=0;i<r.length;++i){var n=r[i],o=e.appendChild(A("div",null,"CodeMirror-gutter "+n));"CodeMirror-linenumbers"==n&&(t.display.lineGutter=o,o.style.width=(t.display.lineNumWidth||1)+"px")}e.style.display=i?"":"none",cn(t)}function pn(t){var e=j(t.gutters,"CodeMirror-linenumbers");-1==e&&t.lineNumbers?t.gutters=t.gutters.concat(["CodeMirror-linenumbers"]):e>-1&&!t.lineNumbers&&(t.gutters=t.gutters.slice(0),t.gutters.splice(e,1))}on.prototype.signal=function(t,e){ae(t,e)&&this.events.push(arguments)},on.prototype.finish=function(){for(var t=0;t<this.events.length;t++)ne.apply(null,this.events[t])};var fn=0,dn=null;function gn(t){var e=t.wheelDeltaX,r=t.wheelDeltaY;return null==e&&t.detail&&t.axis==t.HORIZONTAL_AXIS&&(e=t.detail),null==r&&t.detail&&t.axis==t.VERTICAL_AXIS?r=t.detail:null==r&&(r=t.wheelDelta),{x:e,y:r}}function vn(t){var e=gn(t);return e.x*=dn,e.y*=dn,e}function mn(t,e){var i=gn(e),n=i.x,o=i.y,s=t.display,a=s.scroller,c=a.scrollWidth>a.clientWidth,u=a.scrollHeight>a.clientHeight;if(n&&c||o&&u){if(o&&y&&l)t:for(var p=e.target,f=s.view;p!=a;p=p.parentNode)for(var d=0;d<f.length;d++)if(f[d].node==p){t.display.currentWheelTarget=p;break t}if(n&&!r&&!h&&null!=dn)return o&&u&&Ri(t,Math.max(0,a.scrollTop+o*dn)),Li(t,Math.max(0,a.scrollLeft+n*dn)),(!o||o&&u)&&ce(e),void(s.wheelStartX=null);if(o&&null!=dn){var g=o*dn,v=t.doc.scrollTop,m=v+s.wrapper.clientHeight;g<0?v=Math.max(0,v+g-50):m=Math.min(t.doc.height,m+g+50),ln(t,{top:v,bottom:m})}fn<20&&(null==s.wheelStartX?(s.wheelStartX=a.scrollLeft,s.wheelStartY=a.scrollTop,s.wheelDX=n,s.wheelDY=o,setTimeout(function(){if(null!=s.wheelStartX){var t=a.scrollLeft-s.wheelStartX,e=a.scrollTop-s.wheelStartY,r=e&&s.wheelDY&&e/s.wheelDY||t&&s.wheelDX&&t/s.wheelDX;s.wheelStartX=s.wheelStartY=null,r&&(dn=(dn*fn+r)/(fn+1),++fn)}},200)):(s.wheelDX+=n,s.wheelDY+=o))}}s?dn=-.53:r?dn=15:u?dn=-.7:p&&(dn=-1/3);var yn=function(t,e){this.ranges=t,this.primIndex=e};yn.prototype.primary=function(){return this.ranges[this.primIndex]},yn.prototype.equals=function(t){if(t==this)return!0;if(t.primIndex!=this.primIndex||t.ranges.length!=this.ranges.length)return!1;for(var e=0;e<this.ranges.length;e++){var r=this.ranges[e],i=t.ranges[e];if(!yt(r.anchor,i.anchor)||!yt(r.head,i.head))return!1}return!0},yn.prototype.deepCopy=function(){for(var t=[],e=0;e<this.ranges.length;e++)t[e]=new bn(bt(this.ranges[e].anchor),bt(this.ranges[e].head));return new yn(t,this.primIndex)},yn.prototype.somethingSelected=function(){for(var t=0;t<this.ranges.length;t++)if(!this.ranges[t].empty())return!0;return!1},yn.prototype.contains=function(t,e){e||(e=t);for(var r=0;r<this.ranges.length;r++){var i=this.ranges[r];if(mt(e,i.from())>=0&&mt(t,i.to())<=0)return r}return-1};var bn=function(t,e){this.anchor=t,this.head=e};function wn(t,e,r){var i=t&&t.options.selectionsMayTouch,n=e[r];e.sort(function(t,e){return mt(t.from(),e.from())}),r=j(e,n);for(var o=1;o<e.length;o++){var s=e[o],a=e[o-1],l=mt(a.to(),s.from());if(i&&!s.empty()?l>0:l>=0){var c=xt(a.from(),s.from()),u=wt(a.to(),s.to()),h=a.empty()?s.from()==s.head:a.from()==a.head;o<=r&&--r,e.splice(--o,2,new bn(h?u:c,h?c:u))}}return new yn(e,r)}function xn(t,e){return new yn([new bn(t,e||t)],0)}function kn(t){return t.text?vt(t.from.line+t.text.length-1,K(t.text).length+(1==t.text.length?t.from.ch:0)):t.to}function Sn(t,e){if(mt(t,e.from)<0)return t;if(mt(t,e.to)<=0)return kn(e);var r=t.line+e.text.length-(e.to.line-e.from.line)-1,i=t.ch;return t.line==e.to.line&&(i+=kn(e).ch-e.to.ch),vt(r,i)}function En(t,e){for(var r=[],i=0;i<t.sel.ranges.length;i++){var n=t.sel.ranges[i];r.push(new bn(Sn(n.anchor,e),Sn(n.head,e)))}return wn(t.cm,r,t.sel.primIndex)}function Cn(t,e,r){return t.line==e.line?vt(r.line,t.ch-e.ch+r.ch):vt(r.line+(t.line-e.line),t.ch)}function Nn(t){t.doc.mode=Te(t.options,t.doc.modeOption),Pn(t)}function Pn(t){t.doc.iter(function(t){t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null)}),t.doc.modeFrontier=t.doc.highlightFrontier=t.doc.first,rn(t,100),t.state.modeGen++,t.curOp&&Ji(t)}function Tn(t,e){return 0==e.from.ch&&0==e.to.ch&&""==K(e.text)&&(!t.cm||t.cm.options.wholeLineUpdateBefore)}function An(t,e,r,i){function n(t){return r?r[t]:null}function o(t,r,n){!function(t,e,r,i){t.text=e,t.stateAfter&&(t.stateAfter=null),t.styles&&(t.styles=null),null!=t.order&&(t.order=null),Lt(t),_t(t,r);var n=i?i(t):1;n!=t.height&&ht(t,n)}(t,r,n,i),lr(t,"change",t,e)}function s(t,e){for(var r=[],o=t;o<e;++o)r.push(new qe(c[o],n(o),i));return r}var a=e.from,l=e.to,c=e.text,u=lt(t,a.line),h=lt(t,l.line),p=K(c),f=n(c.length-1),d=l.line-a.line;if(e.full)t.insert(0,s(0,c.length)),t.remove(c.length,t.size-c.length);else if(Tn(t,e)){var g=s(0,c.length-1);o(h,h.text,f),d&&t.remove(a.line,d),g.length&&t.insert(a.line,g)}else if(u==h)if(1==c.length)o(u,u.text.slice(0,a.ch)+p+u.text.slice(l.ch),f);else{var v=s(1,c.length-1);v.push(new qe(p+u.text.slice(l.ch),f,i)),o(u,u.text.slice(0,a.ch)+c[0],n(0)),t.insert(a.line+1,v)}else if(1==c.length)o(u,u.text.slice(0,a.ch)+c[0]+h.text.slice(l.ch),n(0)),t.remove(a.line+1,d);else{o(u,u.text.slice(0,a.ch)+c[0],n(0)),o(h,p+h.text.slice(l.ch),f);var m=s(1,c.length-1);d>1&&t.remove(a.line+1,d-1),t.insert(a.line+1,m)}lr(t,"change",t,e)}function Rn(t,e,r){!function t(i,n,o){if(i.linked)for(var s=0;s<i.linked.length;++s){var a=i.linked[s];if(a.doc!=n){var l=o&&a.sharedHist;r&&!l||(e(a.doc,l),t(a.doc,i,l))}}}(t,null,!0)}function On(t,e){if(e.cm)throw new Error("This document is already in use.");t.doc=e,e.cm=t,si(t),Nn(t),Ln(t),t.options.lineWrapping||Kt(t),t.options.mode=e.modeOption,Ji(t)}function Ln(t){("rtl"==t.doc.direction?_:N)(t.display.lineDiv,"CodeMirror-rtl")}function _n(t){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=t||1}function Mn(t,e){var r={from:bt(e.from),to:kn(e),text:ct(t,e.from,e.to)};return Un(t,r,e.from.line,e.to.line+1),Rn(t,function(t){return Un(t,r,e.from.line,e.to.line+1)},!0),r}function In(t){for(;t.length;){var e=K(t);if(!e.ranges)break;t.pop()}}function Dn(t,e,r,i){var n=t.history;n.undone.length=0;var o,s,a=+new Date;if((n.lastOp==i||n.lastOrigin==e.origin&&e.origin&&("+"==e.origin.charAt(0)&&n.lastModTime>a-(t.cm?t.cm.options.historyEventDelay:500)||"*"==e.origin.charAt(0)))&&(o=function(t,e){return e?(In(t.done),K(t.done)):t.done.length&&!K(t.done).ranges?K(t.done):t.done.length>1&&!t.done[t.done.length-2].ranges?(t.done.pop(),K(t.done)):void 0}(n,n.lastOp==i)))s=K(o.changes),0==mt(e.from,e.to)&&0==mt(e.from,s.to)?s.to=kn(e):o.changes.push(Mn(t,e));else{var l=K(n.done);for(l&&l.ranges||Bn(t.sel,n.done),o={changes:[Mn(t,e)],generation:n.generation},n.done.push(o);n.done.length>n.undoDepth;)n.done.shift(),n.done[0].ranges||n.done.shift()}n.done.push(r),n.generation=++n.maxGeneration,n.lastModTime=n.lastSelTime=a,n.lastOp=n.lastSelOp=i,n.lastOrigin=n.lastSelOrigin=e.origin,s||ne(t,"historyAdded")}function Fn(t,e,r,i){var n=t.history,o=i&&i.origin;r==n.lastSelOp||o&&n.lastSelOrigin==o&&(n.lastModTime==n.lastSelTime&&n.lastOrigin==o||function(t,e,r,i){var n=e.charAt(0);return"*"==n||"+"==n&&r.ranges.length==i.ranges.length&&r.somethingSelected()==i.somethingSelected()&&new Date-t.history.lastSelTime<=(t.cm?t.cm.options.historyEventDelay:500)}(t,o,K(n.done),e))?n.done[n.done.length-1]=e:Bn(e,n.done),n.lastSelTime=+new Date,n.lastSelOrigin=o,n.lastSelOp=r,i&&!1!==i.clearRedo&&In(n.undone)}function Bn(t,e){var r=K(e);r&&r.ranges&&r.equals(t)||e.push(t)}function Un(t,e,r,i){var n=e["spans_"+t.id],o=0;t.iter(Math.max(t.first,r),Math.min(t.first+t.size,i),function(r){r.markedSpans&&((n||(n=e["spans_"+t.id]={}))[o]=r.markedSpans),++o})}function jn(t){if(!t)return null;for(var e,r=0;r<t.length;++r)t[r].marker.explicitlyCleared?e||(e=t.slice(0,r)):e&&e.push(t[r]);return e?e.length?e:null:t}function Wn(t,e){var r=function(t,e){var r=e["spans_"+t.id];if(!r)return null;for(var i=[],n=0;n<e.text.length;++n)i.push(jn(r[n]));return i}(t,e),i=Rt(t,e);if(!r)return i;if(!i)return r;for(var n=0;n<r.length;++n){var o=r[n],s=i[n];if(o&&s)t:for(var a=0;a<s.length;++a){for(var l=s[a],c=0;c<o.length;++c)if(o[c].marker==l.marker)continue t;o.push(l)}else s&&(r[n]=s)}return r}function Vn(t,e,r){for(var i=[],n=0;n<t.length;++n){var o=t[n];if(o.ranges)i.push(r?yn.prototype.deepCopy.call(o):o);else{var s=o.changes,a=[];i.push({changes:a});for(var l=0;l<s.length;++l){var c=s[l],u=void 0;if(a.push({from:c.from,to:c.to,text:c.text}),e)for(var h in c)(u=h.match(/^spans_(\d+)$/))&&j(e,Number(u[1]))>-1&&(K(a)[h]=c[h],delete c[h])}}}return i}function zn(t,e,r,i){if(i){var n=t.anchor;if(r){var o=mt(e,n)<0;o!=mt(r,n)<0?(n=e,e=r):o!=mt(e,r)<0&&(e=r)}return new bn(n,e)}return new bn(r||e,e)}function Hn(t,e,r,i,n){null==n&&(n=t.cm&&(t.cm.display.shift||t.extend)),Kn(t,new yn([zn(t.sel.primary(),e,r,n)],0),i)}function Yn(t,e,r){for(var i=[],n=t.cm&&(t.cm.display.shift||t.extend),o=0;o<t.sel.ranges.length;o++)i[o]=zn(t.sel.ranges[o],e[o],null,n);var s=wn(t.cm,i,t.sel.primIndex);Kn(t,s,r)}function Gn(t,e,r,i){var n=t.sel.ranges.slice(0);n[e]=r,Kn(t,wn(t.cm,n,t.sel.primIndex),i)}function qn(t,e,r,i){Kn(t,xn(e,r),i)}function Xn(t,e,r){var i=t.history.done,n=K(i);n&&n.ranges?(i[i.length-1]=e,$n(t,e,r)):Kn(t,e,r)}function Kn(t,e,r){$n(t,e,r),Fn(t,t.sel,t.cm?t.cm.curOp.id:NaN,r)}function $n(t,e,r){(ae(t,"beforeSelectionChange")||t.cm&&ae(t.cm,"beforeSelectionChange"))&&(e=function(t,e,r){var i={ranges:e.ranges,update:function(e){this.ranges=[];for(var r=0;r<e.length;r++)this.ranges[r]=new bn(St(t,e[r].anchor),St(t,e[r].head))},origin:r&&r.origin};return ne(t,"beforeSelectionChange",t,i),t.cm&&ne(t.cm,"beforeSelectionChange",t.cm,i),i.ranges!=e.ranges?wn(t.cm,i.ranges,i.ranges.length-1):e}(t,e,r));var i=r&&r.bias||(mt(e.primary().head,t.sel.primary().head)<0?-1:1);Jn(t,Qn(t,e,i,!0)),r&&!1===r.scroll||!t.cm||Ni(t.cm)}function Jn(t,e){e.equals(t.sel)||(t.sel=e,t.cm&&(t.cm.curOp.updateInput=1,t.cm.curOp.selectionChanged=!0,se(t.cm)),lr(t,"cursorActivity",t))}function Zn(t){Jn(t,Qn(t,t.sel,null,!1))}function Qn(t,e,r,i){for(var n,o=0;o<e.ranges.length;o++){var s=e.ranges[o],a=e.ranges.length==t.sel.ranges.length&&t.sel.ranges[o],l=eo(t,s.anchor,a&&a.anchor,r,i),c=eo(t,s.head,a&&a.head,r,i);(n||l!=s.anchor||c!=s.head)&&(n||(n=e.ranges.slice(0,o)),n[o]=new bn(l,c))}return n?wn(t.cm,n,e.primIndex):e}function to(t,e,r,i,n){var o=lt(t,e.line);if(o.markedSpans)for(var s=0;s<o.markedSpans.length;++s){var a=o.markedSpans[s],l=a.marker;if((null==a.from||(l.inclusiveLeft?a.from<=e.ch:a.from<e.ch))&&(null==a.to||(l.inclusiveRight?a.to>=e.ch:a.to>e.ch))){if(n&&(ne(l,"beforeCursorEnter"),l.explicitlyCleared)){if(o.markedSpans){--s;continue}break}if(!l.atomic)continue;if(r){var c=l.find(i<0?1:-1),u=void 0;if((i<0?l.inclusiveRight:l.inclusiveLeft)&&(c=ro(t,c,-i,c&&c.line==e.line?o:null)),c&&c.line==e.line&&(u=mt(c,r))&&(i<0?u<0:u>0))return to(t,c,e,i,n)}var h=l.find(i<0?-1:1);return(i<0?l.inclusiveLeft:l.inclusiveRight)&&(h=ro(t,h,i,h.line==e.line?o:null)),h?to(t,h,e,i,n):null}}return e}function eo(t,e,r,i,n){var o=i||1,s=to(t,e,r,o,n)||!n&&to(t,e,r,o,!0)||to(t,e,r,-o,n)||!n&&to(t,e,r,-o,!0);return s||(t.cantEdit=!0,vt(t.first,0))}function ro(t,e,r,i){return r<0&&0==e.ch?e.line>t.first?St(t,vt(e.line-1)):null:r>0&&e.ch==(i||lt(t,e.line)).text.length?e.line<t.first+t.size-1?vt(e.line+1,0):null:new vt(e.line,e.ch+r)}function io(t){t.setSelection(vt(t.firstLine(),0),vt(t.lastLine()),z)}function no(t,e,r){var i={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){return i.canceled=!0}};return r&&(i.update=function(e,r,n,o){e&&(i.from=St(t,e)),r&&(i.to=St(t,r)),n&&(i.text=n),void 0!==o&&(i.origin=o)}),ne(t,"beforeChange",t,i),t.cm&&ne(t.cm,"beforeChange",t.cm,i),i.canceled?(t.cm&&(t.cm.curOp.updateInput=2),null):{from:i.from,to:i.to,text:i.text,origin:i.origin}}function oo(t,e,r){if(t.cm){if(!t.cm.curOp)return Xi(t.cm,oo)(t,e,r);if(t.cm.state.suppressEdits)return}if(!(ae(t,"beforeChange")||t.cm&&ae(t.cm,"beforeChange"))||(e=no(t,e,!0))){var i=Ct&&!r&&function(t,e,r){var i=null;if(t.iter(e.line,r.line+1,function(t){if(t.markedSpans)for(var e=0;e<t.markedSpans.length;++e){var r=t.markedSpans[e].marker;!r.readOnly||i&&-1!=j(i,r)||(i||(i=[])).push(r)}}),!i)return null;for(var n=[{from:e,to:r}],o=0;o<i.length;++o)for(var s=i[o],a=s.find(0),l=0;l<n.length;++l){var c=n[l];if(!(mt(c.to,a.from)<0||mt(c.from,a.to)>0)){var u=[l,1],h=mt(c.from,a.from),p=mt(c.to,a.to);(h<0||!s.inclusiveLeft&&!h)&&u.push({from:c.from,to:a.from}),(p>0||!s.inclusiveRight&&!p)&&u.push({from:a.to,to:c.to}),n.splice.apply(n,u),l+=u.length-3}}return n}(t,e.from,e.to);if(i)for(var n=i.length-1;n>=0;--n)so(t,{from:i[n].from,to:i[n].to,text:n?[""]:e.text,origin:e.origin});else so(t,e)}}function so(t,e){if(1!=e.text.length||""!=e.text[0]||0!=mt(e.from,e.to)){var r=En(t,e);Dn(t,e,r,t.cm?t.cm.curOp.id:NaN),co(t,e,r,Rt(t,e));var i=[];Rn(t,function(t,r){r||-1!=j(i,t.history)||(fo(t.history,e),i.push(t.history)),co(t,e,null,Rt(t,e))})}}function ao(t,e,r){var i=t.cm&&t.cm.state.suppressEdits;if(!i||r){for(var n,o=t.history,s=t.sel,a="undo"==e?o.done:o.undone,l="undo"==e?o.undone:o.done,c=0;c<a.length&&(n=a[c],r?!n.ranges||n.equals(t.sel):n.ranges);c++);if(c!=a.length){for(o.lastOrigin=o.lastSelOrigin=null;;){if(!(n=a.pop()).ranges){if(i)return void a.push(n);break}if(Bn(n,l),r&&!n.equals(t.sel))return void Kn(t,n,{clearRedo:!1});s=n}var u=[];Bn(s,l),l.push({changes:u,generation:o.generation}),o.generation=n.generation||++o.maxGeneration;for(var h=ae(t,"beforeChange")||t.cm&&ae(t.cm,"beforeChange"),p=function(r){var i=n.changes[r];if(i.origin=e,h&&!no(t,i,!1))return a.length=0,{};u.push(Mn(t,i));var o=r?En(t,i):K(a);co(t,i,o,Wn(t,i)),!r&&t.cm&&t.cm.scrollIntoView({from:i.from,to:kn(i)});var s=[];Rn(t,function(t,e){e||-1!=j(s,t.history)||(fo(t.history,i),s.push(t.history)),co(t,i,null,Wn(t,i))})},f=n.changes.length-1;f>=0;--f){var d=p(f);if(d)return d.v}}}}function lo(t,e){if(0!=e&&(t.first+=e,t.sel=new yn($(t.sel.ranges,function(t){return new bn(vt(t.anchor.line+e,t.anchor.ch),vt(t.head.line+e,t.head.ch))}),t.sel.primIndex),t.cm)){Ji(t.cm,t.first,t.first-e,e);for(var r=t.cm.display,i=r.viewFrom;i<r.viewTo;i++)Zi(t.cm,i,"gutter")}}function co(t,e,r,i){if(t.cm&&!t.cm.curOp)return Xi(t.cm,co)(t,e,r,i);if(e.to.line<t.first)lo(t,e.text.length-1-(e.to.line-e.from.line));else if(!(e.from.line>t.lastLine())){if(e.from.line<t.first){var n=e.text.length-1-(t.first-e.from.line);lo(t,n),e={from:vt(t.first,0),to:vt(e.to.line+n,e.to.ch),text:[K(e.text)],origin:e.origin}}var o=t.lastLine();e.to.line>o&&(e={from:e.from,to:vt(o,lt(t,o).text.length),text:[e.text[0]],origin:e.origin}),e.removed=ct(t,e.from,e.to),r||(r=En(t,e)),t.cm?function(t,e,r){var i=t.doc,n=t.display,o=e.from,s=e.to,a=!1,l=o.line;t.options.lineWrapping||(l=pt(Vt(lt(i,o.line))),i.iter(l,s.line+1,function(t){if(t==n.maxLine)return a=!0,!0})),i.sel.contains(e.from,e.to)>-1&&se(t),An(i,e,r,oi(t)),t.options.lineWrapping||(i.iter(l,o.line+e.text.length,function(t){var e=Xt(t);e>n.maxLineLength&&(n.maxLine=t,n.maxLineLength=e,n.maxLineChanged=!0,a=!1)}),a&&(t.curOp.updateMaxLine=!0)),function(t,e){if(t.modeFrontier=Math.min(t.modeFrontier,e),!(t.highlightFrontier<e-10)){for(var r=t.first,i=e-1;i>r;i--){var n=lt(t,i).stateAfter;if(n&&(!(n instanceof Ie)||i+n.lookAhead<e)){r=i+1;break}}t.highlightFrontier=Math.min(t.highlightFrontier,r)}}(i,o.line),rn(t,400);var c=e.text.length-(s.line-o.line)-1;e.full?Ji(t):o.line!=s.line||1!=e.text.length||Tn(t.doc,e)?Ji(t,o.line,s.line+1,c):Zi(t,o.line,"text");var u=ae(t,"changes"),h=ae(t,"change");if(h||u){var p={from:o,to:s,text:e.text,removed:e.removed,origin:e.origin};h&&lr(t,"change",t,p),u&&(t.curOp.changeObjs||(t.curOp.changeObjs=[])).push(p)}t.display.selForContextMenu=null}(t.cm,e,i):An(t,e,i),$n(t,r,z)}}function uo(t,e,r,i,n){var o;i||(i=r),mt(i,r)<0&&(r=(o=[i,r])[0],i=o[1]),"string"==typeof e&&(e=t.splitLines(e)),oo(t,{from:r,to:i,text:e,origin:n})}function ho(t,e,r,i){r<t.line?t.line+=i:e<t.line&&(t.line=e,t.ch=0)}function po(t,e,r,i){for(var n=0;n<t.length;++n){var o=t[n],s=!0;if(o.ranges){o.copied||((o=t[n]=o.deepCopy()).copied=!0);for(var a=0;a<o.ranges.length;a++)ho(o.ranges[a].anchor,e,r,i),ho(o.ranges[a].head,e,r,i)}else{for(var l=0;l<o.changes.length;++l){var c=o.changes[l];if(r<c.from.line)c.from=vt(c.from.line+i,c.from.ch),c.to=vt(c.to.line+i,c.to.ch);else if(e<=c.to.line){s=!1;break}}s||(t.splice(0,n+1),n=0)}}}function fo(t,e){var r=e.from.line,i=e.to.line,n=e.text.length-(i-r)-1;po(t.done,r,i,n),po(t.undone,r,i,n)}function go(t,e,r,i){var n=e,o=e;return"number"==typeof e?o=lt(t,kt(t,e)):n=pt(e),null==n?null:(i(o,n)&&t.cm&&Zi(t.cm,n,r),o)}function vo(t){this.lines=t,this.parent=null;for(var e=0,r=0;r<t.length;++r)t[r].parent=this,e+=t[r].height;this.height=e}function mo(t){this.children=t;for(var e=0,r=0,i=0;i<t.length;++i){var n=t[i];e+=n.chunkSize(),r+=n.height,n.parent=this}this.size=e,this.height=r,this.parent=null}bn.prototype.from=function(){return xt(this.anchor,this.head)},bn.prototype.to=function(){return wt(this.anchor,this.head)},bn.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},vo.prototype={chunkSize:function(){return this.lines.length},removeInner:function(t,e){for(var r=t,i=t+e;r<i;++r){var n=this.lines[r];this.height-=n.height,Xe(n),lr(n,"delete")}this.lines.splice(t,e)},collapse:function(t){t.push.apply(t,this.lines)},insertInner:function(t,e,r){this.height+=r,this.lines=this.lines.slice(0,t).concat(e).concat(this.lines.slice(t));for(var i=0;i<e.length;++i)e[i].parent=this},iterN:function(t,e,r){for(var i=t+e;t<i;++t)if(r(this.lines[t]))return!0}},mo.prototype={chunkSize:function(){return this.size},removeInner:function(t,e){this.size-=e;for(var r=0;r<this.children.length;++r){var i=this.children[r],n=i.chunkSize();if(t<n){var o=Math.min(e,n-t),s=i.height;if(i.removeInner(t,o),this.height-=s-i.height,n==o&&(this.children.splice(r--,1),i.parent=null),0==(e-=o))break;t=0}else t-=n}if(this.size-e<25&&(this.children.length>1||!(this.children[0]instanceof vo))){var a=[];this.collapse(a),this.children=[new vo(a)],this.children[0].parent=this}},collapse:function(t){for(var e=0;e<this.children.length;++e)this.children[e].collapse(t)},insertInner:function(t,e,r){this.size+=e.length,this.height+=r;for(var i=0;i<this.children.length;++i){var n=this.children[i],o=n.chunkSize();if(t<=o){if(n.insertInner(t,e,r),n.lines&&n.lines.length>50){for(var s=n.lines.length%25+25,a=s;a<n.lines.length;){var l=new vo(n.lines.slice(a,a+=25));n.height-=l.height,this.children.splice(++i,0,l),l.parent=this}n.lines=n.lines.slice(0,s),this.maybeSpill()}break}t-=o}},maybeSpill:function(){if(!(this.children.length<=10)){var t=this;do{var e=t.children.splice(t.children.length-5,5),r=new mo(e);if(t.parent){t.size-=r.size,t.height-=r.height;var i=j(t.parent.children,t);t.parent.children.splice(i+1,0,r)}else{var n=new mo(t.children);n.parent=t,t.children=[n,r],t=n}r.parent=t.parent}while(t.children.length>10);t.parent.maybeSpill()}},iterN:function(t,e,r){for(var i=0;i<this.children.length;++i){var n=this.children[i],o=n.chunkSize();if(t<o){var s=Math.min(e,o-t);if(n.iterN(t,s,r))return!0;if(0==(e-=s))break;t=0}else t-=o}}};var yo=function(t,e,r){if(r)for(var i in r)r.hasOwnProperty(i)&&(this[i]=r[i]);this.doc=t,this.node=e};function bo(t,e,r){qt(e)<(t.curOp&&t.curOp.scrollTop||t.doc.scrollTop)&&Ci(t,r)}yo.prototype.clear=function(){var t=this.doc.cm,e=this.line.widgets,r=this.line,i=pt(r);if(null!=i&&e){for(var n=0;n<e.length;++n)e[n]==this&&e.splice(n--,1);e.length||(r.widgets=null);var o=xr(this);ht(r,Math.max(0,r.height-o)),t&&(qi(t,function(){bo(t,r,-o),Zi(t,i,"widget")}),lr(t,"lineWidgetCleared",t,this,i))}},yo.prototype.changed=function(){var t=this,e=this.height,r=this.doc.cm,i=this.line;this.height=null;var n=xr(this)-e;n&&(Yt(this.doc,i)||ht(i,i.height+n),r&&qi(r,function(){r.curOp.forceUpdate=!0,bo(r,i,n),lr(r,"lineWidgetChanged",r,t,pt(i))}))},le(yo);var wo=0,xo=function(t,e){this.lines=[],this.type=e,this.doc=t,this.id=++wo};function ko(t,e,r,i,n){if(i&&i.shared)return function(t,e,r,i,n){(i=F(i)).shared=!1;var o=[ko(t,e,r,i,n)],s=o[0],a=i.widgetNode;return Rn(t,function(t){a&&(i.widgetNode=a.cloneNode(!0)),o.push(ko(t,St(t,e),St(t,r),i,n));for(var l=0;l<t.linked.length;++l)if(t.linked[l].isParent)return;s=K(o)}),new So(o,s)}(t,e,r,i,n);if(t.cm&&!t.cm.curOp)return Xi(t.cm,ko)(t,e,r,i,n);var o=new xo(t,n),s=mt(e,r);if(i&&F(i,o,!1),s>0||0==s&&!1!==o.clearWhenEmpty)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=R("span",[o.replacedWith],"CodeMirror-widget"),i.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),i.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(Wt(t,e.line,e,r,o)||e.line!=r.line&&Wt(t,r.line,e,r,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");Nt=!0}o.addToHistory&&Dn(t,{from:e,to:r,origin:"markText"},t.sel,NaN);var a,l=e.line,c=t.cm;if(t.iter(l,r.line+1,function(t){c&&o.collapsed&&!c.options.lineWrapping&&Vt(t)==c.display.maxLine&&(a=!0),o.collapsed&&l!=e.line&&ht(t,0),function(t,e){t.markedSpans=t.markedSpans?t.markedSpans.concat([e]):[e],e.marker.attachLine(t)}(t,new Pt(o,l==e.line?e.ch:null,l==r.line?r.ch:null)),++l}),o.collapsed&&t.iter(e.line,r.line+1,function(e){Yt(t,e)&&ht(e,0)}),o.clearOnEnter&&ee(o,"beforeCursorEnter",function(){return o.clear()}),o.readOnly&&(Ct=!0,(t.history.done.length||t.history.undone.length)&&t.clearHistory()),o.collapsed&&(o.id=++wo,o.atomic=!0),c){if(a&&(c.curOp.updateMaxLine=!0),o.collapsed)Ji(c,e.line,r.line+1);else if(o.className||o.startStyle||o.endStyle||o.css||o.attributes||o.title)for(var u=e.line;u<=r.line;u++)Zi(c,u,"text");o.atomic&&Zn(c.doc),lr(c,"markerAdded",c,o)}return o}xo.prototype.clear=function(){if(!this.explicitlyCleared){var t=this.doc.cm,e=t&&!t.curOp;if(e&&Wi(t),ae(this,"clear")){var r=this.find();r&&lr(this,"clear",r.from,r.to)}for(var i=null,n=null,o=0;o<this.lines.length;++o){var s=this.lines[o],a=Tt(s.markedSpans,this);t&&!this.collapsed?Zi(t,pt(s),"text"):t&&(null!=a.to&&(n=pt(s)),null!=a.from&&(i=pt(s))),s.markedSpans=At(s.markedSpans,a),null==a.from&&this.collapsed&&!Yt(this.doc,s)&&t&&ht(s,ei(t.display))}if(t&&this.collapsed&&!t.options.lineWrapping)for(var l=0;l<this.lines.length;++l){var c=Vt(this.lines[l]),u=Xt(c);u>t.display.maxLineLength&&(t.display.maxLine=c,t.display.maxLineLength=u,t.display.maxLineChanged=!0)}null!=i&&t&&this.collapsed&&Ji(t,i,n+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,t&&Zn(t.doc)),t&&lr(t,"markerCleared",t,this,i,n),e&&Vi(t),this.parent&&this.parent.clear()}},xo.prototype.find=function(t,e){var r,i;null==t&&"bookmark"==this.type&&(t=1);for(var n=0;n<this.lines.length;++n){var o=this.lines[n],s=Tt(o.markedSpans,this);if(null!=s.from&&(r=vt(e?o:pt(o),s.from),-1==t))return r;if(null!=s.to&&(i=vt(e?o:pt(o),s.to),1==t))return i}return r&&{from:r,to:i}},xo.prototype.changed=function(){var t=this,e=this.find(-1,!0),r=this,i=this.doc.cm;e&&i&&qi(i,function(){var n=e.line,o=pt(e.line),s=Or(i,o);if(s&&(Br(s),i.curOp.selectionChanged=i.curOp.forceUpdate=!0),i.curOp.updateMaxLine=!0,!Yt(r.doc,n)&&null!=r.height){var a=r.height;r.height=null;var l=xr(r)-a;l&&ht(n,n.height+l)}lr(i,"markerChanged",i,t)})},xo.prototype.attachLine=function(t){if(!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;e.maybeHiddenMarkers&&-1!=j(e.maybeHiddenMarkers,this)||(e.maybeUnhiddenMarkers||(e.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(t)},xo.prototype.detachLine=function(t){if(this.lines.splice(j(this.lines,t),1),!this.lines.length&&this.doc.cm){var e=this.doc.cm.curOp;(e.maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)}},le(xo);var So=function(t,e){this.markers=t,this.primary=e;for(var r=0;r<t.length;++r)t[r].parent=this};function Eo(t){return t.findMarks(vt(t.first,0),t.clipPos(vt(t.lastLine())),function(t){return t.parent})}function Co(t){for(var e=function(e){var r=t[e],i=[r.primary.doc];Rn(r.primary.doc,function(t){return i.push(t)});for(var n=0;n<r.markers.length;n++){var o=r.markers[n];-1==j(i,o.doc)&&(o.parent=null,r.markers.splice(n--,1))}},r=0;r<t.length;r++)e(r)}So.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var t=0;t<this.markers.length;++t)this.markers[t].clear();lr(this,"clear")}},So.prototype.find=function(t,e){return this.primary.find(t,e)},le(So);var No=0,Po=function(t,e,r,i,n){if(!(this instanceof Po))return new Po(t,e,r,i,n);null==r&&(r=0),mo.call(this,[new vo([new qe("",null)])]),this.first=r,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1,this.modeFrontier=this.highlightFrontier=r;var o=vt(r,0);this.sel=xn(o),this.history=new _n(null),this.id=++No,this.modeOption=e,this.lineSep=i,this.direction="rtl"==n?"rtl":"ltr",this.extend=!1,"string"==typeof t&&(t=this.splitLines(t)),An(this,{from:o,to:o,text:t}),Kn(this,xn(o),z)};Po.prototype=Z(mo.prototype,{constructor:Po,iter:function(t,e,r){r?this.iterN(t-this.first,e-t,r):this.iterN(this.first,this.first+this.size,t)},insert:function(t,e){for(var r=0,i=0;i<e.length;++i)r+=e[i].height;this.insertInner(t-this.first,e,r)},remove:function(t,e){this.removeInner(t-this.first,e)},getValue:function(t){var e=ut(this,this.first,this.first+this.size);return!1===t?e:e.join(t||this.lineSeparator())},setValue:$i(function(t){var e=vt(this.first,0),r=this.first+this.size-1;oo(this,{from:e,to:vt(r,lt(this,r).text.length),text:this.splitLines(t),origin:"setValue",full:!0},!0),this.cm&&Pi(this.cm,0,0),Kn(this,xn(e),z)}),replaceRange:function(t,e,r,i){e=St(this,e),r=r?St(this,r):e,uo(this,t,e,r,i)},getRange:function(t,e,r){var i=ct(this,St(this,t),St(this,e));return!1===r?i:i.join(r||this.lineSeparator())},getLine:function(t){var e=this.getLineHandle(t);return e&&e.text},getLineHandle:function(t){if(dt(this,t))return lt(this,t)},getLineNumber:function(t){return pt(t)},getLineHandleVisualStart:function(t){return"number"==typeof t&&(t=lt(this,t)),Vt(t)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(t){return St(this,t)},getCursor:function(t){var e=this.sel.primary();return null==t||"head"==t?e.head:"anchor"==t?e.anchor:"end"==t||"to"==t||!1===t?e.to():e.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:$i(function(t,e,r){qn(this,St(this,"number"==typeof t?vt(t,e||0):t),null,r)}),setSelection:$i(function(t,e,r){qn(this,St(this,t),St(this,e||t),r)}),extendSelection:$i(function(t,e,r){Hn(this,St(this,t),e&&St(this,e),r)}),extendSelections:$i(function(t,e){Yn(this,Et(this,t),e)}),extendSelectionsBy:$i(function(t,e){var r=$(this.sel.ranges,t);Yn(this,Et(this,r),e)}),setSelections:$i(function(t,e,r){if(t.length){for(var i=[],n=0;n<t.length;n++)i[n]=new bn(St(this,t[n].anchor),St(this,t[n].head));null==e&&(e=Math.min(t.length-1,this.sel.primIndex)),Kn(this,wn(this.cm,i,e),r)}}),addSelection:$i(function(t,e,r){var i=this.sel.ranges.slice(0);i.push(new bn(St(this,t),St(this,e||t))),Kn(this,wn(this.cm,i,i.length-1),r)}),getSelection:function(t){for(var e,r=this.sel.ranges,i=0;i<r.length;i++){var n=ct(this,r[i].from(),r[i].to());e=e?e.concat(n):n}return!1===t?e:e.join(t||this.lineSeparator())},getSelections:function(t){for(var e=[],r=this.sel.ranges,i=0;i<r.length;i++){var n=ct(this,r[i].from(),r[i].to());!1!==t&&(n=n.join(t||this.lineSeparator())),e[i]=n}return e},replaceSelection:function(t,e,r){for(var i=[],n=0;n<this.sel.ranges.length;n++)i[n]=t;this.replaceSelections(i,e,r||"+input")},replaceSelections:$i(function(t,e,r){for(var i=[],n=this.sel,o=0;o<n.ranges.length;o++){var s=n.ranges[o];i[o]={from:s.from(),to:s.to(),text:this.splitLines(t[o]),origin:r}}for(var a=e&&"end"!=e&&function(t,e,r){for(var i=[],n=vt(t.first,0),o=n,s=0;s<e.length;s++){var a=e[s],l=Cn(a.from,n,o),c=Cn(kn(a),n,o);if(n=a.to,o=c,"around"==r){var u=t.sel.ranges[s],h=mt(u.head,u.anchor)<0;i[s]=new bn(h?c:l,h?l:c)}else i[s]=new bn(l,l)}return new yn(i,t.sel.primIndex)}(this,i,e),l=i.length-1;l>=0;l--)oo(this,i[l]);a?Xn(this,a):this.cm&&Ni(this.cm)}),undo:$i(function(){ao(this,"undo")}),redo:$i(function(){ao(this,"redo")}),undoSelection:$i(function(){ao(this,"undo",!0)}),redoSelection:$i(function(){ao(this,"redo",!0)}),setExtending:function(t){this.extend=t},getExtending:function(){return this.extend},historySize:function(){for(var t=this.history,e=0,r=0,i=0;i<t.done.length;i++)t.done[i].ranges||++e;for(var n=0;n<t.undone.length;n++)t.undone[n].ranges||++r;return{undo:e,redo:r}},clearHistory:function(){this.history=new _n(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(t){return t&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(t){return this.history.generation==(t||this.cleanGeneration)},getHistory:function(){return{done:Vn(this.history.done),undone:Vn(this.history.undone)}},setHistory:function(t){var e=this.history=new _n(this.history.maxGeneration);e.done=Vn(t.done.slice(0),null,!0),e.undone=Vn(t.undone.slice(0),null,!0)},setGutterMarker:$i(function(t,e,r){return go(this,t,"gutter",function(t){var i=t.gutterMarkers||(t.gutterMarkers={});return i[e]=r,!r&&rt(i)&&(t.gutterMarkers=null),!0})}),clearGutter:$i(function(t){var e=this;this.iter(function(r){r.gutterMarkers&&r.gutterMarkers[t]&&go(e,r,"gutter",function(){return r.gutterMarkers[t]=null,rt(r.gutterMarkers)&&(r.gutterMarkers=null),!0})})}),lineInfo:function(t){var e;if("number"==typeof t){if(!dt(this,t))return null;if(e=t,!(t=lt(this,t)))return null}else if(null==(e=pt(t)))return null;return{line:e,handle:t,text:t.text,gutterMarkers:t.gutterMarkers,textClass:t.textClass,bgClass:t.bgClass,wrapClass:t.wrapClass,widgets:t.widgets}},addLineClass:$i(function(t,e,r){return go(this,t,"gutter"==e?"gutter":"class",function(t){var i="text"==e?"textClass":"background"==e?"bgClass":"gutter"==e?"gutterClass":"wrapClass";if(t[i]){if(E(r).test(t[i]))return!1;t[i]+=" "+r}else t[i]=r;return!0})}),removeLineClass:$i(function(t,e,r){return go(this,t,"gutter"==e?"gutter":"class",function(t){var i="text"==e?"textClass":"background"==e?"bgClass":"gutter"==e?"gutterClass":"wrapClass",n=t[i];if(!n)return!1;if(null==r)t[i]=null;else{var o=n.match(E(r));if(!o)return!1;var s=o.index+o[0].length;t[i]=n.slice(0,o.index)+(o.index&&s!=n.length?" ":"")+n.slice(s)||null}return!0})}),addLineWidget:$i(function(t,e,r){return function(t,e,r,i){var n=new yo(t,r,i),o=t.cm;return o&&n.noHScroll&&(o.display.alignWidgets=!0),go(t,e,"widget",function(e){var r=e.widgets||(e.widgets=[]);if(null==n.insertAt?r.push(n):r.splice(Math.min(r.length-1,Math.max(0,n.insertAt)),0,n),n.line=e,o&&!Yt(t,e)){var i=qt(e)<t.scrollTop;ht(e,e.height+xr(n)),i&&Ci(o,n.height),o.curOp.forceUpdate=!0}return!0}),o&&lr(o,"lineWidgetAdded",o,n,"number"==typeof e?e:pt(e)),n}(this,t,e,r)}),removeLineWidget:function(t){t.clear()},markText:function(t,e,r){return ko(this,St(this,t),St(this,e),r,r&&r.type||"range")},setBookmark:function(t,e){var r={replacedWith:e&&(null==e.nodeType?e.widget:e),insertLeft:e&&e.insertLeft,clearWhenEmpty:!1,shared:e&&e.shared,handleMouseEvents:e&&e.handleMouseEvents};return ko(this,t=St(this,t),t,r,"bookmark")},findMarksAt:function(t){t=St(this,t);var e=[],r=lt(this,t.line).markedSpans;if(r)for(var i=0;i<r.length;++i){var n=r[i];(null==n.from||n.from<=t.ch)&&(null==n.to||n.to>=t.ch)&&e.push(n.marker.parent||n.marker)}return e},findMarks:function(t,e,r){t=St(this,t),e=St(this,e);var i=[],n=t.line;return this.iter(t.line,e.line+1,function(o){var s=o.markedSpans;if(s)for(var a=0;a<s.length;a++){var l=s[a];null!=l.to&&n==t.line&&t.ch>=l.to||null==l.from&&n!=t.line||null!=l.from&&n==e.line&&l.from>=e.ch||r&&!r(l.marker)||i.push(l.marker.parent||l.marker)}++n}),i},getAllMarks:function(){var t=[];return this.iter(function(e){var r=e.markedSpans;if(r)for(var i=0;i<r.length;++i)null!=r[i].from&&t.push(r[i].marker)}),t},posFromIndex:function(t){var e,r=this.first,i=this.lineSeparator().length;return this.iter(function(n){var o=n.text.length+i;if(o>t)return e=t,!0;t-=o,++r}),St(this,vt(r,e))},indexFromPos:function(t){var e=(t=St(this,t)).ch;if(t.line<this.first||t.ch<0)return 0;var r=this.lineSeparator().length;return this.iter(this.first,t.line,function(t){e+=t.text.length+r}),e},copy:function(t){var e=new Po(ut(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return e.scrollTop=this.scrollTop,e.scrollLeft=this.scrollLeft,e.sel=this.sel,e.extend=!1,t&&(e.history.undoDepth=this.history.undoDepth,e.setHistory(this.getHistory())),e},linkedDoc:function(t){t||(t={});var e=this.first,r=this.first+this.size;null!=t.from&&t.from>e&&(e=t.from),null!=t.to&&t.to<r&&(r=t.to);var i=new Po(ut(this,e,r),t.mode||this.modeOption,e,this.lineSep,this.direction);return t.sharedHist&&(i.history=this.history),(this.linked||(this.linked=[])).push({doc:i,sharedHist:t.sharedHist}),i.linked=[{doc:this,isParent:!0,sharedHist:t.sharedHist}],function(t,e){for(var r=0;r<e.length;r++){var i=e[r],n=i.find(),o=t.clipPos(n.from),s=t.clipPos(n.to);if(mt(o,s)){var a=ko(t,o,s,i.primary,i.primary.type);i.markers.push(a),a.parent=i}}}(i,Eo(this)),i},unlinkDoc:function(t){if(t instanceof Es&&(t=t.doc),this.linked)for(var e=0;e<this.linked.length;++e){var r=this.linked[e];if(r.doc==t){this.linked.splice(e,1),t.unlinkDoc(this),Co(Eo(this));break}}if(t.history==this.history){var i=[t.id];Rn(t,function(t){return i.push(t.id)},!0),t.history=new _n(null),t.history.done=Vn(this.history.done,i),t.history.undone=Vn(this.history.undone,i)}},iterLinkedDocs:function(t){Rn(this,t)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(t){return this.lineSep?t.split(this.lineSep):xe(t)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:$i(function(t){var e;"rtl"!=t&&(t="ltr"),t!=this.direction&&(this.direction=t,this.iter(function(t){return t.order=null}),this.cm&&qi(e=this.cm,function(){Ln(e),Ji(e)}))})}),Po.prototype.eachLine=Po.prototype.iter;var To=0;function Ao(t){var e=this;if(Ro(e),!oe(e,t)&&!kr(e.display,t)){ce(t),s&&(To=+new Date);var r=ai(e,t,!0),i=t.dataTransfer.files;if(r&&!e.isReadOnly())if(i&&i.length&&window.FileReader&&window.File)for(var n=i.length,o=Array(n),a=0,l=function(t,i){if(!e.options.allowDropFileTypes||-1!=j(e.options.allowDropFileTypes,t.type)){var s=new FileReader;s.onload=Xi(e,function(){var t=s.result;if(/[\x00-\x08\x0e-\x1f]{2}/.test(t)&&(t=""),o[i]=t,++a==n){var l={from:r=St(e.doc,r),to:r,text:e.doc.splitLines(o.join(e.doc.lineSeparator())),origin:"paste"};oo(e.doc,l),Xn(e.doc,xn(r,kn(l)))}}),s.readAsText(t)}},c=0;c<n;++c)l(i[c],c);else{if(e.state.draggingText&&e.doc.sel.contains(r)>-1)return e.state.draggingText(t),void setTimeout(function(){return e.display.input.focus()},20);try{var u=t.dataTransfer.getData("Text");if(u){var h;if(e.state.draggingText&&!e.state.draggingText.copy&&(h=e.listSelections()),$n(e.doc,xn(r,r)),h)for(var p=0;p<h.length;++p)uo(e.doc,"",h[p].anchor,h[p].head,"drag");e.replaceSelection(u,"around","paste"),e.display.input.focus()}}catch(t){}}}}function Ro(t){t.display.dragCursor&&(t.display.lineSpace.removeChild(t.display.dragCursor),t.display.dragCursor=null)}function Oo(t){if(document.getElementsByClassName){for(var e=document.getElementsByClassName("CodeMirror"),r=[],i=0;i<e.length;i++){var n=e[i].CodeMirror;n&&r.push(n)}r.length&&r[0].operation(function(){for(var e=0;e<r.length;e++)t(r[e])})}}var Lo=!1;function _o(){var t;Lo||(ee(window,"resize",function(){null==t&&(t=setTimeout(function(){t=null,Oo(Mo)},100))}),ee(window,"blur",function(){return Oo(yi)}),Lo=!0)}function Mo(t){var e=t.display;e.cachedCharWidth=e.cachedTextHeight=e.cachedPaddingH=null,e.scrollbarsClipped=!1,t.setSize()}for(var Io={3:"Pause",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",145:"ScrollLock",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},Do=0;Do<10;Do++)Io[Do+48]=Io[Do+96]=String(Do);for(var Fo=65;Fo<=90;Fo++)Io[Fo]=String.fromCharCode(Fo);for(var Bo=1;Bo<=12;Bo++)Io[Bo+111]=Io[Bo+63235]="F"+Bo;var Uo={};function jo(t){var e,r,i,n,o=t.split(/-(?!$)/);t=o[o.length-1];for(var s=0;s<o.length-1;s++){var a=o[s];if(/^(cmd|meta|m)$/i.test(a))n=!0;else if(/^a(lt)?$/i.test(a))e=!0;else if(/^(c|ctrl|control)$/i.test(a))r=!0;else{if(!/^s(hift)?$/i.test(a))throw new Error("Unrecognized modifier name: "+a);i=!0}}return e&&(t="Alt-"+t),r&&(t="Ctrl-"+t),n&&(t="Cmd-"+t),i&&(t="Shift-"+t),t}function Wo(t){var e={};for(var r in t)if(t.hasOwnProperty(r)){var i=t[r];if(/^(name|fallthrough|(de|at)tach)$/.test(r))continue;if("..."==i){delete t[r];continue}for(var n=$(r.split(" "),jo),o=0;o<n.length;o++){var s=void 0,a=void 0;o==n.length-1?(a=n.join(" "),s=i):(a=n.slice(0,o+1).join(" "),s="...");var l=e[a];if(l){if(l!=s)throw new Error("Inconsistent bindings for "+a)}else e[a]=s}delete t[r]}for(var c in e)t[c]=e[c];return t}function Vo(t,e,r,i){var n=(e=Go(e)).call?e.call(t,i):e[t];if(!1===n)return"nothing";if("..."===n)return"multi";if(null!=n&&r(n))return"handled";if(e.fallthrough){if("[object Array]"!=Object.prototype.toString.call(e.fallthrough))return Vo(t,e.fallthrough,r,i);for(var o=0;o<e.fallthrough.length;o++){var s=Vo(t,e.fallthrough[o],r,i);if(s)return s}}}function zo(t){var e="string"==typeof t?t:Io[t.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function Ho(t,e,r){var i=t;return e.altKey&&"Alt"!=i&&(t="Alt-"+t),(k?e.metaKey:e.ctrlKey)&&"Ctrl"!=i&&(t="Ctrl-"+t),(k?e.ctrlKey:e.metaKey)&&"Cmd"!=i&&(t="Cmd-"+t),!r&&e.shiftKey&&"Shift"!=i&&(t="Shift-"+t),t}function Yo(t,e){if(h&&34==t.keyCode&&t.char)return!1;var r=Io[t.keyCode];return null!=r&&!t.altGraphKey&&(3==t.keyCode&&t.code&&(r=t.code),Ho(r,t,e))}function Go(t){return"string"==typeof t?Uo[t]:t}function qo(t,e){for(var r=t.doc.sel.ranges,i=[],n=0;n<r.length;n++){for(var o=e(r[n]);i.length&&mt(o.from,K(i).to)<=0;){var s=i.pop();if(mt(s.from,o.from)<0){o.from=s.from;break}}i.push(o)}qi(t,function(){for(var e=i.length-1;e>=0;e--)uo(t.doc,"",i[e].from,i[e].to,"+delete");Ni(t)})}function Xo(t,e,r){var i=ot(t.text,e+r,r);return i<0||i>t.text.length?null:i}function Ko(t,e,r){var i=Xo(t,e.ch,r);return null==i?null:new vt(e.line,i,r<0?"after":"before")}function $o(t,e,r,i,n){if(t){var o=Qt(r,e.doc.direction);if(o){var s,a=n<0?K(o):o[0],l=n<0==(1==a.level),c=l?"after":"before";if(a.level>0||"rtl"==e.doc.direction){var u=Lr(e,r);s=n<0?r.text.length-1:0;var h=_r(e,u,s).top;s=st(function(t){return _r(e,u,t).top==h},n<0==(1==a.level)?a.from:a.to-1,s),"before"==c&&(s=Xo(r,s,1))}else s=n<0?a.to:a.from;return new vt(i,s,c)}}return new vt(i,n<0?r.text.length:0,n<0?"before":"after")}Uo.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},Uo.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},Uo.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},Uo.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]},Uo.default=y?Uo.macDefault:Uo.pcDefault;var Jo={selectAll:io,singleSelection:function(t){return t.setSelection(t.getCursor("anchor"),t.getCursor("head"),z)},killLine:function(t){return qo(t,function(e){if(e.empty()){var r=lt(t.doc,e.head.line).text.length;return e.head.ch==r&&e.head.line<t.lastLine()?{from:e.head,to:vt(e.head.line+1,0)}:{from:e.head,to:vt(e.head.line,r)}}return{from:e.from(),to:e.to()}})},deleteLine:function(t){return qo(t,function(e){return{from:vt(e.from().line,0),to:St(t.doc,vt(e.to().line+1,0))}})},delLineLeft:function(t){return qo(t,function(t){return{from:vt(t.from().line,0),to:t.from()}})},delWrappedLineLeft:function(t){return qo(t,function(e){var r=t.charCoords(e.head,"div").top+5,i=t.coordsChar({left:0,top:r},"div");return{from:i,to:e.from()}})},delWrappedLineRight:function(t){return qo(t,function(e){var r=t.charCoords(e.head,"div").top+5,i=t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:r},"div");return{from:e.from(),to:i}})},undo:function(t){return t.undo()},redo:function(t){return t.redo()},undoSelection:function(t){return t.undoSelection()},redoSelection:function(t){return t.redoSelection()},goDocStart:function(t){return t.extendSelection(vt(t.firstLine(),0))},goDocEnd:function(t){return t.extendSelection(vt(t.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(e){return Zo(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(e){return Qo(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(t){return t.extendSelectionsBy(function(e){return function(t,e){var r=lt(t.doc,e),i=function(t){for(var e;e=Ut(t);)t=e.find(1,!0).line;return t}(r);return i!=r&&(e=pt(i)),$o(!0,t,r,e,-1)}(t,e.head.line)},{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy(function(e){var r=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:r},"div")},Y)},goLineLeft:function(t){return t.extendSelectionsBy(function(e){var r=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:r},"div")},Y)},goLineLeftSmart:function(t){return t.extendSelectionsBy(function(e){var r=t.cursorCoords(e.head,"div").top+5,i=t.coordsChar({left:0,top:r},"div");return i.ch<t.getLine(i.line).search(/\S/)?Qo(t,e.head):i},Y)},goLineUp:function(t){return t.moveV(-1,"line")},goLineDown:function(t){return t.moveV(1,"line")},goPageUp:function(t){return t.moveV(-1,"page")},goPageDown:function(t){return t.moveV(1,"page")},goCharLeft:function(t){return t.moveH(-1,"char")},goCharRight:function(t){return t.moveH(1,"char")},goColumnLeft:function(t){return t.moveH(-1,"column")},goColumnRight:function(t){return t.moveH(1,"column")},goWordLeft:function(t){return t.moveH(-1,"word")},goGroupRight:function(t){return t.moveH(1,"group")},goGroupLeft:function(t){return t.moveH(-1,"group")},goWordRight:function(t){return t.moveH(1,"word")},delCharBefore:function(t){return t.deleteH(-1,"char")},delCharAfter:function(t){return t.deleteH(1,"char")},delWordBefore:function(t){return t.deleteH(-1,"word")},delWordAfter:function(t){return t.deleteH(1,"word")},delGroupBefore:function(t){return t.deleteH(-1,"group")},delGroupAfter:function(t){return t.deleteH(1,"group")},indentAuto:function(t){return t.indentSelection("smart")},indentMore:function(t){return t.indentSelection("add")},indentLess:function(t){return t.indentSelection("subtract")},insertTab:function(t){return t.replaceSelection("\t")},insertSoftTab:function(t){for(var e=[],r=t.listSelections(),i=t.options.tabSize,n=0;n<r.length;n++){var o=r[n].from(),s=B(t.getLine(o.line),o.ch,i);e.push(X(i-s%i))}t.replaceSelections(e)},defaultTab:function(t){t.somethingSelected()?t.indentSelection("add"):t.execCommand("insertTab")},transposeChars:function(t){return qi(t,function(){for(var e=t.listSelections(),r=[],i=0;i<e.length;i++)if(e[i].empty()){var n=e[i].head,o=lt(t.doc,n.line).text;if(o)if(n.ch==o.length&&(n=new vt(n.line,n.ch-1)),n.ch>0)n=new vt(n.line,n.ch+1),t.replaceRange(o.charAt(n.ch-1)+o.charAt(n.ch-2),vt(n.line,n.ch-2),n,"+transpose");else if(n.line>t.doc.first){var s=lt(t.doc,n.line-1).text;s&&(n=new vt(n.line,1),t.replaceRange(o.charAt(0)+t.doc.lineSeparator()+s.charAt(s.length-1),vt(n.line-1,s.length-1),n,"+transpose"))}r.push(new bn(n,n))}t.setSelections(r)})},newlineAndIndent:function(t){return qi(t,function(){for(var e=t.listSelections(),r=e.length-1;r>=0;r--)t.replaceRange(t.doc.lineSeparator(),e[r].anchor,e[r].head,"+input");e=t.listSelections();for(var i=0;i<e.length;i++)t.indentLine(e[i].from().line,null,!0);Ni(t)})},openLine:function(t){return t.replaceSelection("\n","start")},toggleOverwrite:function(t){return t.toggleOverwrite()}};function Zo(t,e){var r=lt(t.doc,e),i=Vt(r);return i!=r&&(e=pt(i)),$o(!0,t,i,e,1)}function Qo(t,e){var r=Zo(t,e.line),i=lt(t.doc,r.line),n=Qt(i,t.doc.direction);if(!n||0==n[0].level){var o=Math.max(0,i.text.search(/\S/)),s=e.line==r.line&&e.ch<=o&&e.ch;return vt(r.line,s?0:o,r.sticky)}return r}function ts(t,e,r){if("string"==typeof e&&!(e=Jo[e]))return!1;t.display.input.ensurePolled();var i=t.display.shift,n=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),r&&(t.display.shift=!1),n=e(t)!=V}finally{t.display.shift=i,t.state.suppressEdits=!1}return n}var es=new U;function rs(t,e,r,i){var n=t.state.keySeq;if(n){if(zo(e))return"handled";if(/\'$/.test(e)?t.state.keySeq=null:es.set(50,function(){t.state.keySeq==n&&(t.state.keySeq=null,t.display.input.reset())}),is(t,n+" "+e,r,i))return!0}return is(t,e,r,i)}function is(t,e,r,i){var n=function(t,e,r){for(var i=0;i<t.state.keyMaps.length;i++){var n=Vo(e,t.state.keyMaps[i],r,t);if(n)return n}return t.options.extraKeys&&Vo(e,t.options.extraKeys,r,t)||Vo(e,t.options.keyMap,r,t)}(t,e,i);return"multi"==n&&(t.state.keySeq=e),"handled"==n&&lr(t,"keyHandled",t,e,r),"handled"!=n&&"multi"!=n||(ce(r),di(t)),!!n}function ns(t,e){var r=Yo(e,!0);return!!r&&(e.shiftKey&&!t.state.keySeq?rs(t,"Shift-"+r,e,function(e){return ts(t,e,!0)})||rs(t,r,e,function(e){if("string"==typeof e?/^go[A-Z]/.test(e):e.motion)return ts(t,e)}):rs(t,r,e,function(e){return ts(t,e)}))}var os=null;function ss(t){var e=this;if(e.curOp.focus=L(),!oe(e,t)){s&&a<11&&27==t.keyCode&&(t.returnValue=!1);var r=t.keyCode;e.display.shift=16==r||t.shiftKey;var i=ns(e,t);h&&(os=i?r:null,!i&&88==r&&!Se&&(y?t.metaKey:t.ctrlKey)&&e.replaceSelection("",null,"cut")),18!=r||/\bCodeMirror-crosshair\b/.test(e.display.lineDiv.className)||function(t){var e=t.display.lineDiv;function r(t){18!=t.keyCode&&t.altKey||(N(e,"CodeMirror-crosshair"),ie(document,"keyup",r),ie(document,"mouseover",r))}_(e,"CodeMirror-crosshair"),ee(document,"keyup",r),ee(document,"mouseover",r)}(e)}}function as(t){16==t.keyCode&&(this.doc.sel.shift=!1),oe(this,t)}function ls(t){var e=this;if(!(kr(e.display,t)||oe(e,t)||t.ctrlKey&&!t.altKey||y&&t.metaKey)){var r=t.keyCode,i=t.charCode;if(h&&r==os)return os=null,void ce(t);if(!h||t.which&&!(t.which<10)||!ns(e,t)){var n=String.fromCharCode(null==i?r:i);"\b"!=n&&(function(t,e,r){return rs(t,"'"+r+"'",e,function(e){return ts(t,e,!0)})}(e,t,n)||e.display.input.onKeyPress(t))}}}var cs,us,hs=function(t,e,r){this.time=t,this.pos=e,this.button=r};function ps(t){var e=this,r=e.display;if(!(oe(e,t)||r.activeTouch&&r.input.supportsTouch()))if(r.input.ensurePolled(),r.shift=t.shiftKey,kr(r,t))l||(r.scroller.draggable=!1,setTimeout(function(){return r.scroller.draggable=!0},100));else if(!gs(e,t)){var i=ai(e,t),n=de(t),o=i?function(t,e){var r=+new Date;return us&&us.compare(r,t,e)?(cs=us=null,"triple"):cs&&cs.compare(r,t,e)?(us=new hs(r,t,e),cs=null,"double"):(cs=new hs(r,t,e),us=null,"single")}(i,n):"single";window.focus(),1==n&&e.state.selectingText&&e.state.selectingText(t),i&&function(t,e,r,i,n){var o="Click";return"double"==i?o="Double"+o:"triple"==i&&(o="Triple"+o),rs(t,Ho(o=(1==e?"Left":2==e?"Middle":"Right")+o,n),n,function(e){if("string"==typeof e&&(e=Jo[e]),!e)return!1;var i=!1;try{t.isReadOnly()&&(t.state.suppressEdits=!0),i=e(t,r)!=V}finally{t.state.suppressEdits=!1}return i})}(e,n,i,o,t)||(1==n?i?function(t,e,r,i){s?setTimeout(D(gi,t),0):t.curOp.focus=L();var n,o=function(t,e,r){var i=t.getOption("configureMouse"),n=i?i(t,e,r):{};if(null==n.unit){var o=b?r.shiftKey&&r.metaKey:r.altKey;n.unit=o?"rectangle":"single"==e?"char":"double"==e?"word":"line"}return(null==n.extend||t.doc.extend)&&(n.extend=t.doc.extend||r.shiftKey),null==n.addNew&&(n.addNew=y?r.metaKey:r.ctrlKey),null==n.moveOnDrag&&(n.moveOnDrag=!(y?r.altKey:r.ctrlKey)),n}(t,r,i),c=t.doc.sel;t.options.dragDrop&&me&&!t.isReadOnly()&&"single"==r&&(n=c.contains(e))>-1&&(mt((n=c.ranges[n]).from(),e)<0||e.xRel>0)&&(mt(n.to(),e)>0||e.xRel<0)?function(t,e,r,i){var n=t.display,o=!1,c=Xi(t,function(e){l&&(n.scroller.draggable=!1),t.state.draggingText=!1,ie(n.wrapper.ownerDocument,"mouseup",c),ie(n.wrapper.ownerDocument,"mousemove",u),ie(n.scroller,"dragstart",h),ie(n.scroller,"drop",c),o||(ce(e),i.addNew||Hn(t.doc,r,null,null,i.extend),l||s&&9==a?setTimeout(function(){n.wrapper.ownerDocument.body.focus(),n.input.focus()},20):n.input.focus())}),u=function(t){o=o||Math.abs(e.clientX-t.clientX)+Math.abs(e.clientY-t.clientY)>=10},h=function(){return o=!0};l&&(n.scroller.draggable=!0),t.state.draggingText=c,c.copy=!i.moveOnDrag,n.scroller.dragDrop&&n.scroller.dragDrop(),ee(n.wrapper.ownerDocument,"mouseup",c),ee(n.wrapper.ownerDocument,"mousemove",u),ee(n.scroller,"dragstart",h),ee(n.scroller,"drop",c),vi(t),setTimeout(function(){return n.input.focus()},20)}(t,i,e,o):function(t,e,r,i){var n=t.display,o=t.doc;ce(e);var s,a,l=o.sel,c=l.ranges;if(i.addNew&&!i.extend?(a=o.sel.contains(r),s=a>-1?c[a]:new bn(r,r)):(s=o.sel.primary(),a=o.sel.primIndex),"rectangle"==i.unit)i.addNew||(s=new bn(r,r)),r=ai(t,e,!0,!0),a=-1;else{var u=fs(t,r,i.unit);s=i.extend?zn(s,u.anchor,u.head,i.extend):u}i.addNew?-1==a?(a=c.length,Kn(o,wn(t,c.concat([s]),a),{scroll:!1,origin:"*mouse"})):c.length>1&&c[a].empty()&&"char"==i.unit&&!i.extend?(Kn(o,wn(t,c.slice(0,a).concat(c.slice(a+1)),0),{scroll:!1,origin:"*mouse"}),l=o.sel):Gn(o,a,s,H):(a=0,Kn(o,new yn([s],0),H),l=o.sel);var h=r;function p(e){if(0!=mt(h,e))if(h=e,"rectangle"==i.unit){for(var n=[],c=t.options.tabSize,u=B(lt(o,r.line).text,r.ch,c),p=B(lt(o,e.line).text,e.ch,c),f=Math.min(u,p),d=Math.max(u,p),g=Math.min(r.line,e.line),v=Math.min(t.lastLine(),Math.max(r.line,e.line));g<=v;g++){var m=lt(o,g).text,y=G(m,f,c);f==d?n.push(new bn(vt(g,y),vt(g,y))):m.length>y&&n.push(new bn(vt(g,y),vt(g,G(m,d,c))))}n.length||n.push(new bn(r,r)),Kn(o,wn(t,l.ranges.slice(0,a).concat(n),a),{origin:"*mouse",scroll:!1}),t.scrollIntoView(e)}else{var b,w=s,x=fs(t,e,i.unit),k=w.anchor;mt(x.anchor,k)>0?(b=x.head,k=xt(w.from(),x.anchor)):(b=x.anchor,k=wt(w.to(),x.head));var S=l.ranges.slice(0);S[a]=function(t,e){var r=e.anchor,i=e.head,n=lt(t.doc,r.line);if(0==mt(r,i)&&r.sticky==i.sticky)return e;var o=Qt(n);if(!o)return e;var s=Jt(o,r.ch,r.sticky),a=o[s];if(a.from!=r.ch&&a.to!=r.ch)return e;var l,c=s+(a.from==r.ch==(1!=a.level)?0:1);if(0==c||c==o.length)return e;if(i.line!=r.line)l=(i.line-r.line)*("ltr"==t.doc.direction?1:-1)>0;else{var u=Jt(o,i.ch,i.sticky),h=u-s||(i.ch-r.ch)*(1==a.level?-1:1);l=u==c-1||u==c?h<0:h>0}var p=o[c+(l?-1:0)],f=l==(1==p.level),d=f?p.from:p.to,g=f?"after":"before";return r.ch==d&&r.sticky==g?e:new bn(new vt(r.line,d,g),i)}(t,new bn(St(o,k),b)),Kn(o,wn(t,S,a),H)}}var f=n.wrapper.getBoundingClientRect(),d=0;function g(e){t.state.selectingText=!1,d=1/0,ce(e),n.input.focus(),ie(n.wrapper.ownerDocument,"mousemove",v),ie(n.wrapper.ownerDocument,"mouseup",m),o.history.lastSelOrigin=null}var v=Xi(t,function(e){0!==e.buttons&&de(e)?function e(r){var s=++d,a=ai(t,r,!0,"rectangle"==i.unit);if(a)if(0!=mt(a,h)){t.curOp.focus=L(),p(a);var l=xi(n,o);(a.line>=l.to||a.line<l.from)&&setTimeout(Xi(t,function(){d==s&&e(r)}),150)}else{var c=r.clientY<f.top?-20:r.clientY>f.bottom?20:0;c&&setTimeout(Xi(t,function(){d==s&&(n.scroller.scrollTop+=c,e(r))}),50)}}(e):g(e)}),m=Xi(t,g);t.state.selectingText=m,ee(n.wrapper.ownerDocument,"mousemove",v),ee(n.wrapper.ownerDocument,"mouseup",m)}(t,i,e,o)}(e,i,o,t):fe(t)==r.scroller&&ce(t):2==n?(i&&Hn(e.doc,i),setTimeout(function(){return r.input.focus()},20)):3==n&&(S?e.display.input.onContextMenu(t):vi(e)))}}function fs(t,e,r){if("char"==r)return new bn(e,e);if("word"==r)return t.findWordAt(e);if("line"==r)return new bn(vt(e.line,0),St(t.doc,vt(e.line+1,0)));var i=r(t,e);return new bn(i.from,i.to)}function ds(t,e,r,i){var n,o;if(e.touches)n=e.touches[0].clientX,o=e.touches[0].clientY;else try{n=e.clientX,o=e.clientY}catch(e){return!1}if(n>=Math.floor(t.display.gutters.getBoundingClientRect().right))return!1;i&&ce(e);var s=t.display,a=s.lineDiv.getBoundingClientRect();if(o>a.bottom||!ae(t,r))return he(e);o-=a.top-s.viewOffset;for(var l=0;l<t.options.gutters.length;++l){var c=s.gutters.childNodes[l];if(c&&c.getBoundingClientRect().right>=n){var u=ft(t.doc,o),h=t.options.gutters[l];return ne(t,r,t,u,h,e),he(e)}}}function gs(t,e){return ds(t,e,"gutterClick",!0)}function vs(t,e){kr(t.display,e)||function(t,e){return!!ae(t,"gutterContextMenu")&&ds(t,e,"gutterContextMenu",!1)}(t,e)||oe(t,e,"contextmenu")||S||t.display.input.onContextMenu(e)}function ms(t){t.display.wrapper.className=t.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+t.options.theme.replace(/(^|\s)\s*/g," cm-s-"),jr(t)}hs.prototype.compare=function(t,e,r){return this.time+400>t&&0==mt(e,this.pos)&&r==this.button};var ys={toString:function(){return"CodeMirror.Init"}},bs={},ws={};function xs(t){hn(t),Ji(t),ki(t)}function ks(t,e,r){var i=r&&r!=ys;if(!e!=!i){var n=t.display.dragFunctions,o=e?ee:ie;o(t.display.scroller,"dragstart",n.start),o(t.display.scroller,"dragenter",n.enter),o(t.display.scroller,"dragover",n.over),o(t.display.scroller,"dragleave",n.leave),o(t.display.scroller,"drop",n.drop)}}function Ss(t){t.options.lineWrapping?(_(t.display.wrapper,"CodeMirror-wrap"),t.display.sizer.style.minWidth="",t.display.sizerWidth=null):(N(t.display.wrapper,"CodeMirror-wrap"),Kt(t)),si(t),Ji(t),jr(t),setTimeout(function(){return Di(t)},100)}function Es(t,e){var r=this;if(!(this instanceof Es))return new Es(t,e);this.options=e=e?F(e):{},F(bs,e,!1),pn(e);var i=e.value;"string"==typeof i?i=new Po(i,e.mode,null,e.lineSeparator,e.direction):e.mode&&(i.modeOption=e.mode),this.doc=i;var n=new Es.inputStyles[e.inputStyle](this),o=this.display=new at(t,i,n);for(var c in o.wrapper.CodeMirror=this,hn(this),ms(this),e.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Ui(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:-1,cutIncoming:-1,selectingText:!1,draggingText:!1,highlight:new U,keySeq:null,specialChars:null},e.autofocus&&!m&&o.input.focus(),s&&a<11&&setTimeout(function(){return r.display.input.reset(!0)},20),function(t){var e=t.display;ee(e.scroller,"mousedown",Xi(t,ps)),ee(e.scroller,"dblclick",s&&a<11?Xi(t,function(e){if(!oe(t,e)){var r=ai(t,e);if(r&&!gs(t,e)&&!kr(t.display,e)){ce(e);var i=t.findWordAt(r);Hn(t.doc,i.anchor,i.head)}}}):function(e){return oe(t,e)||ce(e)}),ee(e.scroller,"contextmenu",function(e){return vs(t,e)});var r,i={end:0};function n(){e.activeTouch&&(r=setTimeout(function(){return e.activeTouch=null},1e3),(i=e.activeTouch).end=+new Date)}function o(t,e){if(null==e.left)return!0;var r=e.left-t.left,i=e.top-t.top;return r*r+i*i>400}ee(e.scroller,"touchstart",function(n){if(!oe(t,n)&&!function(t){if(1!=t.touches.length)return!1;var e=t.touches[0];return e.radiusX<=1&&e.radiusY<=1}(n)&&!gs(t,n)){e.input.ensurePolled(),clearTimeout(r);var o=+new Date;e.activeTouch={start:o,moved:!1,prev:o-i.end<=300?i:null},1==n.touches.length&&(e.activeTouch.left=n.touches[0].pageX,e.activeTouch.top=n.touches[0].pageY)}}),ee(e.scroller,"touchmove",function(){e.activeTouch&&(e.activeTouch.moved=!0)}),ee(e.scroller,"touchend",function(r){var i=e.activeTouch;if(i&&!kr(e,r)&&null!=i.left&&!i.moved&&new Date-i.start<300){var s,a=t.coordsChar(e.activeTouch,"page");s=!i.prev||o(i,i.prev)?new bn(a,a):!i.prev.prev||o(i,i.prev.prev)?t.findWordAt(a):new bn(vt(a.line,0),St(t.doc,vt(a.line+1,0))),t.setSelection(s.anchor,s.head),t.focus(),ce(r)}n()}),ee(e.scroller,"touchcancel",n),ee(e.scroller,"scroll",function(){e.scroller.clientHeight&&(Ri(t,e.scroller.scrollTop),Li(t,e.scroller.scrollLeft,!0),ne(t,"scroll",t))}),ee(e.scroller,"mousewheel",function(e){return mn(t,e)}),ee(e.scroller,"DOMMouseScroll",function(e){return mn(t,e)}),ee(e.wrapper,"scroll",function(){return e.wrapper.scrollTop=e.wrapper.scrollLeft=0}),e.dragFunctions={enter:function(e){oe(t,e)||pe(e)},over:function(e){oe(t,e)||(function(t,e){var r=ai(t,e);if(r){var i=document.createDocumentFragment();hi(t,r,i),t.display.dragCursor||(t.display.dragCursor=A("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),T(t.display.dragCursor,i)}}(t,e),pe(e))},start:function(e){return function(t,e){if(s&&(!t.state.draggingText||+new Date-To<100))pe(e);else if(!oe(t,e)&&!kr(t.display,e)&&(e.dataTransfer.setData("Text",t.getSelection()),e.dataTransfer.effectAllowed="copyMove",e.dataTransfer.setDragImage&&!p)){var r=A("img",null,null,"position: fixed; left: 0; top: 0;");r.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",h&&(r.width=r.height=1,t.display.wrapper.appendChild(r),r._top=r.offsetTop),e.dataTransfer.setDragImage(r,0,0),h&&r.parentNode.removeChild(r)}}(t,e)},drop:Xi(t,Ao),leave:function(e){oe(t,e)||Ro(t)}};var l=e.input.getField();ee(l,"keyup",function(e){return as.call(t,e)}),ee(l,"keydown",Xi(t,ss)),ee(l,"keypress",Xi(t,ls)),ee(l,"focus",function(e){return mi(t,e)}),ee(l,"blur",function(e){return yi(t,e)})}(this),_o(),Wi(this),this.curOp.forceUpdate=!0,On(this,i),e.autofocus&&!m||this.hasFocus()?setTimeout(D(mi,this),20):yi(this),ws)ws.hasOwnProperty(c)&&ws[c](r,e[c],ys);Si(this),e.finishInit&&e.finishInit(this);for(var u=0;u<Cs.length;++u)Cs[u](r);Vi(this),l&&e.lineWrapping&&"optimizelegibility"==getComputedStyle(o.lineDiv).textRendering&&(o.lineDiv.style.textRendering="auto")}Es.defaults=bs,Es.optionHandlers=ws;var Cs=[];function Ns(t,e,r,i){var n,o=t.doc;null==r&&(r="add"),"smart"==r&&(o.mode.indent?n=Ue(t,e).state:r="prev");var s=t.options.tabSize,a=lt(o,e),l=B(a.text,null,s);a.stateAfter&&(a.stateAfter=null);var c,u=a.text.match(/^\s*/)[0];if(i||/\S/.test(a.text)){if("smart"==r&&((c=o.mode.indent(n,a.text.slice(u.length),a.text))==V||c>150)){if(!i)return;r="prev"}}else c=0,r="not";"prev"==r?c=e>o.first?B(lt(o,e-1).text,null,s):0:"add"==r?c=l+t.options.indentUnit:"subtract"==r?c=l-t.options.indentUnit:"number"==typeof r&&(c=l+r),c=Math.max(0,c);var h="",p=0;if(t.options.indentWithTabs)for(var f=Math.floor(c/s);f;--f)p+=s,h+="\t";if(p<c&&(h+=X(c-p)),h!=u)return uo(o,h,vt(e,0),vt(e,u.length),"+input"),a.stateAfter=null,!0;for(var d=0;d<o.sel.ranges.length;d++){var g=o.sel.ranges[d];if(g.head.line==e&&g.head.ch<u.length){var v=vt(e,u.length);Gn(o,d,new bn(v,v));break}}}Es.defineInitHook=function(t){return Cs.push(t)};var Ps=null;function Ts(t){Ps=t}function As(t,e,r,i,n){var o=t.doc;t.display.shift=!1,i||(i=o.sel);var s=+new Date-200,a="paste"==n||t.state.pasteIncoming>s,l=xe(e),c=null;if(a&&i.ranges.length>1)if(Ps&&Ps.text.join("\n")==e){if(i.ranges.length%Ps.text.length==0){c=[];for(var u=0;u<Ps.text.length;u++)c.push(o.splitLines(Ps.text[u]))}}else l.length==i.ranges.length&&t.options.pasteLinesPerSelection&&(c=$(l,function(t){return[t]}));for(var h=t.curOp.updateInput,p=i.ranges.length-1;p>=0;p--){var f=i.ranges[p],d=f.from(),g=f.to();f.empty()&&(r&&r>0?d=vt(d.line,d.ch-r):t.state.overwrite&&!a?g=vt(g.line,Math.min(lt(o,g.line).text.length,g.ch+K(l).length)):a&&Ps&&Ps.lineWise&&Ps.text.join("\n")==e&&(d=g=vt(d.line,0)));var v={from:d,to:g,text:c?c[p%c.length]:l,origin:n||(a?"paste":t.state.cutIncoming>s?"cut":"+input")};oo(t.doc,v),lr(t,"inputRead",t,v)}e&&!a&&Os(t,e),Ni(t),t.curOp.updateInput<2&&(t.curOp.updateInput=h),t.curOp.typing=!0,t.state.pasteIncoming=t.state.cutIncoming=-1}function Rs(t,e){var r=t.clipboardData&&t.clipboardData.getData("Text");if(r)return t.preventDefault(),e.isReadOnly()||e.options.disableInput||qi(e,function(){return As(e,r,0,null,"paste")}),!0}function Os(t,e){if(t.options.electricChars&&t.options.smartIndent)for(var r=t.doc.sel,i=r.ranges.length-1;i>=0;i--){var n=r.ranges[i];if(!(n.head.ch>100||i&&r.ranges[i-1].head.line==n.head.line)){var o=t.getModeAt(n.head),s=!1;if(o.electricChars){for(var a=0;a<o.electricChars.length;a++)if(e.indexOf(o.electricChars.charAt(a))>-1){s=Ns(t,n.head.line,"smart");break}}else o.electricInput&&o.electricInput.test(lt(t.doc,n.head.line).text.slice(0,n.head.ch))&&(s=Ns(t,n.head.line,"smart"));s&&lr(t,"electricInput",t,n.head.line)}}}function Ls(t){for(var e=[],r=[],i=0;i<t.doc.sel.ranges.length;i++){var n=t.doc.sel.ranges[i].head.line,o={anchor:vt(n,0),head:vt(n+1,0)};r.push(o),e.push(t.getRange(o.anchor,o.head))}return{text:e,ranges:r}}function _s(t,e,r,i){t.setAttribute("autocorrect",!!r),t.setAttribute("autocapitalize",!!i),t.setAttribute("spellcheck",!!e)}function Ms(){var t=A("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),e=A("div",[t],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return l?t.style.width="1000px":t.setAttribute("wrap","off"),g&&(t.style.border="1px solid black"),_s(t),e}function Is(t,e,r,i,n){var o=e,s=r,a=lt(t,e.line);function l(i){var o,s;if(null==(o=n?function(t,e,r,i){var n=Qt(e,t.doc.direction);if(!n)return Ko(e,r,i);r.ch>=e.text.length?(r.ch=e.text.length,r.sticky="before"):r.ch<=0&&(r.ch=0,r.sticky="after");var o=Jt(n,r.ch,r.sticky),s=n[o];if("ltr"==t.doc.direction&&s.level%2==0&&(i>0?s.to>r.ch:s.from<r.ch))return Ko(e,r,i);var a,l=function(t,r){return Xo(e,t instanceof vt?t.ch:t,r)},c=function(r){return t.options.lineWrapping?(a=a||Lr(t,e),Zr(t,e,a,r)):{begin:0,end:e.text.length}},u=c("before"==r.sticky?l(r,-1):r.ch);if("rtl"==t.doc.direction||1==s.level){var h=1==s.level==i<0,p=l(r,h?1:-1);if(null!=p&&(h?p<=s.to&&p<=u.end:p>=s.from&&p>=u.begin)){var f=h?"before":"after";return new vt(r.line,p,f)}}var d=function(t,e,i){for(var o=function(t,e){return e?new vt(r.line,l(t,1),"before"):new vt(r.line,t,"after")};t>=0&&t<n.length;t+=e){var s=n[t],a=e>0==(1!=s.level),c=a?i.begin:l(i.end,-1);if(s.from<=c&&c<s.to)return o(c,a);if(c=a?s.from:l(s.to,-1),i.begin<=c&&c<i.end)return o(c,a)}},g=d(o+i,i,u);if(g)return g;var v=i>0?u.end:l(u.begin,-1);return null==v||i>0&&v==e.text.length||!(g=d(i>0?0:n.length-1,i,c(v)))?null:g}(t.cm,a,e,r):Ko(a,e,r))){if(i||((s=e.line+r)<t.first||s>=t.first+t.size||(e=new vt(s,e.ch,e.sticky),!(a=lt(t,s)))))return!1;e=$o(n,t.cm,a,e.line,r)}else e=o;return!0}if("char"==i)l();else if("column"==i)l(!0);else if("word"==i||"group"==i)for(var c=null,u="group"==i,h=t.cm&&t.cm.getHelper(e,"wordChars"),p=!0;!(r<0)||l(!p);p=!1){var f=a.text.charAt(e.ch)||"\n",d=et(f,h)?"w":u&&"\n"==f?"n":!u||/\s/.test(f)?null:"p";if(!u||p||d||(d="s"),c&&c!=d){r<0&&(r=1,l(),e.sticky="after");break}if(d&&(c=d),r>0&&!l(!p))break}var g=eo(t,e,o,s,!0);return yt(o,g)&&(g.hitSide=!0),g}function Ds(t,e,r,i){var n,o,s=t.doc,a=e.left;if("page"==i){var l=Math.min(t.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),c=Math.max(l-.5*ei(t.display),3);n=(r>0?e.bottom:e.top)+r*c}else"line"==i&&(n=r>0?e.bottom+3:e.top-3);for(;(o=$r(t,a,n)).outside;){if(r<0?n<=0:n>=s.height){o.hitSide=!0;break}n+=5*r}return o}var Fs=function(t){this.cm=t,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new U,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null};function Bs(t,e){var r=Or(t,e.line);if(!r||r.hidden)return null;var i=lt(t.doc,e.line),n=Ar(r,i,e.line),o=Qt(i,t.doc.direction),s="left";if(o){var a=Jt(o,e.ch);s=a%2?"right":"left"}var l=Dr(n.map,e.ch,s);return l.offset="right"==l.collapse?l.end:l.start,l}function Us(t,e){return e&&(t.bad=!0),t}function js(t,e,r){var i;if(e==t.display.lineDiv){if(!(i=t.display.lineDiv.childNodes[r]))return Us(t.clipPos(vt(t.display.viewTo-1)),!0);e=null,r=0}else for(i=e;;i=i.parentNode){if(!i||i==t.display.lineDiv)return null;if(i.parentNode&&i.parentNode==t.display.lineDiv)break}for(var n=0;n<t.display.view.length;n++){var o=t.display.view[n];if(o.node==i)return Ws(o,e,r)}}function Ws(t,e,r){var i=t.text.firstChild,n=!1;if(!e||!O(i,e))return Us(vt(pt(t.line),0),!0);if(e==i&&(n=!0,e=i.childNodes[r],r=0,!e)){var o=t.rest?K(t.rest):t.line;return Us(vt(pt(o),o.text.length),n)}var s=3==e.nodeType?e:null,a=e;for(s||1!=e.childNodes.length||3!=e.firstChild.nodeType||(s=e.firstChild,r&&(r=s.nodeValue.length));a.parentNode!=i;)a=a.parentNode;var l=t.measure,c=l.maps;function u(e,r,i){for(var n=-1;n<(c?c.length:0);n++)for(var o=n<0?l.map:c[n],s=0;s<o.length;s+=3){var a=o[s+2];if(a==e||a==r){var u=pt(n<0?t.line:t.rest[n]),h=o[s]+i;return(i<0||a!=e)&&(h=o[s+(i?1:0)]),vt(u,h)}}}var h=u(s,a,r);if(h)return Us(h,n);for(var p=a.nextSibling,f=s?s.nodeValue.length-r:0;p;p=p.nextSibling){if(h=u(p,p.firstChild,0))return Us(vt(h.line,h.ch-f),n);f+=p.textContent.length}for(var d=a.previousSibling,g=r;d;d=d.previousSibling){if(h=u(d,d.firstChild,-1))return Us(vt(h.line,h.ch+g),n);g+=d.textContent.length}}Fs.prototype.init=function(t){var e=this,r=this,i=r.cm,n=r.div=t.lineDiv;function o(t){if(!oe(i,t)){if(i.somethingSelected())Ts({lineWise:!1,text:i.getSelections()}),"cut"==t.type&&i.replaceSelection("",null,"cut");else{if(!i.options.lineWiseCopyCut)return;var e=Ls(i);Ts({lineWise:!0,text:e.text}),"cut"==t.type&&i.operation(function(){i.setSelections(e.ranges,0,z),i.replaceSelection("",null,"cut")})}if(t.clipboardData){t.clipboardData.clearData();var o=Ps.text.join("\n");if(t.clipboardData.setData("Text",o),t.clipboardData.getData("Text")==o)return void t.preventDefault()}var s=Ms(),a=s.firstChild;i.display.lineSpace.insertBefore(s,i.display.lineSpace.firstChild),a.value=Ps.text.join("\n");var l=document.activeElement;I(a),setTimeout(function(){i.display.lineSpace.removeChild(s),l.focus(),l==n&&r.showPrimarySelection()},50)}}_s(n,i.options.spellcheck,i.options.autocorrect,i.options.autocapitalize),ee(n,"paste",function(t){oe(i,t)||Rs(t,i)||a<=11&&setTimeout(Xi(i,function(){return e.updateFromDOM()}),20)}),ee(n,"compositionstart",function(t){e.composing={data:t.data,done:!1}}),ee(n,"compositionupdate",function(t){e.composing||(e.composing={data:t.data,done:!1})}),ee(n,"compositionend",function(t){e.composing&&(t.data!=e.composing.data&&e.readFromDOMSoon(),e.composing.done=!0)}),ee(n,"touchstart",function(){return r.forceCompositionEnd()}),ee(n,"input",function(){e.composing||e.readFromDOMSoon()}),ee(n,"copy",o),ee(n,"cut",o)},Fs.prototype.prepareSelection=function(){var t=ui(this.cm,!1);return t.focus=this.cm.state.focused,t},Fs.prototype.showSelection=function(t,e){t&&this.cm.display.view.length&&((t.focus||e)&&this.showPrimarySelection(),this.showMultipleSelections(t))},Fs.prototype.getSelection=function(){return this.cm.display.wrapper.ownerDocument.getSelection()},Fs.prototype.showPrimarySelection=function(){var t=this.getSelection(),e=this.cm,i=e.doc.sel.primary(),n=i.from(),o=i.to();if(e.display.viewTo==e.display.viewFrom||n.line>=e.display.viewTo||o.line<e.display.viewFrom)t.removeAllRanges();else{var s=js(e,t.anchorNode,t.anchorOffset),a=js(e,t.focusNode,t.focusOffset);if(!s||s.bad||!a||a.bad||0!=mt(xt(s,a),n)||0!=mt(wt(s,a),o)){var l=e.display.view,c=n.line>=e.display.viewFrom&&Bs(e,n)||{node:l[0].measure.map[2],offset:0},u=o.line<e.display.viewTo&&Bs(e,o);if(!u){var h=l[l.length-1].measure,p=h.maps?h.maps[h.maps.length-1]:h.map;u={node:p[p.length-1],offset:p[p.length-2]-p[p.length-3]}}if(c&&u){var f,d=t.rangeCount&&t.getRangeAt(0);try{f=C(c.node,c.offset,u.offset,u.node)}catch(t){}f&&(!r&&e.state.focused?(t.collapse(c.node,c.offset),f.collapsed||(t.removeAllRanges(),t.addRange(f))):(t.removeAllRanges(),t.addRange(f)),d&&null==t.anchorNode?t.addRange(d):r&&this.startGracePeriod()),this.rememberSelection()}else t.removeAllRanges()}}},Fs.prototype.startGracePeriod=function(){var t=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){t.gracePeriod=!1,t.selectionChanged()&&t.cm.operation(function(){return t.cm.curOp.selectionChanged=!0})},20)},Fs.prototype.showMultipleSelections=function(t){T(this.cm.display.cursorDiv,t.cursors),T(this.cm.display.selectionDiv,t.selection)},Fs.prototype.rememberSelection=function(){var t=this.getSelection();this.lastAnchorNode=t.anchorNode,this.lastAnchorOffset=t.anchorOffset,this.lastFocusNode=t.focusNode,this.lastFocusOffset=t.focusOffset},Fs.prototype.selectionInEditor=function(){var t=this.getSelection();if(!t.rangeCount)return!1;var e=t.getRangeAt(0).commonAncestorContainer;return O(this.div,e)},Fs.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())},Fs.prototype.blur=function(){this.div.blur()},Fs.prototype.getField=function(){return this.div},Fs.prototype.supportsTouch=function(){return!0},Fs.prototype.receivedFocus=function(){var t=this;this.selectionInEditor()?this.pollSelection():qi(this.cm,function(){return t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))})},Fs.prototype.selectionChanged=function(){var t=this.getSelection();return t.anchorNode!=this.lastAnchorNode||t.anchorOffset!=this.lastAnchorOffset||t.focusNode!=this.lastFocusNode||t.focusOffset!=this.lastFocusOffset},Fs.prototype.pollSelection=function(){if(null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()){var t=this.getSelection(),e=this.cm;if(v&&u&&this.cm.options.gutters.length&&function(t){for(var e=t;e;e=e.parentNode)if(/CodeMirror-gutter-wrapper/.test(e.className))return!0;return!1}(t.anchorNode))return this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),void this.focus();if(!this.composing){this.rememberSelection();var r=js(e,t.anchorNode,t.anchorOffset),i=js(e,t.focusNode,t.focusOffset);r&&i&&qi(e,function(){Kn(e.doc,xn(r,i),z),(r.bad||i.bad)&&(e.curOp.selectionChanged=!0)})}}},Fs.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var t,e,r,i=this.cm,n=i.display,o=i.doc.sel.primary(),s=o.from(),a=o.to();if(0==s.ch&&s.line>i.firstLine()&&(s=vt(s.line-1,lt(i.doc,s.line-1).length)),a.ch==lt(i.doc,a.line).text.length&&a.line<i.lastLine()&&(a=vt(a.line+1,0)),s.line<n.viewFrom||a.line>n.viewTo-1)return!1;s.line==n.viewFrom||0==(t=li(i,s.line))?(e=pt(n.view[0].line),r=n.view[0].node):(e=pt(n.view[t].line),r=n.view[t-1].node.nextSibling);var l,c,u=li(i,a.line);if(u==n.view.length-1?(l=n.viewTo-1,c=n.lineDiv.lastChild):(l=pt(n.view[u+1].line)-1,c=n.view[u+1].node.previousSibling),!r)return!1;for(var h=i.doc.splitLines(function(t,e,r,i,n){var o="",s=!1,a=t.doc.lineSeparator(),l=!1;function c(){s&&(o+=a,l&&(o+=a),s=l=!1)}function u(t){t&&(c(),o+=t)}function h(e){if(1==e.nodeType){var r=e.getAttribute("cm-text");if(r)return void u(r);var o,p=e.getAttribute("cm-marker");if(p){var f=t.findMarks(vt(i,0),vt(n+1,0),(v=+p,function(t){return t.id==v}));return void(f.length&&(o=f[0].find(0))&&u(ct(t.doc,o.from,o.to).join(a)))}if("false"==e.getAttribute("contenteditable"))return;var d=/^(pre|div|p|li|table|br)$/i.test(e.nodeName);if(!/^br$/i.test(e.nodeName)&&0==e.textContent.length)return;d&&c();for(var g=0;g<e.childNodes.length;g++)h(e.childNodes[g]);/^(pre|p)$/i.test(e.nodeName)&&(l=!0),d&&(s=!0)}else 3==e.nodeType&&u(e.nodeValue.replace(/\u200b/g,"").replace(/\u00a0/g," "));var v}for(;h(e),e!=r;)e=e.nextSibling,l=!1;return o}(i,r,c,e,l)),p=ct(i.doc,vt(e,0),vt(l,lt(i.doc,l).text.length));h.length>1&&p.length>1;)if(K(h)==K(p))h.pop(),p.pop(),l--;else{if(h[0]!=p[0])break;h.shift(),p.shift(),e++}for(var f=0,d=0,g=h[0],v=p[0],m=Math.min(g.length,v.length);f<m&&g.charCodeAt(f)==v.charCodeAt(f);)++f;for(var y=K(h),b=K(p),w=Math.min(y.length-(1==h.length?f:0),b.length-(1==p.length?f:0));d<w&&y.charCodeAt(y.length-d-1)==b.charCodeAt(b.length-d-1);)++d;if(1==h.length&&1==p.length&&e==s.line)for(;f&&f>s.ch&&y.charCodeAt(y.length-d-1)==b.charCodeAt(b.length-d-1);)f--,d++;h[h.length-1]=y.slice(0,y.length-d).replace(/^\u200b+/,""),h[0]=h[0].slice(f).replace(/\u200b+$/,"");var x=vt(e,f),k=vt(l,p.length?K(p).length-d:0);return h.length>1||h[0]||mt(x,k)?(uo(i.doc,h,x,k,"+input"),!0):void 0},Fs.prototype.ensurePolled=function(){this.forceCompositionEnd()},Fs.prototype.reset=function(){this.forceCompositionEnd()},Fs.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},Fs.prototype.readFromDOMSoon=function(){var t=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(t.readDOMTimeout=null,t.composing){if(!t.composing.done)return;t.composing=null}t.updateFromDOM()},80))},Fs.prototype.updateFromDOM=function(){var t=this;!this.cm.isReadOnly()&&this.pollContent()||qi(this.cm,function(){return Ji(t.cm)})},Fs.prototype.setUneditable=function(t){t.contentEditable="false"},Fs.prototype.onKeyPress=function(t){0==t.charCode||this.composing||(t.preventDefault(),this.cm.isReadOnly()||Xi(this.cm,As)(this.cm,String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),0))},Fs.prototype.readOnlyChanged=function(t){this.div.contentEditable=String("nocursor"!=t)},Fs.prototype.onContextMenu=function(){},Fs.prototype.resetPosition=function(){},Fs.prototype.needsContentAttribute=!0;var Vs=function(t){this.cm=t,this.prevInput="",this.pollingFast=!1,this.polling=new U,this.hasSelection=!1,this.composing=null};Vs.prototype.init=function(t){var e=this,r=this,i=this.cm;this.createField(t);var n=this.textarea;function o(t){if(!oe(i,t)){if(i.somethingSelected())Ts({lineWise:!1,text:i.getSelections()});else{if(!i.options.lineWiseCopyCut)return;var e=Ls(i);Ts({lineWise:!0,text:e.text}),"cut"==t.type?i.setSelections(e.ranges,null,z):(r.prevInput="",n.value=e.text.join("\n"),I(n))}"cut"==t.type&&(i.state.cutIncoming=+new Date)}}t.wrapper.insertBefore(this.wrapper,t.wrapper.firstChild),g&&(n.style.width="0px"),ee(n,"input",function(){s&&a>=9&&e.hasSelection&&(e.hasSelection=null),r.poll()}),ee(n,"paste",function(t){oe(i,t)||Rs(t,i)||(i.state.pasteIncoming=+new Date,r.fastPoll())}),ee(n,"cut",o),ee(n,"copy",o),ee(t.scroller,"paste",function(e){if(!kr(t,e)&&!oe(i,e)){if(!n.dispatchEvent)return i.state.pasteIncoming=+new Date,void r.focus();var o=new Event("paste");o.clipboardData=e.clipboardData,n.dispatchEvent(o)}}),ee(t.lineSpace,"selectstart",function(e){kr(t,e)||ce(e)}),ee(n,"compositionstart",function(){var t=i.getCursor("from");r.composing&&r.composing.range.clear(),r.composing={start:t,range:i.markText(t,i.getCursor("to"),{className:"CodeMirror-composing"})}}),ee(n,"compositionend",function(){r.composing&&(r.poll(),r.composing.range.clear(),r.composing=null)})},Vs.prototype.createField=function(t){this.wrapper=Ms(),this.textarea=this.wrapper.firstChild},Vs.prototype.prepareSelection=function(){var t=this.cm,e=t.display,r=t.doc,i=ui(t);if(t.options.moveInputWithCursor){var n=qr(t,r.sel.primary().head,"div"),o=e.wrapper.getBoundingClientRect(),s=e.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(e.wrapper.clientHeight-10,n.top+s.top-o.top)),i.teLeft=Math.max(0,Math.min(e.wrapper.clientWidth-10,n.left+s.left-o.left))}return i},Vs.prototype.showSelection=function(t){var e=this.cm,r=e.display;T(r.cursorDiv,t.cursors),T(r.selectionDiv,t.selection),null!=t.teTop&&(this.wrapper.style.top=t.teTop+"px",this.wrapper.style.left=t.teLeft+"px")},Vs.prototype.reset=function(t){if(!this.contextMenuPending&&!this.composing){var e=this.cm;if(e.somethingSelected()){this.prevInput="";var r=e.getSelection();this.textarea.value=r,e.state.focused&&I(this.textarea),s&&a>=9&&(this.hasSelection=r)}else t||(this.prevInput=this.textarea.value="",s&&a>=9&&(this.hasSelection=null))}},Vs.prototype.getField=function(){return this.textarea},Vs.prototype.supportsTouch=function(){return!1},Vs.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!m||L()!=this.textarea))try{this.textarea.focus()}catch(t){}},Vs.prototype.blur=function(){this.textarea.blur()},Vs.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},Vs.prototype.receivedFocus=function(){this.slowPoll()},Vs.prototype.slowPoll=function(){var t=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){t.poll(),t.cm.state.focused&&t.slowPoll()})},Vs.prototype.fastPoll=function(){var t=!1,e=this;e.pollingFast=!0,e.polling.set(20,function r(){var i=e.poll();i||t?(e.pollingFast=!1,e.slowPoll()):(t=!0,e.polling.set(60,r))})},Vs.prototype.poll=function(){var t=this,e=this.cm,r=this.textarea,i=this.prevInput;if(this.contextMenuPending||!e.state.focused||ke(r)&&!i&&!this.composing||e.isReadOnly()||e.options.disableInput||e.state.keySeq)return!1;var n=r.value;if(n==i&&!e.somethingSelected())return!1;if(s&&a>=9&&this.hasSelection===n||y&&/[\uf700-\uf7ff]/.test(n))return e.display.input.reset(),!1;if(e.doc.sel==e.display.selForContextMenu){var o=n.charCodeAt(0);if(8203!=o||i||(i="​"),8666==o)return this.reset(),this.cm.execCommand("undo")}for(var l=0,c=Math.min(i.length,n.length);l<c&&i.charCodeAt(l)==n.charCodeAt(l);)++l;return qi(e,function(){As(e,n.slice(l),i.length-l,null,t.composing?"*compose":null),n.length>1e3||n.indexOf("\n")>-1?r.value=t.prevInput="":t.prevInput=n,t.composing&&(t.composing.range.clear(),t.composing.range=e.markText(t.composing.start,e.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},Vs.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},Vs.prototype.onKeyPress=function(){s&&a>=9&&(this.hasSelection=null),this.fastPoll()},Vs.prototype.onContextMenu=function(t){var e=this,r=e.cm,i=r.display,n=e.textarea;e.contextMenuPending&&e.contextMenuPending();var o=ai(r,t),c=i.scroller.scrollTop;if(o&&!h){var u=r.options.resetSelectionOnContextMenu;u&&-1==r.doc.sel.contains(o)&&Xi(r,Kn)(r.doc,xn(o),z);var p,f=n.style.cssText,d=e.wrapper.style.cssText,g=e.wrapper.offsetParent.getBoundingClientRect();if(e.wrapper.style.cssText="position: static",n.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(t.clientY-g.top-5)+"px; left: "+(t.clientX-g.left-5)+"px;\n      z-index: 1000; background: "+(s?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",l&&(p=window.scrollY),i.input.focus(),l&&window.scrollTo(null,p),i.input.reset(),r.somethingSelected()||(n.value=e.prevInput=" "),e.contextMenuPending=y,i.selForContextMenu=r.doc.sel,clearTimeout(i.detectingSelectAll),s&&a>=9&&m(),S){pe(t);var v=function(){ie(window,"mouseup",v),setTimeout(y,20)};ee(window,"mouseup",v)}else setTimeout(y,50)}function m(){if(null!=n.selectionStart){var t=r.somethingSelected(),o="​"+(t?n.value:"");n.value="⇚",n.value=o,e.prevInput=t?"":"​",n.selectionStart=1,n.selectionEnd=o.length,i.selForContextMenu=r.doc.sel}}function y(){if(e.contextMenuPending==y&&(e.contextMenuPending=!1,e.wrapper.style.cssText=d,n.style.cssText=f,s&&a<9&&i.scrollbars.setScrollTop(i.scroller.scrollTop=c),null!=n.selectionStart)){(!s||s&&a<9)&&m();var t=0,o=function(){i.selForContextMenu==r.doc.sel&&0==n.selectionStart&&n.selectionEnd>0&&"​"==e.prevInput?Xi(r,io)(r):t++<10?i.detectingSelectAll=setTimeout(o,500):(i.selForContextMenu=null,i.input.reset())};i.detectingSelectAll=setTimeout(o,200)}}},Vs.prototype.readOnlyChanged=function(t){t||this.reset(),this.textarea.disabled="nocursor"==t},Vs.prototype.setUneditable=function(){},Vs.prototype.needsContentAttribute=!1,function(t){var e=t.optionHandlers;function r(r,i,n,o){t.defaults[r]=i,n&&(e[r]=o?function(t,e,r){r!=ys&&n(t,e,r)}:n)}t.defineOption=r,t.Init=ys,r("value","",function(t,e){return t.setValue(e)},!0),r("mode",null,function(t,e){t.doc.modeOption=e,Nn(t)},!0),r("indentUnit",2,Nn,!0),r("indentWithTabs",!1),r("smartIndent",!0),r("tabSize",4,function(t){Pn(t),jr(t),Ji(t)},!0),r("lineSeparator",null,function(t,e){if(t.doc.lineSep=e,e){var r=[],i=t.doc.first;t.doc.iter(function(t){for(var n=0;;){var o=t.text.indexOf(e,n);if(-1==o)break;n=o+e.length,r.push(vt(i,o))}i++});for(var n=r.length-1;n>=0;n--)uo(t.doc,e,r[n],vt(r[n].line,r[n].ch+e.length))}}),r("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,function(t,e,r){t.state.specialChars=new RegExp(e.source+(e.test("\t")?"":"|\t"),"g"),r!=ys&&t.refresh()}),r("specialCharPlaceholder",Qe,function(t){return t.refresh()},!0),r("electricChars",!0),r("inputStyle",m?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),r("spellcheck",!1,function(t,e){return t.getInputField().spellcheck=e},!0),r("autocorrect",!1,function(t,e){return t.getInputField().autocorrect=e},!0),r("autocapitalize",!1,function(t,e){return t.getInputField().autocapitalize=e},!0),r("rtlMoveVisually",!w),r("wholeLineUpdateBefore",!0),r("theme","default",function(t){ms(t),xs(t)},!0),r("keyMap","default",function(t,e,r){var i=Go(e),n=r!=ys&&Go(r);n&&n.detach&&n.detach(t,i),i.attach&&i.attach(t,n||null)}),r("extraKeys",null),r("configureMouse",null),r("lineWrapping",!1,Ss,!0),r("gutters",[],function(t){pn(t.options),xs(t)},!0),r("fixedGutter",!0,function(t,e){t.display.gutters.style.left=e?ni(t.display)+"px":"0",t.refresh()},!0),r("coverGutterNextToScrollbar",!1,function(t){return Di(t)},!0),r("scrollbarStyle","native",function(t){Ui(t),Di(t),t.display.scrollbars.setScrollTop(t.doc.scrollTop),t.display.scrollbars.setScrollLeft(t.doc.scrollLeft)},!0),r("lineNumbers",!1,function(t){pn(t.options),xs(t)},!0),r("firstLineNumber",1,xs,!0),r("lineNumberFormatter",function(t){return t},xs,!0),r("showCursorWhenSelecting",!1,ci,!0),r("resetSelectionOnContextMenu",!0),r("lineWiseCopyCut",!0),r("pasteLinesPerSelection",!0),r("selectionsMayTouch",!1),r("readOnly",!1,function(t,e){"nocursor"==e&&(yi(t),t.display.input.blur()),t.display.input.readOnlyChanged(e)}),r("disableInput",!1,function(t,e){e||t.display.input.reset()},!0),r("dragDrop",!0,ks),r("allowDropFileTypes",null),r("cursorBlinkRate",530),r("cursorScrollMargin",0),r("cursorHeight",1,ci,!0),r("singleCursorHeightPerLine",!0,ci,!0),r("workTime",100),r("workDelay",100),r("flattenSpans",!0,Pn,!0),r("addModeClass",!1,Pn,!0),r("pollInterval",100),r("undoDepth",200,function(t,e){return t.doc.history.undoDepth=e}),r("historyEventDelay",1250),r("viewportMargin",10,function(t){return t.refresh()},!0),r("maxHighlightLength",1e4,Pn,!0),r("moveInputWithCursor",!0,function(t,e){e||t.display.input.resetPosition()}),r("tabindex",null,function(t,e){return t.display.input.getField().tabIndex=e||""}),r("autofocus",null),r("direction","ltr",function(t,e){return t.doc.setDirection(e)},!0),r("phrases",null)}(Es),function(t){var e=t.optionHandlers,r=t.helpers={};t.prototype={constructor:t,focus:function(){window.focus(),this.display.input.focus()},setOption:function(t,r){var i=this.options,n=i[t];i[t]==r&&"mode"!=t||(i[t]=r,e.hasOwnProperty(t)&&Xi(this,e[t])(this,r,n),ne(this,"optionChange",this,t))},getOption:function(t){return this.options[t]},getDoc:function(){return this.doc},addKeyMap:function(t,e){this.state.keyMaps[e?"push":"unshift"](Go(t))},removeKeyMap:function(t){for(var e=this.state.keyMaps,r=0;r<e.length;++r)if(e[r]==t||e[r].name==t)return e.splice(r,1),!0},addOverlay:Ki(function(e,r){var i=e.token?e:t.getMode(this.options,e);if(i.startState)throw new Error("Overlays may not be stateful.");!function(t,e,r){for(var i=0,n=r(e);i<t.length&&r(t[i])<=n;)i++;t.splice(i,0,e)}(this.state.overlays,{mode:i,modeSpec:e,opaque:r&&r.opaque,priority:r&&r.priority||0},function(t){return t.priority}),this.state.modeGen++,Ji(this)}),removeOverlay:Ki(function(t){for(var e=this.state.overlays,r=0;r<e.length;++r){var i=e[r].modeSpec;if(i==t||"string"==typeof t&&i.name==t)return e.splice(r,1),this.state.modeGen++,void Ji(this)}}),indentLine:Ki(function(t,e,r){"string"!=typeof e&&"number"!=typeof e&&(e=null==e?this.options.smartIndent?"smart":"prev":e?"add":"subtract"),dt(this.doc,t)&&Ns(this,t,e,r)}),indentSelection:Ki(function(t){for(var e=this.doc.sel.ranges,r=-1,i=0;i<e.length;i++){var n=e[i];if(n.empty())n.head.line>r&&(Ns(this,n.head.line,t,!0),r=n.head.line,i==this.doc.sel.primIndex&&Ni(this));else{var o=n.from(),s=n.to(),a=Math.max(r,o.line);r=Math.min(this.lastLine(),s.line-(s.ch?0:1))+1;for(var l=a;l<r;++l)Ns(this,l,t);var c=this.doc.sel.ranges;0==o.ch&&e.length==c.length&&c[i].from().ch>0&&Gn(this.doc,i,new bn(o,c[i].to()),z)}}}),getTokenAt:function(t,e){return He(this,t,e)},getLineTokens:function(t,e){return He(this,vt(t),e,!0)},getTokenTypeAt:function(t){t=St(this.doc,t);var e,r=Be(this,lt(this.doc,t.line)),i=0,n=(r.length-1)/2,o=t.ch;if(0==o)e=r[2];else for(;;){var s=i+n>>1;if((s?r[2*s-1]:0)>=o)n=s;else{if(!(r[2*s+1]<o)){e=r[2*s+2];break}i=s+1}}var a=e?e.indexOf("overlay "):-1;return a<0?e:0==a?null:e.slice(0,a-1)},getModeAt:function(e){var r=this.doc.mode;return r.innerMode?t.innerMode(r,this.getTokenAt(e).state).mode:r},getHelper:function(t,e){return this.getHelpers(t,e)[0]},getHelpers:function(t,e){var i=[];if(!r.hasOwnProperty(e))return i;var n=r[e],o=this.getModeAt(t);if("string"==typeof o[e])n[o[e]]&&i.push(n[o[e]]);else if(o[e])for(var s=0;s<o[e].length;s++){var a=n[o[e][s]];a&&i.push(a)}else o.helperType&&n[o.helperType]?i.push(n[o.helperType]):n[o.name]&&i.push(n[o.name]);for(var l=0;l<n._global.length;l++){var c=n._global[l];c.pred(o,this)&&-1==j(i,c.val)&&i.push(c.val)}return i},getStateAfter:function(t,e){var r=this.doc;return Ue(this,(t=kt(r,null==t?r.first+r.size-1:t))+1,e).state},cursorCoords:function(t,e){var r=this.doc.sel.primary();return qr(this,null==t?r.head:"object"==typeof t?St(this.doc,t):t?r.from():r.to(),e||"page")},charCoords:function(t,e){return Gr(this,St(this.doc,t),e||"page")},coordsChar:function(t,e){return $r(this,(t=Yr(this,t,e||"page")).left,t.top)},lineAtHeight:function(t,e){return t=Yr(this,{top:t,left:0},e||"page").top,ft(this.doc,t+this.display.viewOffset)},heightAtLine:function(t,e,r){var i,n=!1;if("number"==typeof t){var o=this.doc.first+this.doc.size-1;t<this.doc.first?t=this.doc.first:t>o&&(t=o,n=!0),i=lt(this.doc,t)}else i=t;return Hr(this,i,{top:0,left:0},e||"page",r||n).top+(n?this.doc.height-qt(i):0)},defaultTextHeight:function(){return ei(this.display)},defaultCharWidth:function(){return ri(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(t,e,r,i,n){var o,s,a,l=this.display,c=(t=qr(this,St(this.doc,t))).bottom,u=t.left;if(e.style.position="absolute",e.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(e),l.sizer.appendChild(e),"over"==i)c=t.top;else if("above"==i||"near"==i){var h=Math.max(l.wrapper.clientHeight,this.doc.height),p=Math.max(l.sizer.clientWidth,l.lineSpace.clientWidth);("above"==i||t.bottom+e.offsetHeight>h)&&t.top>e.offsetHeight?c=t.top-e.offsetHeight:t.bottom+e.offsetHeight<=h&&(c=t.bottom),u+e.offsetWidth>p&&(u=p-e.offsetWidth)}e.style.top=c+"px",e.style.left=e.style.right="","right"==n?(u=l.sizer.clientWidth-e.offsetWidth,e.style.right="0px"):("left"==n?u=0:"middle"==n&&(u=(l.sizer.clientWidth-e.offsetWidth)/2),e.style.left=u+"px"),r&&(o=this,s={left:u,top:c,right:u+e.offsetWidth,bottom:c+e.offsetHeight},null!=(a=Ei(o,s)).scrollTop&&Ri(o,a.scrollTop),null!=a.scrollLeft&&Li(o,a.scrollLeft))},triggerOnKeyDown:Ki(ss),triggerOnKeyPress:Ki(ls),triggerOnKeyUp:as,triggerOnMouseDown:Ki(ps),execCommand:function(t){if(Jo.hasOwnProperty(t))return Jo[t].call(null,this)},triggerElectric:Ki(function(t){Os(this,t)}),findPosH:function(t,e,r,i){var n=1;e<0&&(n=-1,e=-e);for(var o=St(this.doc,t),s=0;s<e&&!(o=Is(this.doc,o,n,r,i)).hitSide;++s);return o},moveH:Ki(function(t,e){var r=this;this.extendSelectionsBy(function(i){return r.display.shift||r.doc.extend||i.empty()?Is(r.doc,i.head,t,e,r.options.rtlMoveVisually):t<0?i.from():i.to()},Y)}),deleteH:Ki(function(t,e){var r=this.doc.sel,i=this.doc;r.somethingSelected()?i.replaceSelection("",null,"+delete"):qo(this,function(r){var n=Is(i,r.head,t,e,!1);return t<0?{from:n,to:r.head}:{from:r.head,to:n}})}),findPosV:function(t,e,r,i){var n=1,o=i;e<0&&(n=-1,e=-e);for(var s=St(this.doc,t),a=0;a<e;++a){var l=qr(this,s,"div");if(null==o?o=l.left:l.left=o,(s=Ds(this,l,n,r)).hitSide)break}return s},moveV:Ki(function(t,e){var r=this,i=this.doc,n=[],o=!this.display.shift&&!i.extend&&i.sel.somethingSelected();if(i.extendSelectionsBy(function(s){if(o)return t<0?s.from():s.to();var a=qr(r,s.head,"div");null!=s.goalColumn&&(a.left=s.goalColumn),n.push(a.left);var l=Ds(r,a,t,e);return"page"==e&&s==i.sel.primary()&&Ci(r,Gr(r,l,"div").top-a.top),l},Y),n.length)for(var s=0;s<i.sel.ranges.length;s++)i.sel.ranges[s].goalColumn=n[s]}),findWordAt:function(t){var e=this.doc,r=lt(e,t.line).text,i=t.ch,n=t.ch;if(r){var o=this.getHelper(t,"wordChars");"before"!=t.sticky&&n!=r.length||!i?++n:--i;for(var s=r.charAt(i),a=et(s,o)?function(t){return et(t,o)}:/\s/.test(s)?function(t){return/\s/.test(t)}:function(t){return!/\s/.test(t)&&!et(t)};i>0&&a(r.charAt(i-1));)--i;for(;n<r.length&&a(r.charAt(n));)++n}return new bn(vt(t.line,i),vt(t.line,n))},toggleOverwrite:function(t){null!=t&&t==this.state.overwrite||((this.state.overwrite=!this.state.overwrite)?_(this.display.cursorDiv,"CodeMirror-overwrite"):N(this.display.cursorDiv,"CodeMirror-overwrite"),ne(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==L()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:Ki(function(t,e){Pi(this,t,e)}),getScrollInfo:function(){var t=this.display.scroller;return{left:t.scrollLeft,top:t.scrollTop,height:t.scrollHeight-Nr(this)-this.display.barHeight,width:t.scrollWidth-Nr(this)-this.display.barWidth,clientHeight:Tr(this),clientWidth:Pr(this)}},scrollIntoView:Ki(function(t,e){null==t?(t={from:this.doc.sel.primary().head,to:null},null==e&&(e=this.options.cursorScrollMargin)):"number"==typeof t?t={from:vt(t,0),to:null}:null==t.from&&(t={from:t,to:null}),t.to||(t.to=t.from),t.margin=e||0,null!=t.from.line?function(t,e){Ti(t),t.curOp.scrollToPos=e}(this,t):Ai(this,t.from,t.to,t.margin)}),setSize:Ki(function(t,e){var r=this,i=function(t){return"number"==typeof t||/^\d+$/.test(String(t))?t+"px":t};null!=t&&(this.display.wrapper.style.width=i(t)),null!=e&&(this.display.wrapper.style.height=i(e)),this.options.lineWrapping&&Ur(this);var n=this.display.viewFrom;this.doc.iter(n,this.display.viewTo,function(t){if(t.widgets)for(var e=0;e<t.widgets.length;e++)if(t.widgets[e].noHScroll){Zi(r,n,"widget");break}++n}),this.curOp.forceUpdate=!0,ne(this,"refresh",this)}),operation:function(t){return qi(this,t)},startOperation:function(){return Wi(this)},endOperation:function(){return Vi(this)},refresh:Ki(function(){var t=this.display.cachedTextHeight;Ji(this),this.curOp.forceUpdate=!0,jr(this),Pi(this,this.doc.scrollLeft,this.doc.scrollTop),cn(this),(null==t||Math.abs(t-ei(this.display))>.5)&&si(this),ne(this,"refresh",this)}),swapDoc:Ki(function(t){var e=this.doc;return e.cm=null,On(this,t),jr(this),this.display.input.reset(),Pi(this,t.scrollLeft,t.scrollTop),this.curOp.forceScroll=!0,lr(this,"swapDoc",this,e),e}),phrase:function(t){var e=this.options.phrases;return e&&Object.prototype.hasOwnProperty.call(e,t)?e[t]:t},getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},le(t),t.registerHelper=function(e,i,n){r.hasOwnProperty(e)||(r[e]=t[e]={_global:[]}),r[e][i]=n},t.registerGlobalHelper=function(e,i,n,o){t.registerHelper(e,i,o),r[e]._global.push({pred:n,val:o})}}(Es);var zs="iter insert remove copy getEditor constructor".split(" ");for(var Hs in Po.prototype)Po.prototype.hasOwnProperty(Hs)&&j(zs,Hs)<0&&(Es.prototype[Hs]=function(t){return function(){return t.apply(this.doc,arguments)}}(Po.prototype[Hs]));return le(Po),Es.inputStyles={textarea:Vs,contenteditable:Fs},Es.defineMode=function(t){Es.defaults.mode||"null"==t||(Es.defaults.mode=t),function(t,e){arguments.length>2&&(e.dependencies=Array.prototype.slice.call(arguments,2)),Ce[t]=e}.apply(this,arguments)},Es.defineMIME=function(t,e){Ne[t]=e},Es.defineMode("null",function(){return{token:function(t){return t.skipToEnd()}}}),Es.defineMIME("text/plain","null"),Es.defineExtension=function(t,e){Es.prototype[t]=e},Es.defineDocExtension=function(t,e){Po.prototype[t]=e},Es.fromTextArea=function(t,e){if((e=e?F(e):{}).value=t.value,!e.tabindex&&t.tabIndex&&(e.tabindex=t.tabIndex),!e.placeholder&&t.placeholder&&(e.placeholder=t.placeholder),null==e.autofocus){var r=L();e.autofocus=r==t||null!=t.getAttribute("autofocus")&&r==document.body}function i(){t.value=a.getValue()}var n;if(t.form&&(ee(t.form,"submit",i),!e.leaveSubmitMethodAlone)){var o=t.form;n=o.submit;try{var s=o.submit=function(){i(),o.submit=n,o.submit(),o.submit=s}}catch(t){}}e.finishInit=function(e){e.save=i,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,i(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(ie(t.form,"submit",i),"function"==typeof t.form.submit&&(t.form.submit=n))}},t.style.display="none";var a=Es(function(e){return t.parentNode.insertBefore(e,t.nextSibling)},e);return a},function(t){t.off=ie,t.on=ee,t.wheelEventPixels=vn,t.Doc=Po,t.splitLines=xe,t.countColumn=B,t.findColumn=G,t.isWordChar=tt,t.Pass=V,t.signal=ne,t.Line=qe,t.changeEnd=kn,t.scrollbarModel=Bi,t.Pos=vt,t.cmpPos=mt,t.modes=Ce,t.mimeModes=Ne,t.resolveMode=Pe,t.getMode=Te,t.modeExtensions=Ae,t.extendMode=Re,t.copyState=Oe,t.startState=_e,t.innerMode=Le,t.commands=Jo,t.keyMap=Uo,t.keyName=Yo,t.isModifierKey=zo,t.lookupKey=Vo,t.normalizeKeyMap=Wo,t.StringStream=Me,t.SharedTextMarker=So,t.TextMarker=xo,t.LineWidget=yo,t.e_preventDefault=ce,t.e_stopPropagation=ue,t.e_stop=pe,t.addClass=_,t.contains=O,t.rmClass=N,t.keyNames=Io}(Es),Es.version="5.44.0",Es}()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(0),n=function(){function t(t,e,r,n,o,s,a){void 0===t&&(t=i.Vector2d.ORIGIN),void 0===e&&(e=0),void 0===r&&(r=0),void 0===n&&(n=1),void 0===o&&(o=[]),void 0===s&&(s=""),void 0===a&&(a=""),this.position=t,this.facing=e,this.height=r,this.opacity=n,this.strokes=o,this.foreground=s,this.background=a}return t.new=function(){return new t},Object.defineProperty(t.prototype,"facingRadians",{get:function(){return i.deg2rad(this.facing)},enumerable:!0,configurable:!0}),t.prototype.with=function(e){return new t(e.position||this.position,"facing"in e?e.facing:this.facing,"height"in e?e.height:this.height,"opacity"in e?e.opacity:this.opacity,"newStrokes"in e?this.strokes.concat(e.newStrokes):this.strokes,"foreground"in e?e.foreground:this.foreground,"background"in e?e.background:this.background)},t}();e.Frame=n;var o=function(){function t(t,e){this.duration=t,this.update=e,this.elapsed=0}return Object.defineProperty(t.prototype,"currentFrame",{get:function(){return this.update(this.elapsed/this.duration,this.keyFrame)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lastFrame",{get:function(){return this.update(1,this.keyFrame)},enumerable:!0,configurable:!0}),t.prototype.withKeyFrame=function(t){return this.keyFrame=t,this},t}();e.Animation=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(1),n=r(2);r(5),r(10);var o=r(3),s=r(11),a=r(14),l=r(15),c=function(){function t(t){var e=this;this.ctx=t,this.isFreezing=!1,i.setDraw(function(){return e.draw()}),this.reset()}return t.prototype.reset=function(){i.isRunning()&&i.stop(),this.animation=null,this.frame=o.Frame.new(),this.painter=new a.Painter,this.draw()},t.prototype.animate=function(){this.isFreezing=!1,i.isRunning()||i.start()},t.prototype.freeze=function(){this.isFreezing=!0},t.prototype.setAnimation=function(t){return null===t?null:this.animation=t.withKeyFrame(this.frame)},t.prototype.update=function(t){if(this.isFreezing)this.animation&&(this.frame=this.animation.lastFrame,this.animation=null),i.stop();else{if(!this.animation&&!P())return!1;for(;this.animation;){if(this.animation.elapsed+=t/1e3*I,this.animation.elapsed<this.animation.duration){this.frame=this.animation.currentFrame;break}if(this.frame=this.animation.lastFrame,t=1e3*(this.animation.elapsed-this.animation.duration)/I,this.animation.elapsed=this.animation.duration,!P())return!1}}return this.painter.update(this.frame),!0},t.prototype.draw=function(){var t=this;this.drawPaper(this.ctx),this.frame.strokes.forEach(function(e){return e.defaultColor(t.frame.foreground).draw(p,3.2)}),this.painter.draw(this.ctx)},t.prototype.drawPaper=function(t,e){void 0===e&&(e=3.2);var r=t.canvas.width,i=t.canvas.height,n=r/2,o=i/2;if(t.save(),this.frame.background&&"none"!==this.frame.background&&"transparent"!==this.frame.background)t.fillStyle=this.frame.background,t.fillRect(-n,-o,r,i);else{t.fillStyle="#DAEAFF",t.fillRect(-n,-o,r,i),t.strokeStyle="white",t.beginPath(),t.moveTo(0,-o),t.lineTo(0,o),t.moveTo(-n,0),t.lineTo(n,0),t.stroke();var s=5*e;t.lineWidth=.5,t.beginPath();for(var a=s;a<=n;a+=s)t.moveTo(a,-o),t.lineTo(a,o);for(a=-s;a>=-n;a-=s)t.moveTo(a,-o),t.lineTo(a,o);for(var l=s;l<=o;l+=s)t.moveTo(-n,l),t.lineTo(n,l);for(l=-s;l>=-o;l-=s)t.moveTo(-n,l),t.lineTo(n,l);t.stroke()}t.restore()},t}(),u=document.getElementById("canvas_holder"),h=document.getElementById("canvas"),p=h.getContext("2d"),f=new c(p);function d(){h.width=u.offsetWidth,h.height=u.offsetHeight,p.restore(),p.save(),p.scale(1,-1),p.translate(h.width/2,-h.height/2),p.lineWidth=2,p.lineCap="round",p.lineJoin="round",f.draw()}window.addEventListener("resize",d),d();var g=document.getElementById("code"),v=n.fromTextArea(g,{lineNumbers:!0,mode:"javascript",tabSize:2,extraKeys:{"Ctrl-Alt-Enter":function(){return R("step-fwd")},"Ctrl-Enter":function(){return R("playing")},"Shift-Ctrl-Enter":function(){return R("fast-fwd")},"Ctrl-S":l.saveOperation,"Ctrl-O":l.showDiskContent}});l.initialize(v);var m,y=document.getElementById("out"),b=document.getElementById("pause"),w=document.getElementById("sfwd"),x=document.getElementById("play"),k=document.getElementById("ffwd"),S=document.getElementById("stop"),E=document.getElementById("trace");E.addEventListener("change",function(){return T()}),R("ready"),b.addEventListener("click",function(){R("paused")}),w.addEventListener("click",function(){R("step-fwd")}),x.addEventListener("click",function(){R("playing")}),k.addEventListener("click",function(){R("fast-fwd")}),S.addEventListener("click",function(){R("ready")});var C,N=1e4;function P(t){void 0===t&&(t=0);try{var e=C.stepToNextInstruction();if(e){if(E.checked){T();var r=v.findPosH(n.Pos(0,0),e.node.start,"char",!0),i=v.findPosH(n.Pos(0,0),e.node.end,"char",!0);return v.getDoc().markText(r,i,{css:"background: rgba(128,255,128,0.4)"}),f.setAnimation(e.animation||new o.Animation(10,function(t,e){return e}))}return e.animation?f.setAnimation(e.animation):t<N?P(t+1):(T(),A(e.node.start,e.node.end),y.innerHTML="<span style=color:red>WARNING: Possible infinite loop!</span>\n",f.setAnimation(new o.Animation("fast-fwd"===m?2e4:20,function(t,e){return e})))}}catch(t){throw R("done"),A(t.state.node.start,t.state.node.end,t.message),t}return f.setAnimation(null)}function T(){v.getDoc().getAllMarks().forEach(function(t){return t.clear()})}function A(t,e,r){var i=v.findPosH(n.Pos(0,0),t,"char",!0),o=v.findPosH(n.Pos(0,0),e,"char",!0);v.getDoc().markText(i,o,{css:"background: rgba(255,128,128,0.4)"}),r&&(y.innerHTML+="<span style=color:red>"+r+"</span>\n")}function R(t){switch(t){case"ready":_(b,S),M(w,k,x),T(),y.textContent="",f.reset();break;case"playing":_(x),M(w,b,k,S),L(w),O(),f.animate();break;case"step-fwd":return _(w,b,x,k,S),O(),f.animate(),void(P()?R("paused"):R("done"));case"paused":_(b),M(w,x,k,S),f.freeze();break;case"fast-fwd":_(k),M(w,x,b,S),L(w),O(),f.animate();break;case"done":_(b),M(w,x,k,S),L(),T(),f.freeze()}m=t}function O(){if("ready"===m||"done"===m){v.save();try{C=new s.Interpreter(g.value)}catch(i){R("done");var t=/(.*)\((\d+):(\d+)\)\s*$/.exec(i.message),e=n.Pos(+t[2],+t[3]),r=v.getTokenAt(e);throw A(r.start,r.end,t[1]+"'"+r.string+"'"),i}y.textContent="",f.reset()}}function L(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.forEach(function(t){t.disabled=!0,t.classList.add("disabled")})}function _(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.forEach(function(t){return t.style.display="none"})}function M(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.forEach(function(t){return t.style.display="inline-block"}),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];t.forEach(function(t){t.disabled=!1,t.classList.remove("disabled")})}.apply(void 0,t)}i.setUpdate(function(t){"step-fwd"!==m&&("fast-fwd"===m&&(t*=1e3),f.update(t)||R("done"))});var I=100},function(t,e,r){var i=r(6);"string"==typeof i&&(i=[[t.i,i,""]]);var n={hmr:!0,transform:void 0,insertInto:void 0};r(8)(i,n);i.locals&&(t.exports=i.locals)},function(t,e,r){(t.exports=r(7)(!1)).push([t.i,"/* BASICS */\n\n.CodeMirror {\n  /* Set height, width, borders, and global font properties here */\n  font-family: monospace;\n  height: 300px;\n  color: black;\n  direction: ltr;\n}\n\n/* PADDING */\n\n.CodeMirror-lines {\n  padding: 4px 0; /* Vertical padding around content */\n}\n.CodeMirror pre {\n  padding: 0 4px; /* Horizontal padding of content */\n}\n\n.CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {\n  background-color: white; /* The little square between H and V scrollbars */\n}\n\n/* GUTTER */\n\n.CodeMirror-gutters {\n  border-right: 1px solid #ddd;\n  background-color: #f7f7f7;\n  white-space: nowrap;\n}\n.CodeMirror-linenumbers {}\n.CodeMirror-linenumber {\n  padding: 0 3px 0 5px;\n  min-width: 20px;\n  text-align: right;\n  color: #999;\n  white-space: nowrap;\n}\n\n.CodeMirror-guttermarker { color: black; }\n.CodeMirror-guttermarker-subtle { color: #999; }\n\n/* CURSOR */\n\n.CodeMirror-cursor {\n  border-left: 1px solid black;\n  border-right: none;\n  width: 0;\n}\n/* Shown when moving in bi-directional text */\n.CodeMirror div.CodeMirror-secondarycursor {\n  border-left: 1px solid silver;\n}\n.cm-fat-cursor .CodeMirror-cursor {\n  width: auto;\n  border: 0 !important;\n  background: #7e7;\n}\n.cm-fat-cursor div.CodeMirror-cursors {\n  z-index: 1;\n}\n.cm-fat-cursor-mark {\n  background-color: rgba(20, 255, 20, 0.5);\n  -webkit-animation: blink 1.06s steps(1) infinite;\n  -moz-animation: blink 1.06s steps(1) infinite;\n  animation: blink 1.06s steps(1) infinite;\n}\n.cm-animate-fat-cursor {\n  width: auto;\n  border: 0;\n  -webkit-animation: blink 1.06s steps(1) infinite;\n  -moz-animation: blink 1.06s steps(1) infinite;\n  animation: blink 1.06s steps(1) infinite;\n  background-color: #7e7;\n}\n@-moz-keyframes blink {\n  0% {}\n  50% { background-color: transparent; }\n  100% {}\n}\n@-webkit-keyframes blink {\n  0% {}\n  50% { background-color: transparent; }\n  100% {}\n}\n@keyframes blink {\n  0% {}\n  50% { background-color: transparent; }\n  100% {}\n}\n\n/* Can style cursor different in overwrite (non-insert) mode */\n.CodeMirror-overwrite .CodeMirror-cursor {}\n\n.cm-tab { display: inline-block; text-decoration: inherit; }\n\n.CodeMirror-rulers {\n  position: absolute;\n  left: 0; right: 0; top: -50px; bottom: -20px;\n  overflow: hidden;\n}\n.CodeMirror-ruler {\n  border-left: 1px solid #ccc;\n  top: 0; bottom: 0;\n  position: absolute;\n}\n\n/* DEFAULT THEME */\n\n.cm-s-default .cm-header {color: blue;}\n.cm-s-default .cm-quote {color: #090;}\n.cm-negative {color: #d44;}\n.cm-positive {color: #292;}\n.cm-header, .cm-strong {font-weight: bold;}\n.cm-em {font-style: italic;}\n.cm-link {text-decoration: underline;}\n.cm-strikethrough {text-decoration: line-through;}\n\n.cm-s-default .cm-keyword {color: #708;}\n.cm-s-default .cm-atom {color: #219;}\n.cm-s-default .cm-number {color: #164;}\n.cm-s-default .cm-def {color: #00f;}\n.cm-s-default .cm-variable,\n.cm-s-default .cm-punctuation,\n.cm-s-default .cm-property,\n.cm-s-default .cm-operator {}\n.cm-s-default .cm-variable-2 {color: #05a;}\n.cm-s-default .cm-variable-3, .cm-s-default .cm-type {color: #085;}\n.cm-s-default .cm-comment {color: #a50;}\n.cm-s-default .cm-string {color: #a11;}\n.cm-s-default .cm-string-2 {color: #f50;}\n.cm-s-default .cm-meta {color: #555;}\n.cm-s-default .cm-qualifier {color: #555;}\n.cm-s-default .cm-builtin {color: #30a;}\n.cm-s-default .cm-bracket {color: #997;}\n.cm-s-default .cm-tag {color: #170;}\n.cm-s-default .cm-attribute {color: #00c;}\n.cm-s-default .cm-hr {color: #999;}\n.cm-s-default .cm-link {color: #00c;}\n\n.cm-s-default .cm-error {color: #f00;}\n.cm-invalidchar {color: #f00;}\n\n.CodeMirror-composing { border-bottom: 2px solid; }\n\n/* Default styles for common addons */\n\ndiv.CodeMirror span.CodeMirror-matchingbracket {color: #0b0;}\ndiv.CodeMirror span.CodeMirror-nonmatchingbracket {color: #a22;}\n.CodeMirror-matchingtag { background: rgba(255, 150, 0, .3); }\n.CodeMirror-activeline-background {background: #e8f2ff;}\n\n/* STOP */\n\n/* The rest of this file contains styles related to the mechanics of\n   the editor. You probably shouldn't touch them. */\n\n.CodeMirror {\n  position: relative;\n  overflow: hidden;\n  background: white;\n}\n\n.CodeMirror-scroll {\n  overflow: scroll !important; /* Things will break if this is overridden */\n  /* 30px is the magic margin used to hide the element's real scrollbars */\n  /* See overflow: hidden in .CodeMirror */\n  margin-bottom: -30px; margin-right: -30px;\n  padding-bottom: 30px;\n  height: 100%;\n  outline: none; /* Prevent dragging from highlighting the element */\n  position: relative;\n}\n.CodeMirror-sizer {\n  position: relative;\n  border-right: 30px solid transparent;\n}\n\n/* The fake, visible scrollbars. Used to force redraw during scrolling\n   before actual scrolling happens, thus preventing shaking and\n   flickering artifacts. */\n.CodeMirror-vscrollbar, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler {\n  position: absolute;\n  z-index: 6;\n  display: none;\n}\n.CodeMirror-vscrollbar {\n  right: 0; top: 0;\n  overflow-x: hidden;\n  overflow-y: scroll;\n}\n.CodeMirror-hscrollbar {\n  bottom: 0; left: 0;\n  overflow-y: hidden;\n  overflow-x: scroll;\n}\n.CodeMirror-scrollbar-filler {\n  right: 0; bottom: 0;\n}\n.CodeMirror-gutter-filler {\n  left: 0; bottom: 0;\n}\n\n.CodeMirror-gutters {\n  position: absolute; left: 0; top: 0;\n  min-height: 100%;\n  z-index: 3;\n}\n.CodeMirror-gutter {\n  white-space: normal;\n  height: 100%;\n  display: inline-block;\n  vertical-align: top;\n  margin-bottom: -30px;\n}\n.CodeMirror-gutter-wrapper {\n  position: absolute;\n  z-index: 4;\n  background: none !important;\n  border: none !important;\n}\n.CodeMirror-gutter-background {\n  position: absolute;\n  top: 0; bottom: 0;\n  z-index: 4;\n}\n.CodeMirror-gutter-elt {\n  position: absolute;\n  cursor: default;\n  z-index: 4;\n}\n.CodeMirror-gutter-wrapper ::selection { background-color: transparent }\n.CodeMirror-gutter-wrapper ::-moz-selection { background-color: transparent }\n\n.CodeMirror-lines {\n  cursor: text;\n  min-height: 1px; /* prevents collapsing before first draw */\n}\n.CodeMirror pre {\n  /* Reset some styles that the rest of the page might have set */\n  -moz-border-radius: 0; -webkit-border-radius: 0; border-radius: 0;\n  border-width: 0;\n  background: transparent;\n  font-family: inherit;\n  font-size: inherit;\n  margin: 0;\n  white-space: pre;\n  word-wrap: normal;\n  line-height: inherit;\n  color: inherit;\n  z-index: 2;\n  position: relative;\n  overflow: visible;\n  -webkit-tap-highlight-color: transparent;\n  -webkit-font-variant-ligatures: contextual;\n  font-variant-ligatures: contextual;\n}\n.CodeMirror-wrap pre {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  word-break: normal;\n}\n\n.CodeMirror-linebackground {\n  position: absolute;\n  left: 0; right: 0; top: 0; bottom: 0;\n  z-index: 0;\n}\n\n.CodeMirror-linewidget {\n  position: relative;\n  z-index: 2;\n  padding: 0.1px; /* Force widget margins to stay inside of the container */\n}\n\n.CodeMirror-widget {}\n\n.CodeMirror-rtl pre { direction: rtl; }\n\n.CodeMirror-code {\n  outline: none;\n}\n\n/* Force content-box sizing for the elements where we expect it */\n.CodeMirror-scroll,\n.CodeMirror-sizer,\n.CodeMirror-gutter,\n.CodeMirror-gutters,\n.CodeMirror-linenumber {\n  -moz-box-sizing: content-box;\n  box-sizing: content-box;\n}\n\n.CodeMirror-measure {\n  position: absolute;\n  width: 100%;\n  height: 0;\n  overflow: hidden;\n  visibility: hidden;\n}\n\n.CodeMirror-cursor {\n  position: absolute;\n  pointer-events: none;\n}\n.CodeMirror-measure pre { position: static; }\n\ndiv.CodeMirror-cursors {\n  visibility: hidden;\n  position: relative;\n  z-index: 3;\n}\ndiv.CodeMirror-dragcursors {\n  visibility: visible;\n}\n\n.CodeMirror-focused div.CodeMirror-cursors {\n  visibility: visible;\n}\n\n.CodeMirror-selected { background: #d9d9d9; }\n.CodeMirror-focused .CodeMirror-selected { background: #d7d4f0; }\n.CodeMirror-crosshair { cursor: crosshair; }\n.CodeMirror-line::selection, .CodeMirror-line > span::selection, .CodeMirror-line > span > span::selection { background: #d7d4f0; }\n.CodeMirror-line::-moz-selection, .CodeMirror-line > span::-moz-selection, .CodeMirror-line > span > span::-moz-selection { background: #d7d4f0; }\n\n.cm-searching {\n  background-color: #ffa;\n  background-color: rgba(255, 255, 0, .4);\n}\n\n/* Used to force a border model for a node */\n.cm-force-border { padding-right: .1px; }\n\n@media print {\n  /* Hide the cursor when printing */\n  .CodeMirror div.CodeMirror-cursors {\n    visibility: hidden;\n  }\n}\n\n/* See issue #2901 */\n.cm-tab-wrap-hack:after { content: ''; }\n\n/* Help users use markselection to safely style text background */\nspan.CodeMirror-selectedtext { background: none; }\n",""])},function(t,e,r){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var r=function(t,e){var r=t[1]||"",i=t[3];if(!i)return r;if(e&&"function"==typeof btoa){var n=(s=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */"),o=i.sources.map(function(t){return"/*# sourceURL="+i.sourceRoot+t+" */"});return[r].concat(o).concat([n]).join("\n")}var s;return[r].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+r+"}":r}).join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var i={},n=0;n<this.length;n++){var o=this[n][0];null!=o&&(i[o]=!0)}for(n=0;n<t.length;n++){var s=t[n];null!=s[0]&&i[s[0]]||(r&&!s[2]?s[2]=r:r&&(s[2]="("+s[2]+") and ("+r+")"),e.push(s))}},e}},function(t,e,r){var i,n,o={},s=(i=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===n&&(n=i.apply(this,arguments)),n}),a=function(t){var e={};return function(t,r){if("function"==typeof t)return t();if(void 0===e[t]){var i=function(t,e){return e?e.querySelector(t):document.querySelector(t)}.call(this,t,r);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(t){i=null}e[t]=i}return e[t]}}(),l=null,c=0,u=[],h=r(9);function p(t,e){for(var r=0;r<t.length;r++){var i=t[r],n=o[i.id];if(n){n.refs++;for(var s=0;s<n.parts.length;s++)n.parts[s](i.parts[s]);for(;s<i.parts.length;s++)n.parts.push(y(i.parts[s],e))}else{var a=[];for(s=0;s<i.parts.length;s++)a.push(y(i.parts[s],e));o[i.id]={id:i.id,refs:1,parts:a}}}}function f(t,e){for(var r=[],i={},n=0;n<t.length;n++){var o=t[n],s=e.base?o[0]+e.base:o[0],a={css:o[1],media:o[2],sourceMap:o[3]};i[s]?i[s].parts.push(a):r.push(i[s]={id:s,parts:[a]})}return r}function d(t,e){var r=a(t.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var i=u[u.length-1];if("top"===t.insertAt)i?i.nextSibling?r.insertBefore(e,i.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),u.push(e);else if("bottom"===t.insertAt)r.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var n=a(t.insertAt.before,r);r.insertBefore(e,n)}}function g(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=u.indexOf(t);e>=0&&u.splice(e,1)}function v(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var i=function(){0;return r.nc}();i&&(t.attrs.nonce=i)}return m(e,t.attrs),d(t,e),e}function m(t,e){Object.keys(e).forEach(function(r){t.setAttribute(r,e[r])})}function y(t,e){var r,i,n,o;if(e.transform&&t.css){if(!(o="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=o}if(e.singleton){var s=c++;r=l||(l=v(e)),i=x.bind(null,r,s,!1),n=x.bind(null,r,s,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",m(e,t.attrs),d(t,e),e}(e),i=function(t,e,r){var i=r.css,n=r.sourceMap,o=void 0===e.convertToAbsoluteUrls&&n;(e.convertToAbsoluteUrls||o)&&(i=h(i));n&&(i+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var s=new Blob([i],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}.bind(null,r,e),n=function(){g(r),r.href&&URL.revokeObjectURL(r.href)}):(r=v(e),i=function(t,e){var r=e.css,i=e.media;i&&t.setAttribute("media",i);if(t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}.bind(null,r),n=function(){g(r)});return i(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;i(t=e)}else n()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=s()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var r=f(t,e);return p(r,e),function(t){for(var i=[],n=0;n<r.length;n++){var s=r[n];(a=o[s.id]).refs--,i.push(a)}t&&p(f(t,e),e);for(n=0;n<i.length;n++){var a;if(0===(a=i[n]).refs){for(var l=0;l<a.parts.length;l++)a.parts[l]();delete o[a.id]}}}};var b,w=(b=[],function(t,e){return b[t]=e,b.filter(Boolean).join("\n")});function x(t,e,r,i){var n=r?"":i.css;if(t.styleSheet)t.styleSheet.cssText=w(e,n);else{var o=document.createTextNode(n),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var r=e.protocol+"//"+e.host,i=r+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var n,o=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?t:(n=0===o.indexOf("//")?o:0===o.indexOf("/")?r+o:i+o.replace(/^\.\//,""),"url("+JSON.stringify(n)+")")})}},function(t,e,r){!function(t){"use strict";t.defineMode("javascript",function(e,r){var i,n,o=e.indentUnit,s=r.statementIndent,a=r.jsonld,l=r.json||a,c=r.typescript,u=r.wordCharacters||/[\w$\xa1-\uffff]/,h=function(){function t(t){return{type:t,style:"keyword"}}var e=t("keyword a"),r=t("keyword b"),i=t("keyword c"),n=t("keyword d"),o=t("operator"),s={type:"atom",style:"atom"};return{if:t("if"),while:e,with:e,else:r,do:r,try:r,finally:r,return:n,break:n,continue:n,new:t("new"),delete:i,void:i,throw:i,debugger:t("debugger"),var:t("var"),const:t("var"),let:t("var"),function:t("function"),catch:t("catch"),for:t("for"),switch:t("switch"),case:t("case"),default:t("default"),in:o,typeof:o,instanceof:o,true:s,false:s,null:s,undefined:s,NaN:s,Infinity:s,this:t("this"),class:t("class"),super:t("atom"),yield:i,export:t("export"),import:t("import"),extends:i,await:i}}(),p=/[+\-*&%=<>!?|~^@]/,f=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/;function d(t,e,r){return i=t,n=r,e}function g(t,e){var r,i=t.next();if('"'==i||"'"==i)return e.tokenize=(r=i,function(t,e){var i,n=!1;if(a&&"@"==t.peek()&&t.match(f))return e.tokenize=g,d("jsonld-keyword","meta");for(;null!=(i=t.next())&&(i!=r||n);)n=!n&&"\\"==i;return n||(e.tokenize=g),d("string","string")}),e.tokenize(t,e);if("."==i&&t.match(/^\d+(?:[eE][+\-]?\d+)?/))return d("number","number");if("."==i&&t.match(".."))return d("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(i))return d(i);if("="==i&&t.eat(">"))return d("=>","operator");if("0"==i&&t.match(/^(?:x[\da-f]+|o[0-7]+|b[01]+)n?/i))return d("number","number");if(/\d/.test(i))return t.match(/^\d*(?:n|(?:\.\d*)?(?:[eE][+\-]?\d+)?)?/),d("number","number");if("/"==i)return t.eat("*")?(e.tokenize=v,v(t,e)):t.eat("/")?(t.skipToEnd(),d("comment","comment")):qt(t,e,1)?(function(t){for(var e,r=!1,i=!1;null!=(e=t.next());){if(!r){if("/"==e&&!i)return;"["==e?i=!0:i&&"]"==e&&(i=!1)}r=!r&&"\\"==e}}(t),t.match(/^\b(([gimyus])(?![gimyus]*\2))+\b/),d("regexp","string-2")):(t.eat("="),d("operator","operator",t.current()));if("`"==i)return e.tokenize=m,m(t,e);if("#"==i)return t.skipToEnd(),d("error","error");if(p.test(i))return">"==i&&e.lexical&&">"==e.lexical.type||(t.eat("=")?"!"!=i&&"="!=i||t.eat("="):/[<>*+\-]/.test(i)&&(t.eat(i),">"==i&&t.eat(i))),d("operator","operator",t.current());if(u.test(i)){t.eatWhile(u);var n=t.current();if("."!=e.lastType){if(h.propertyIsEnumerable(n)){var o=h[n];return d(o.type,o.style,n)}if("async"==n&&t.match(/^(\s|\/\*.*?\*\/)*[\[\(\w]/,!1))return d("async","keyword",n)}return d("variable","variable",n)}}function v(t,e){for(var r,i=!1;r=t.next();){if("/"==r&&i){e.tokenize=g;break}i="*"==r}return d("comment","comment")}function m(t,e){for(var r,i=!1;null!=(r=t.next());){if(!i&&("`"==r||"$"==r&&t.eat("{"))){e.tokenize=g;break}i=!i&&"\\"==r}return d("quasi","string-2",t.current())}var y="([{}])";function b(t,e){e.fatArrowAt&&(e.fatArrowAt=null);var r=t.string.indexOf("=>",t.start);if(!(r<0)){if(c){var i=/:\s*(?:\w+(?:<[^>]*>|\[\])?|\{[^}]*\})\s*$/.exec(t.string.slice(t.start,r));i&&(r=i.index)}for(var n=0,o=!1,s=r-1;s>=0;--s){var a=t.string.charAt(s),l=y.indexOf(a);if(l>=0&&l<3){if(!n){++s;break}if(0==--n){"("==a&&(o=!0);break}}else if(l>=3&&l<6)++n;else if(u.test(a))o=!0;else{if(/["'\/]/.test(a))return;if(o&&!n){++s;break}}}o&&!n&&(e.fatArrowAt=s)}}var w={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,"jsonld-keyword":!0};function x(t,e,r,i,n,o){this.indented=t,this.column=e,this.type=r,this.prev=n,this.info=o,null!=i&&(this.align=i)}function k(t,e){for(var r=t.localVars;r;r=r.next)if(r.name==e)return!0;for(var i=t.context;i;i=i.prev)for(var r=i.vars;r;r=r.next)if(r.name==e)return!0}var S={state:null,column:null,marked:null,cc:null};function E(){for(var t=arguments.length-1;t>=0;t--)S.cc.push(arguments[t])}function C(){return E.apply(null,arguments),!0}function N(t,e){for(var r=e;r;r=r.next)if(r.name==t)return!0;return!1}function P(t){var e=S.state;if(S.marked="def",e.context)if("var"==e.lexical.info&&e.context&&e.context.block){var i=function t(e,r){if(r){if(r.block){var i=t(e,r.prev);return i?i==r.prev?r:new A(i,r.vars,!0):null}return N(e,r.vars)?r:new A(r.prev,new R(e,r.vars),!1)}return null}(t,e.context);if(null!=i)return void(e.context=i)}else if(!N(t,e.localVars))return void(e.localVars=new R(t,e.localVars));r.globalVars&&!N(t,e.globalVars)&&(e.globalVars=new R(t,e.globalVars))}function T(t){return"public"==t||"private"==t||"protected"==t||"abstract"==t||"readonly"==t}function A(t,e,r){this.prev=t,this.vars=e,this.block=r}function R(t,e){this.name=t,this.next=e}var O=new R("this",new R("arguments",null));function L(){S.state.context=new A(S.state.context,S.state.localVars,!1),S.state.localVars=O}function _(){S.state.context=new A(S.state.context,S.state.localVars,!0),S.state.localVars=null}function M(){S.state.localVars=S.state.context.vars,S.state.context=S.state.context.prev}function I(t,e){var r=function(){var r=S.state,i=r.indented;if("stat"==r.lexical.type)i=r.lexical.indented;else for(var n=r.lexical;n&&")"==n.type&&n.align;n=n.prev)i=n.indented;r.lexical=new x(i,S.stream.column(),t,null,r.lexical,e)};return r.lex=!0,r}function D(){var t=S.state;t.lexical.prev&&(")"==t.lexical.type&&(t.indented=t.lexical.indented),t.lexical=t.lexical.prev)}function F(t){return function e(r){return r==t?C():";"==t||"}"==r||")"==r||"]"==r?E():C(e)}}function B(t,e){return"var"==t?C(I("vardef",e),yt,F(";"),D):"keyword a"==t?C(I("form"),V,B,D):"keyword b"==t?C(I("form"),B,D):"keyword d"==t?S.stream.match(/^\s*$/,!1)?C():C(I("stat"),H,F(";"),D):"debugger"==t?C(F(";")):"{"==t?C(I("}"),_,st,D,M):";"==t?C():"if"==t?("else"==S.state.lexical.info&&S.state.cc[S.state.cc.length-1]==D&&S.state.cc.pop()(),C(I("form"),V,B,D,Et)):"function"==t?C(Tt):"for"==t?C(I("form"),Ct,B,D):"class"==t||c&&"interface"==e?(S.marked="keyword",C(I("form","class"==t?t:e),_t,D)):"variable"==t?c&&"declare"==e?(S.marked="keyword",C(B)):c&&("module"==e||"enum"==e||"type"==e)&&S.stream.match(/^\s*\w/,!1)?(S.marked="keyword","enum"==e?C(Yt):"type"==e?C(Rt,F("operator"),ut,F(";")):C(I("form"),bt,F("{"),I("}"),st,D,D)):c&&"namespace"==e?(S.marked="keyword",C(I("form"),j,B,D)):c&&"abstract"==e?(S.marked="keyword",C(B)):C(I("stat"),Q):"switch"==t?C(I("form"),V,F("{"),I("}","switch"),_,st,D,D,M):"case"==t?C(j,F(":")):"default"==t?C(F(":")):"catch"==t?C(I("form"),L,U,B,D,M):"export"==t?C(I("stat"),Ft,D):"import"==t?C(I("stat"),Ut,D):"async"==t?C(B):"@"==e?C(j,B):E(I("stat"),j,F(";"),D)}function U(t){if("("==t)return C(Ot,F(")"))}function j(t,e){return z(t,e,!1)}function W(t,e){return z(t,e,!0)}function V(t){return"("!=t?E():C(I(")"),j,F(")"),D)}function z(t,e,r){if(S.state.fatArrowAt==S.stream.start){var i=r?$:K;if("("==t)return C(L,I(")"),nt(Ot,")"),D,F("=>"),i,M);if("variable"==t)return E(L,bt,F("=>"),i,M)}var n=r?G:Y;return w.hasOwnProperty(t)?C(n):"function"==t?C(Tt,n):"class"==t||c&&"interface"==e?(S.marked="keyword",C(I("form"),Lt,D)):"keyword c"==t||"async"==t?C(r?W:j):"("==t?C(I(")"),H,F(")"),D,n):"operator"==t||"spread"==t?C(r?W:j):"["==t?C(I("]"),Ht,D,n):"{"==t?ot(et,"}",null,n):"quasi"==t?E(q,n):"new"==t?C(function(t){return function(e){return"."==e?C(t?Z:J):"variable"==e&&c?C(gt,t?G:Y):E(t?W:j)}}(r)):"import"==t?C(j):C()}function H(t){return t.match(/[;\}\)\],]/)?E():E(j)}function Y(t,e){return","==t?C(j):G(t,e,!1)}function G(t,e,r){var i=0==r?Y:G,n=0==r?j:W;return"=>"==t?C(L,r?$:K,M):"operator"==t?/\+\+|--/.test(e)||c&&"!"==e?C(i):c&&"<"==e&&S.stream.match(/^([^>]|<.*?>)*>\s*\(/,!1)?C(I(">"),nt(ut,">"),D,i):"?"==e?C(j,F(":"),n):C(n):"quasi"==t?E(q,i):";"!=t?"("==t?ot(W,")","call",i):"."==t?C(tt,i):"["==t?C(I("]"),H,F("]"),D,i):c&&"as"==e?(S.marked="keyword",C(ut,i)):"regexp"==t?(S.state.lastType=S.marked="operator",S.stream.backUp(S.stream.pos-S.stream.start-1),C(n)):void 0:void 0}function q(t,e){return"quasi"!=t?E():"${"!=e.slice(e.length-2)?C(q):C(j,X)}function X(t){if("}"==t)return S.marked="string-2",S.state.tokenize=m,C(q)}function K(t){return b(S.stream,S.state),E("{"==t?B:j)}function $(t){return b(S.stream,S.state),E("{"==t?B:W)}function J(t,e){if("target"==e)return S.marked="keyword",C(Y)}function Z(t,e){if("target"==e)return S.marked="keyword",C(G)}function Q(t){return":"==t?C(D,B):E(Y,F(";"),D)}function tt(t){if("variable"==t)return S.marked="property",C()}function et(t,e){return"async"==t?(S.marked="property",C(et)):"variable"==t||"keyword"==S.style?(S.marked="property","get"==e||"set"==e?C(rt):(c&&S.state.fatArrowAt==S.stream.start&&(r=S.stream.match(/^\s*:\s*/,!1))&&(S.state.fatArrowAt=S.stream.pos+r[0].length),C(it))):"number"==t||"string"==t?(S.marked=a?"property":S.style+" property",C(it)):"jsonld-keyword"==t?C(it):c&&T(e)?(S.marked="keyword",C(et)):"["==t?C(j,at,F("]"),it):"spread"==t?C(W,it):"*"==e?(S.marked="keyword",C(et)):":"==t?E(it):void 0;var r}function rt(t){return"variable"!=t?E(it):(S.marked="property",C(Tt))}function it(t){return":"==t?C(W):"("==t?E(Tt):void 0}function nt(t,e,r){function i(n,o){if(r?r.indexOf(n)>-1:","==n){var s=S.state.lexical;return"call"==s.info&&(s.pos=(s.pos||0)+1),C(function(r,i){return r==e||i==e?E():E(t)},i)}return n==e||o==e?C():r&&r.indexOf(";")>-1?E(t):C(F(e))}return function(r,n){return r==e||n==e?C():E(t,i)}}function ot(t,e,r){for(var i=3;i<arguments.length;i++)S.cc.push(arguments[i]);return C(I(e,r),nt(t,e),D)}function st(t){return"}"==t?C():E(B,st)}function at(t,e){if(c){if(":"==t||"in"==e)return C(ut);if("?"==e)return C(at)}}function lt(t){if(c&&":"==t)return S.stream.match(/^\s*\w+\s+is\b/,!1)?C(j,ct,ut):C(ut)}function ct(t,e){if("is"==e)return S.marked="keyword",C()}function ut(t,e){return"keyof"==e||"typeof"==e||"infer"==e?(S.marked="keyword",C("typeof"==e?W:ut)):"variable"==t||"void"==e?(S.marked="type",C(dt)):"|"==e||"&"==e?C(ut):"string"==t||"number"==t||"atom"==t?C(dt):"["==t?C(I("]"),nt(ut,"]",","),D,dt):"{"==t?C(I("}"),nt(pt,"}",",;"),D,dt):"("==t?C(nt(ft,")"),ht,dt):"<"==t?C(nt(ut,">"),ut):void 0}function ht(t){if("=>"==t)return C(ut)}function pt(t,e){return"variable"==t||"keyword"==S.style?(S.marked="property",C(pt)):"?"==e||"number"==t||"string"==t?C(pt):":"==t?C(ut):"["==t?C(F("variable"),at,F("]"),pt):"("==t?E(At,pt):void 0}function ft(t,e){return"variable"==t&&S.stream.match(/^\s*[?:]/,!1)||"?"==e?C(ft):":"==t?C(ut):"spread"==t?C(ft):E(ut)}function dt(t,e){return"<"==e?C(I(">"),nt(ut,">"),D,dt):"|"==e||"."==t||"&"==e?C(ut):"["==t?C(ut,F("]"),dt):"extends"==e||"implements"==e?(S.marked="keyword",C(ut)):"?"==e?C(ut,F(":"),ut):void 0}function gt(t,e){if("<"==e)return C(I(">"),nt(ut,">"),D,dt)}function vt(){return E(ut,mt)}function mt(t,e){if("="==e)return C(ut)}function yt(t,e){return"enum"==e?(S.marked="keyword",C(Yt)):E(bt,at,kt,St)}function bt(t,e){return c&&T(e)?(S.marked="keyword",C(bt)):"variable"==t?(P(e),C()):"spread"==t?C(bt):"["==t?ot(xt,"]"):"{"==t?ot(wt,"}"):void 0}function wt(t,e){return"variable"!=t||S.stream.match(/^\s*:/,!1)?("variable"==t&&(S.marked="property"),"spread"==t?C(bt):"}"==t?E():"["==t?C(j,F("]"),F(":"),wt):C(F(":"),bt,kt)):(P(e),C(kt))}function xt(){return E(bt,kt)}function kt(t,e){if("="==e)return C(W)}function St(t){if(","==t)return C(yt)}function Et(t,e){if("keyword b"==t&&"else"==e)return C(I("form","else"),B,D)}function Ct(t,e){return"await"==e?C(Ct):"("==t?C(I(")"),Nt,D):void 0}function Nt(t){return"var"==t?C(yt,Pt):"variable"==t?C(Pt):E(Pt)}function Pt(t,e){return")"==t?C():";"==t?C(Pt):"in"==e||"of"==e?(S.marked="keyword",C(j,Pt)):E(j,Pt)}function Tt(t,e){return"*"==e?(S.marked="keyword",C(Tt)):"variable"==t?(P(e),C(Tt)):"("==t?C(L,I(")"),nt(Ot,")"),D,lt,B,M):c&&"<"==e?C(I(">"),nt(vt,">"),D,Tt):void 0}function At(t,e){return"*"==e?(S.marked="keyword",C(At)):"variable"==t?(P(e),C(At)):"("==t?C(L,I(")"),nt(Ot,")"),D,lt,M):c&&"<"==e?C(I(">"),nt(vt,">"),D,At):void 0}function Rt(t,e){return"keyword"==t||"variable"==t?(S.marked="type",C(Rt)):"<"==e?C(I(">"),nt(vt,">"),D):void 0}function Ot(t,e){return"@"==e&&C(j,Ot),"spread"==t?C(Ot):c&&T(e)?(S.marked="keyword",C(Ot)):c&&"this"==t?C(at,kt):E(bt,at,kt)}function Lt(t,e){return"variable"==t?_t(t,e):Mt(t,e)}function _t(t,e){if("variable"==t)return P(e),C(Mt)}function Mt(t,e){return"<"==e?C(I(">"),nt(vt,">"),D,Mt):"extends"==e||"implements"==e||c&&","==t?("implements"==e&&(S.marked="keyword"),C(c?ut:j,Mt)):"{"==t?C(I("}"),It,D):void 0}function It(t,e){return"async"==t||"variable"==t&&("static"==e||"get"==e||"set"==e||c&&T(e))&&S.stream.match(/^\s+[\w$\xa1-\uffff]/,!1)?(S.marked="keyword",C(It)):"variable"==t||"keyword"==S.style?(S.marked="property",C(c?Dt:Tt,It)):"number"==t||"string"==t?C(c?Dt:Tt,It):"["==t?C(j,at,F("]"),c?Dt:Tt,It):"*"==e?(S.marked="keyword",C(It)):c&&"("==t?E(At,It):";"==t||","==t?C(It):"}"==t?C():"@"==e?C(j,It):void 0}function Dt(t,e){if("?"==e)return C(Dt);if(":"==t)return C(ut,kt);if("="==e)return C(W);var r=S.state.lexical.prev,i=r&&"interface"==r.info;return E(i?At:Tt)}function Ft(t,e){return"*"==e?(S.marked="keyword",C(zt,F(";"))):"default"==e?(S.marked="keyword",C(j,F(";"))):"{"==t?C(nt(Bt,"}"),zt,F(";")):E(B)}function Bt(t,e){return"as"==e?(S.marked="keyword",C(F("variable"))):"variable"==t?E(W,Bt):void 0}function Ut(t){return"string"==t?C():"("==t?E(j):E(jt,Wt,zt)}function jt(t,e){return"{"==t?ot(jt,"}"):("variable"==t&&P(e),"*"==e&&(S.marked="keyword"),C(Vt))}function Wt(t){if(","==t)return C(jt,Wt)}function Vt(t,e){if("as"==e)return S.marked="keyword",C(jt)}function zt(t,e){if("from"==e)return S.marked="keyword",C(j)}function Ht(t){return"]"==t?C():E(nt(W,"]"))}function Yt(){return E(I("form"),bt,F("{"),I("}"),nt(Gt,"}"),D,D)}function Gt(){return E(bt,kt)}function qt(t,e,r){return e.tokenize==g&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\[{}\(,;:]|=>)$/.test(e.lastType)||"quasi"==e.lastType&&/\{\s*$/.test(t.string.slice(0,t.pos-(r||0)))}return M.lex=!0,D.lex=!0,{startState:function(t){var e={tokenize:g,lastType:"sof",cc:[],lexical:new x((t||0)-o,0,"block",!1),localVars:r.localVars,context:r.localVars&&new A(null,null,!1),indented:t||0};return r.globalVars&&"object"==typeof r.globalVars&&(e.globalVars=r.globalVars),e},token:function(t,e){if(t.sol()&&(e.lexical.hasOwnProperty("align")||(e.lexical.align=!1),e.indented=t.indentation(),b(t,e)),e.tokenize!=v&&t.eatSpace())return null;var r=e.tokenize(t,e);return"comment"==i?r:(e.lastType="operator"!=i||"++"!=n&&"--"!=n?i:"incdec",function(t,e,r,i,n){var o=t.cc;for(S.state=t,S.stream=n,S.marked=null,S.cc=o,S.style=e,t.lexical.hasOwnProperty("align")||(t.lexical.align=!0);;){var s=o.length?o.pop():l?j:B;if(s(r,i)){for(;o.length&&o[o.length-1].lex;)o.pop()();return S.marked?S.marked:"variable"==r&&k(t,i)?"variable-2":e}}}(e,r,i,n,t))},indent:function(e,i){if(e.tokenize==v)return t.Pass;if(e.tokenize!=g)return 0;var n,a=i&&i.charAt(0),l=e.lexical;if(!/^\s*else\b/.test(i))for(var c=e.cc.length-1;c>=0;--c){var u=e.cc[c];if(u==D)l=l.prev;else if(u!=Et)break}for(;("stat"==l.type||"form"==l.type)&&("}"==a||(n=e.cc[e.cc.length-1])&&(n==Y||n==G)&&!/^[,\.=+\-*:?[\(]/.test(i));)l=l.prev;s&&")"==l.type&&"stat"==l.prev.type&&(l=l.prev);var h=l.type,f=a==h;return"vardef"==h?l.indented+("operator"==e.lastType||","==e.lastType?l.info.length+1:0):"form"==h&&"{"==a?l.indented:"form"==h?l.indented+o:"stat"==h?l.indented+(function(t,e){return"operator"==t.lastType||","==t.lastType||p.test(e.charAt(0))||/[,.]/.test(e.charAt(0))}(e,i)?s||o:0):"switch"!=l.info||f||0==r.doubleIndentSwitch?l.align?l.column+(f?0:1):l.indented+(f?0:o):l.indented+(/^(?:case|default)\b/.test(i)?o:2*o)},electricInput:/^\s*(?:case .*?:|default:|\{|\})$/,blockCommentStart:l?null:"/*",blockCommentEnd:l?null:"*/",blockCommentContinue:l?null:" * ",lineComment:l?null:"//",fold:"brace",closeBrackets:"()[]{}''\"\"``",helperType:l?"json":"javascript",jsonldMode:a,jsonMode:l,expressionAllowed:qt,skipExpression:function(t){var e=t.cc[t.cc.length-1];e!=j&&e!=W||t.cc.pop()}}}),t.registerHelper("wordChars","javascript",/[\w$]/),t.defineMIME("text/javascript","javascript"),t.defineMIME("text/ecmascript","javascript"),t.defineMIME("application/javascript","javascript"),t.defineMIME("application/x-javascript","javascript"),t.defineMIME("application/ecmascript","javascript"),t.defineMIME("application/json",{name:"javascript",json:!0}),t.defineMIME("application/x-json",{name:"javascript",json:!0}),t.defineMIME("application/ld+json",{name:"javascript",jsonld:!0}),t.defineMIME("text/typescript",{name:"javascript",typescript:!0}),t.defineMIME("application/typescript",{name:"javascript",typescript:!0})}(r(2))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(12),n=r(0),o=r(3),s=r(13),a=r(1),l=function(){function t(t,e){this.currentState=t,this.animation=e}return Object.defineProperty(t.prototype,"node",{get:function(){var t=this.currentState,e=t.node;return"ForStatement"===e.type?1===t.mode_?e=e.test:3===t.mode_&&(e=e.update):"ForInStatement"===e.type?t.isLoop&&(e={type:"ForInUpdate",start:e.left.start,end:e.right.end}):/(Do|While)Statement/.test(e.type)&&t.isLoop?e=e.test:"IfStatement"===e.type?1===t.mode_&&(e=e.test):"SwitchStatement"===e.type?t.switchValue_&&+t.value==+t.switchValue_?e=e.cases[t.index_]:t.test_&&(e=e.discriminant):"TryStatement"===e.type?t.throwValue&&(e=e.handler.param):"ConditionalExpression"===e.type?1===t.mode_?e=e.test:2===t.mode_&&(e=e.test_?e.consequent:e.alternate):"SequenceExpression"===e.type?t.n_&&(e=e.expressions[t.n_-1]):"CallExpression"===e.type&&t.n_&&!t.doneArgs_&&(e=e.arguments[t.n_-1]),e},enumerable:!0,configurable:!0}),t}();e.Instruction=l;var c=50,u=25,h=25,p=25,f=25,d=function(){function t(t){var e,r=this;this.code=t,this.instructionStack=((e=[]).peek=function(){return this[this.length-1]},e),this.init=function(t,e){g("forward",function(t,e){r.animation=new o.Animation(c*t/10,function(r,i){var o=i.position,a=i.facingRadians,l=o.plus(n.Vector2d.polar(a,t*r));return 0===i.height?i.with({position:l,newStrokes:[new s.Stroke(o,l,e)]}):i.with({position:l})})}),g("back",function(t,e){r.animation=new o.Animation(c*t/10,function(r,i){var o=i.position,a=i.facingRadians,l=o.plus(n.Vector2d.polar(a,-t*r));return 0===i.height?i.with({position:l,newStrokes:[new s.Stroke(o,l,e)]}):i.with({position:l})})}),g("right",function(t){r.animation=new o.Animation(u*t/30,function(e,r){return r.with({facing:r.facing-t*e})})}),g("left",function(t){r.animation=new o.Animation(u*t/30,function(e,r){return r.with({facing:r.facing+t*e})})}),g("up",function(){r.animation=new o.Animation(h,function(t,e){return e.with({height:t})})}),g("down",function(){r.animation=new o.Animation(p,function(t,e){return e.with({height:1-t})})}),g("hide",function(){r.animation=new o.Animation(f,function(t,e){return e.with({opacity:1-t})})}),g("show",function(){r.animation=new o.Animation(f,function(t,e){return e.with({opacity:t})})});var i="black";m("foreground",{get:v(function(){return i}),set:v(function(t){i=String(t),r.animation=new o.Animation(0,function(t,e){return e.with({foreground:i})})})});var l="none";function d(t,e,r,i){if(e<r)throw new Error(t+" should be >= "+r+" (was "+e+")");if(e>i)throw new Error(t+" should be <= "+i+" (was "+e+")")}function g(r,i){t.setProperty(e,r,v(i))}function v(e){return t.createNativeFunction(e)}function m(r,i){t.setProperty(e,r,null,i)}m("background",{get:v(function(){return l}),set:v(function(t){l=String(t),r.animation=new o.Animation(0,function(t,e){return e.with({background:l})})})}),g("ask",function(e){a.stop();var r,i=prompt(String(e));return a.start(),r=i,t.createPrimitive(r)}),g("print",function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];document.getElementById("out").innerHTML+=t.join(" ")}),g("println",function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];document.getElementById("out").innerHTML+=t.join("\n")+"\n"}),g("wait",function(t){r.animation=new o.Animation(80*t,function(t,e){return e})}),g("random",function(t,e){if(void 0===t)return Math.random();void 0===e&&(e=t,t=0);var r=e-t;return t+Math.random()*r|0}),g("rgb",function(t,e,r){return d("red",t,0,255),d("green",e,0,255),d("blue",r,0,255),"rgb("+(0|t)+","+(0|e)+","+(0|r)+")"}),g("rgba",function(t,e,r,i){return d("red",t,0,255),d("green",e,0,255),d("blue",r,0,255),d("alpha",i,0,1),"rgba("+(0|t)+","+(0|e)+","+(0|r)+","+i+")"})},this.interpreter=new i(t,this.init)}return t.prototype.reset=function(){this.interpreter=new i(this.interpreter.ast,this.init)},t.prototype.step=function(){var t=this.currentState;try{if(this.interpreter.step())return this.currentState}catch(e){throw e.state=t,e}return null},Object.defineProperty(t.prototype,"currentState",{get:function(){return this.interpreter.stateStack[this.interpreter.stateStack.length-1]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentNode",{get:function(){return this.instructionStack.peek()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentInstruction",{get:function(){var t=new l(this.state,this.animation);return this.animation=null,t},enumerable:!0,configurable:!0}),t.prototype.stepToNextInstruction=function(){t:{for(;this.state=this.step();){var t=this.state.node;if("ForStatement"===t.type){if(t!==this.currentNode){this.instructionStack.push(t);break t}if(1===this.state.mode_)break t;if(3===this.state.mode_)break t;if(2===this.state.mode_){this.state.value&&this.state.value.data||this.instructionStack.pop();break t}}else if("ForInStatement"===t.type){if(!this.state.doneVariable_)break t;if(this.state.isLoop)break t}else if(/(Do|While)Statement/.test(t.type)){if(t!==this.currentNode){this.instructionStack.push(t);break t}if(this.state.isLoop){this.state.value&&this.state.value.data||this.instructionStack.pop();break t}}else if("BlockStatement"===t.type){if(!this.state.n_)break t}else if("IfStatement"===t.type){if(!this.state.mode_){this.instructionStack.push(t);break t}if(1===this.state.mode_){this.state.value.data||this.instructionStack.pop();break t}2===this.state.mode_&&this.instructionStack.pop()}else if("SwitchStatement"===t.type){if(!this.state.switchValue_){if(this.state.test_)break t;break t}if(!this.state.isSwitch&&+this.state.value==+this.state.switchValue_)break t}else if("TryStatement"===t.type){if(this.state.throwValue)break t;if(!this.state.doneBlock_)break t}else if("ConditionalExpression"===t.type){if(!this.state.mode_)break t;if(1===this.state.mode_){t.test_=this.state.value.data,this.instructionStack.push(t);break t}if(2===this.state.mode_){if(this.instructionStack.pop().test_)break t;break t}}else{if("SequenceExpression"===t.type){if(this.state.n_)break t;break t}if("CallExpression"===t.type)if(this.state.doneExec_)this.instructionStack.pop();else{if(this.state.n_)break t;this.state.doneCallee_||this.instructionStack.push(t)}else{if(/(Break|Continue)Statement/.test(t.type))break t;if(/^(?!Function).*(Statement|Declaration)/.test(t.type)){if(t===this.currentNode){this.instructionStack.pop();break t}this.instructionStack.push(t)}}}}return null}return this.currentInstruction},t}();e.Interpreter=d},function(t,e,r){var i;i=function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.i=function(t){return t},r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=8)}([function(t,e,r){"use strict";
/**
 * @license
 * JavaScript Interpreter
 *
 * Copyright 2013 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=r(1),o=r(4),s=function t(e,r){"string"==typeof e&&(e=n.parse(e,t.PARSE_OPTIONS)),this.ast=e,this.initFunc_=r,this.paused_=!1,this.polyfills_=[],this.UNDEFINED=new t.Primitive(void 0,this),this.NULL=new t.Primitive(null,this),this.NAN=new t.Primitive(NaN,this),this.TRUE=new t.Primitive(!0,this),this.FALSE=new t.Primitive(!1,this),this.NUMBER_ZERO=new t.Primitive(0,this),this.NUMBER_ONE=new t.Primitive(1,this),this.STRING_EMPTY=new t.Primitive("",this),this.global=this.createScope(this.ast,null),this.NAN.parent=this.NUMBER,this.TRUE.parent=this.BOOLEAN,this.FALSE.parent=this.BOOLEAN,this.NUMBER_ZERO.parent=this.NUMBER,this.NUMBER_ONE.parent=this.NUMBER,this.STRING_EMPTY.parent=this.STRING,this.ast=n.parse(this.polyfills_.join("\n"),t.PARSE_OPTIONS),this.polyfills_=void 0,this.stripLocations_(this.ast,void 0,void 0),this.stateStack=[{node:this.ast,scope:this.global,thisExpression:this.global,done:!1}],this.run(),this.value=this.UNDEFINED,this.ast=e,this.stateStack=[{node:this.ast,scope:this.global,thisExpression:this.global,done:!1}]};s.PARSE_OPTIONS={ecmaVersion:5},s.READONLY_DESCRIPTOR={configurable:!0,enumerable:!0,writable:!1},s.NONENUMERABLE_DESCRIPTOR={configurable:!0,enumerable:!1,writable:!0},s.READONLY_NONENUMERABLE_DESCRIPTOR={configurable:!0,enumerable:!1,writable:!1},s.prototype.appendCode=function(t){var e=this.stateStack[0];if(!e||"Program"!=e.node.type)throw Error("Expecting original AST to start with a Program node.");if("string"==typeof t&&(t=n.parse(t,s.PARSE_OPTIONS)),!t||"Program"!=t.type)throw Error("Expecting new AST to start with a Program node.");this.populateScope_(t,e.scope);for(var r,i=0;r=t.body[i];i++)e.node.body.push(r);e.done=!1},s.prototype.step=function(){var t=this.stateStack[this.stateStack.length-1];return!(!t||"Program"==t.node.type&&t.done)&&(!!this.paused_||(this["step"+t.node.type](),!!t.node.end||this.step()))},s.prototype.run=function(){for(;!this.paused_&&this.step(););return this.paused_},s.prototype.initGlobalScope=function(t){this.setProperty(t,"Infinity",this.createPrimitive(1/0),s.READONLY_DESCRIPTOR),this.setProperty(t,"NaN",this.NAN,s.READONLY_DESCRIPTOR),this.setProperty(t,"undefined",this.UNDEFINED,s.READONLY_DESCRIPTOR),this.setProperty(t,"window",t,s.READONLY_DESCRIPTOR),this.setProperty(t,"self",t),this.initFunction(t),this.initObject(t),t.parent=this.OBJECT,this.initArray(t),this.initNumber(t),this.initString(t),this.initBoolean(t),this.initDate(t),this.initMath(t),this.initRegExp(t),this.initJSON(t),this.initError(t);var e,r=this;e=function(t){return t=t||r.UNDEFINED,r.createPrimitive(isNaN(t.toNumber()))},this.setProperty(t,"isNaN",this.createNativeFunction(e)),e=function(t){return t=t||r.UNDEFINED,r.createPrimitive(isFinite(t.toNumber()))},this.setProperty(t,"isFinite",this.createNativeFunction(e)),this.setProperty(t,"parseFloat",this.getProperty(this.NUMBER,"parseFloat")),this.setProperty(t,"parseInt",this.getProperty(this.NUMBER,"parseInt"));var i=this.createObject(this.FUNCTION);i.eval=!0,this.setProperty(i,"length",this.NUMBER_ONE,s.READONLY_DESCRIPTOR),this.setProperty(t,"eval",i);for(var n=[[escape,"escape"],[unescape,"unescape"],[decodeURI,"decodeURI"],[decodeURIComponent,"decodeURIComponent"],[encodeURI,"encodeURI"],[encodeURIComponent,"encodeURIComponent"]],o=0;o<n.length;o++)e=function(t){return function(e){e=(e||r.UNDEFINED).toString();try{e=t(e)}catch(t){r.throwException(r.URI_ERROR,t.message)}return r.createPrimitive(e)}}(n[o][0]),this.setProperty(t,n[o][1],this.createNativeFunction(e));this.initFunc_&&this.initFunc_(this,t)},s.prototype.initFunction=function(t){var e,r=this,i=/^[A-Za-z_$][\w$]*$/;e=function(t){if(this.parent==r.FUNCTION)var e=this;else e=r.createObject(r.FUNCTION);if(arguments.length)var o=arguments[arguments.length-1].toString();else o="";for(var a=[],l=0;l<arguments.length-1;l++){var c=arguments[l].toString();if(!c.match(i))return void r.throwException(r.SYNTAX_ERROR,"Invalid function argument: "+c);a.push(c)}a=a.join(", "),e.parentScope=r.stateStack[0].scope;var u=n.parse("$ = function("+a+") {"+o+"};",s.PARSE_OPTIONS);if(1==u.body.length)return e.node=u.body[0].expression.right,r.setProperty(e,"length",r.createPrimitive(e.node.length),s.READONLY_DESCRIPTOR),e;r.throwException(r.SYNTAX_ERROR,"Invalid code in function body.")},this.FUNCTION=this.createObject(null),this.setProperty(t,"Function",this.FUNCTION),this.FUNCTION.type="function",this.setProperty(this.FUNCTION,"prototype",this.createObject(null)),this.FUNCTION.nativeFunc=e;var o=function(t){if(t.isPrimitive&&!r.getScope().strict)if(t==r.UNDEFINED||t==r.NULL)t=r.global;else{var e=r.createObject(t.parent);e.data=t.data,t=e}return t};e=function(t,e){var i=r.stateStack[r.stateStack.length-1];if(i.func_=this,i.funcThis_=o(t),i.arguments_=[],e)if(r.isa(e,r.ARRAY))for(var n=0;n<e.length;n++)i.arguments_[n]=r.getProperty(e,n);else r.throwException(r.TYPE_ERROR,"CreateListFromArrayLike called on non-object");i.doneArgs_=!0,i.doneExec_=!1},this.setNativeFunctionPrototype(this.FUNCTION,"apply",e),e=function(t,e){var i=r.stateStack[r.stateStack.length-1];i.func_=this,i.funcThis_=o(t),i.arguments_=[];for(var n=1;n<arguments.length;n++)i.arguments_.push(arguments[n]);i.doneArgs_=!0,i.doneExec_=!1},this.setNativeFunctionPrototype(this.FUNCTION,"call",e),this.polyfills_.push("Object.defineProperty(Function.prototype, 'bind', {configurable: true, value:","function(oThis) {","if (typeof this !== 'function') {","throw new TypeError('Function.prototype.bind - what is trying to be bound is not callable');","}","var aArgs   = Array.prototype.slice.call(arguments, 1),","fToBind = this,","fNOP    = function() {},","fBound  = function() {","return fToBind.apply(this instanceof fNOP","? this",": oThis,","aArgs.concat(Array.prototype.slice.call(arguments)));","};","if (this.prototype) {","fNOP.prototype = this.prototype;","}","fBound.prototype = new fNOP();","return fBound;","}","});",""),e=function(){return r.createPrimitive(this.toString())},this.setNativeFunctionPrototype(this.FUNCTION,"toString",e),this.setProperty(this.FUNCTION,"toString",this.createNativeFunction(e),s.NONENUMERABLE_DESCRIPTOR),e=function(){return r.createPrimitive(this.valueOf())},this.setNativeFunctionPrototype(this.FUNCTION,"valueOf",e),this.setProperty(this.FUNCTION,"valueOf",this.createNativeFunction(e),s.NONENUMERABLE_DESCRIPTOR)},s.prototype.initObject=function(t){var e,r=this;e=function(t){if(!t||t==r.UNDEFINED||t==r.NULL)return this.parent==r.OBJECT?this:r.createObject(r.OBJECT);if(t.isPrimitive){var e=r.createObject(t.parent);return e.data=t.data,e}return t},this.OBJECT=this.createNativeFunction(e),this.setProperty(t,"Object",this.OBJECT),e=function(t){var e=r.createObject(r.ARRAY),i=0;for(var n in t.properties)r.setProperty(e,i,r.createPrimitive(n)),i++;return e},this.setProperty(this.OBJECT,"getOwnPropertyNames",this.createNativeFunction(e),s.NONENUMERABLE_DESCRIPTOR),e=function(t){var e=r.createObject(r.ARRAY),i=0;for(var n in t.properties)t.notEnumerable[n]||(r.setProperty(e,i,r.createPrimitive(n)),i++);return e},this.setProperty(this.OBJECT,"keys",this.createNativeFunction(e),s.NONENUMERABLE_DESCRIPTOR),e=function(t,e,i){if(e=(e||r.UNDEFINED).toString(),i instanceof s.Object){if(t.properties[e]||!t.preventExtensions){var n=r.getProperty(i,"value");n==r.UNDEFINED&&(n=null);var o=r.getProperty(i,"get"),a=r.getProperty(i,"set"),l={configurable:r.pseudoToNative(r.getProperty(i,"configurable")),enumerable:r.pseudoToNative(r.getProperty(i,"enumerable")),writable:r.pseudoToNative(r.getProperty(i,"writable")),get:o==r.UNDEFINED?void 0:o,set:a==r.UNDEFINED?void 0:a};return r.setProperty(t,e,n,l),t}r.throwException(r.TYPE_ERROR,"Can't define property "+e+", object is not extensible")}else r.throwException(r.TYPE_ERROR,"Property description must be an object.")},this.setProperty(this.OBJECT,"defineProperty",this.createNativeFunction(e),s.NONENUMERABLE_DESCRIPTOR),this.polyfills_.push("Object.defineProperty(Object.prototype, 'defineProperties', {configurable: true, value:","function(obj, props) {","var keys = Object.keys(props);","for (var i = 0; i < keys.length; i++) {","Object.defineProperty(obj, keys[i], props[keys[i]]);","}","return obj;","}","});",""),e=function(t,e){if(!((e=(e||r.UNDEFINED).toString())in t.properties))return r.UNDEFINED;var i=!t.notConfigurable[e],n=!t.notEnumerable[e],o=!t.notWritable[e],s=t.getter[e],a=t.setter[e],l=r.createObject(r.OBJECT);return r.setProperty(l,"configurable",r.createPrimitive(i)),r.setProperty(l,"enumerable",r.createPrimitive(n)),s||a?(r.setProperty(l,"getter",s),r.setProperty(l,"setter",a)):(r.setProperty(l,"writable",r.createPrimitive(o)),r.setProperty(l,"value",r.getProperty(t,e))),l},this.setProperty(this.OBJECT,"getOwnPropertyDescriptor",this.createNativeFunction(e),s.NONENUMERABLE_DESCRIPTOR),e=function(t){return t.parent&&t.parent.properties&&t.parent.properties.prototype?t.parent.properties.prototype:r.NULL},this.setProperty(this.OBJECT,"getPrototypeOf",this.createNativeFunction(e),s.NONENUMERABLE_DESCRIPTOR),e=function(t){return r.createPrimitive(!t.preventExtensions)},this.setProperty(this.OBJECT,"isExtensible",this.createNativeFunction(e),s.NONENUMERABLE_DESCRIPTOR),e=function(t){return t.isPrimitive||(t.preventExtensions=!0),t},this.setProperty(this.OBJECT,"preventExtensions",this.createNativeFunction(e),s.NONENUMERABLE_DESCRIPTOR),e=function(){return r.createPrimitive(this.toString())},this.setNativeFunctionPrototype(this.OBJECT,"toString",e),e=function(){return r.createPrimitive(this.toString())},this.setNativeFunctionPrototype(this.OBJECT,"toLocaleString",e),e=function(){return r.createPrimitive(this.valueOf())},this.setNativeFunctionPrototype(this.OBJECT,"valueOf",e),e=function(t){if(this!=r.NULL&&this!=r.UNDEFINED)return(t=(t||r.UNDEFINED).toString())in this.properties?r.TRUE:r.FALSE;r.throwException(r.TYPE_ERROR,"Cannot convert undefined or null to object")},this.setNativeFunctionPrototype(this.OBJECT,"hasOwnProperty",e),e=function(t){var e=(t=(t||r.UNDEFINED).toString())in this.properties&&!this.notEnumerable[t];return r.createPrimitive(e)},this.setNativeFunctionPrototype(this.OBJECT,"propertyIsEnumerable",e),e=function(t){for(;;){if(!(t.parent&&t.parent.properties&&t.parent.properties.prototype))return r.createPrimitive(!1);if((t=t.parent.properties.prototype)==this)return r.createPrimitive(!0)}},this.setNativeFunctionPrototype(this.OBJECT,"isPrototypeOf",e)},s.prototype.initArray=function(t){var e,r=this,i=function(t,e){var r=t?Math.floor(t.toNumber()):e;return isNaN(r)&&(r=e),r},n=function(t,e){return t.isPrimitive&&e.isPrimitive?t.data===e.data:t===e};e=function(t){if(this.parent==r.ARRAY)var e=this;else e=r.createObject(r.ARRAY);var i=arguments[0];if(1==arguments.length&&"number"==i.type)isNaN(r.arrayIndex(i))&&r.throwException(r.RANGE_ERROR,"Invalid array length"),e.length=i.data;else{for(var n=0;n<arguments.length;n++)e.properties[n]=arguments[n];e.length=n}return e},this.ARRAY=this.createNativeFunction(e),this.setProperty(t,"Array",this.ARRAY),e=function(t){return r.createPrimitive(r.isa(t,r.ARRAY))},this.setProperty(this.ARRAY,"isArray",this.createNativeFunction(e),s.NONENUMERABLE_DESCRIPTOR),e=function(){if(this.length){var t=this.properties[this.length-1];delete this.properties[this.length-1],this.length--}else t=r.UNDEFINED;return t},this.setNativeFunctionPrototype(this.ARRAY,"pop",e),e=function(t){for(var e=0;e<arguments.length;e++)this.properties[this.length]=arguments[e],this.length++;return r.createPrimitive(this.length)},this.setNativeFunctionPrototype(this.ARRAY,"push",e),e=function(){if(this.length){for(var t=this.properties[0],e=1;e<this.length;e++)this.properties[e-1]=this.properties[e];this.length--,delete this.properties[this.length]}else t=r.UNDEFINED;return t},this.setNativeFunctionPrototype(this.ARRAY,"shift",e),e=function(t){for(var e=this.length-1;e>=0;e--)this.properties[e+arguments.length]=this.properties[e];this.length+=arguments.length;for(e=0;e<arguments.length;e++)this.properties[e]=arguments[e];return r.createPrimitive(this.length)},this.setNativeFunctionPrototype(this.ARRAY,"unshift",e),e=function(){for(var t=0;t<this.length/2;t++){var e=this.properties[this.length-t-1];this.properties[this.length-t-1]=this.properties[t],this.properties[t]=e}return this},this.setNativeFunctionPrototype(this.ARRAY,"reverse",e),e=function(t,e,n){t=(t=i(t,0))<0?Math.max(this.length+t,0):Math.min(t,this.length),e=i(e,1/0),e=Math.min(e,this.length-t);for(var o=r.createObject(r.ARRAY),s=t;s<t+e;s++)o.properties[o.length++]=this.properties[s],this.properties[s]=this.properties[s+e];for(s=t+e;s<this.length-e;s++)this.properties[s]=this.properties[s+e];for(s=this.length-e;s<this.length;s++)delete this.properties[s];this.length-=e;for(s=this.length-1;s>=t;s--)this.properties[s+arguments.length-2]=this.properties[s];this.length+=arguments.length-2;for(s=2;s<arguments.length;s++)this.properties[t+s-2]=arguments[s];return o},this.setNativeFunctionPrototype(this.ARRAY,"splice",e),e=function(t,e){var n=r.createObject(r.ARRAY),o=i(t,0);o<0&&(o=this.length+o),o=Math.max(0,Math.min(o,this.length));var s=i(e,this.length);s<0&&(s=this.length+s),s=Math.max(0,Math.min(s,this.length));for(var a=0,l=o;l<s;l++){var c=r.getProperty(this,l);r.setProperty(n,a++,c)}return n},this.setNativeFunctionPrototype(this.ARRAY,"slice",e),e=function(t){if(t&&void 0!==t.data)e=t.toString();else var e=void 0;for(var i=[],n=0;n<this.length;n++)i[n]=this.properties[n];return r.createPrimitive(i.join(e))},this.setNativeFunctionPrototype(this.ARRAY,"join",e),e=function(t){for(var e=r.createObject(r.ARRAY),i=0,n=0;n<this.length;n++){var o=r.getProperty(this,n);r.setProperty(e,i++,o)}for(n=0;n<arguments.length;n++){var s=arguments[n];if(r.isa(s,r.ARRAY))for(var a=0;a<s.length;a++){o=r.getProperty(s,a);r.setProperty(e,i++,o)}else r.setProperty(e,i++,s)}return e},this.setNativeFunctionPrototype(this.ARRAY,"concat",e),e=function(t,e){t=t||r.UNDEFINED;var o=i(e,0);o<0&&(o=this.length+o);for(var s=o=Math.max(0,o);s<this.length;s++){var a=r.getProperty(this,s);if(n(a,t))return r.createPrimitive(s)}return r.createPrimitive(-1)},this.setNativeFunctionPrototype(this.ARRAY,"indexOf",e),e=function(t,e){t=t||r.UNDEFINED;var o=i(e,this.length);o<0&&(o=this.length+o);for(var s=o=Math.min(o,this.length-1);s>=0;s--){var a=r.getProperty(this,s);if(n(a,t))return r.createPrimitive(s)}return r.createPrimitive(-1)},this.setNativeFunctionPrototype(this.ARRAY,"lastIndexOf",e),this.polyfills_.push("Object.defineProperty(Array.prototype, 'every', {configurable: true, value:","function(callbackfn, thisArg) {","if (this == null || typeof callbackfn !== 'function') throw new TypeError;","var T, k;","var O = Object(this);","var len = O.length >>> 0;","if (arguments.length > 1) T = thisArg;","k = 0;","while (k < len) {","if (k in O && !callbackfn.call(T, O[k], k, O)) return false;","k++;","}","return true;","}","});","Object.defineProperty(Array.prototype, 'filter', {configurable: true, value:","function(fun/*, thisArg*/) {","if (this === void 0 || this === null || typeof fun !== 'function') throw new TypeError;","var t = Object(this);","var len = t.length >>> 0;","var res = [];","var thisArg = arguments.length >= 2 ? arguments[1] : void 0;","for (var i = 0; i < len; i++) {","if (i in t) {","var val = t[i];","if (fun.call(thisArg, val, i, t)) res.push(val);","}","}","return res;","}","});","Object.defineProperty(Array.prototype, 'forEach', {configurable: true, value:","function(callback, thisArg) {","if (this == null || typeof callback !== 'function') throw new TypeError;","var T, k;","var O = Object(this);","var len = O.length >>> 0;","if (arguments.length > 1) T = thisArg;","k = 0;","while (k < len) {","if (k in O) callback.call(T, O[k], k, O);","k++;","}","}","});","Object.defineProperty(Array.prototype, 'map', {configurable: true, value:","function(callback, thisArg) {","if (this == null || typeof callback !== 'function') new TypeError;","var T, A, k;","var O = Object(this);","var len = O.length >>> 0;","if (arguments.length > 1) T = thisArg;","A = new Array(len);","k = 0;","while (k < len) {","if (k in O) A[k] = callback.call(T, O[k], k, O);","k++;","}","return A;","}","});","Object.defineProperty(Array.prototype, 'reduce', {configurable: true, value:","function(callback /*, initialValue*/) {","if (this == null || typeof callback !== 'function') throw new TypeError;","var t = Object(this), len = t.length >>> 0, k = 0, value;","if (arguments.length == 2) {","value = arguments[1];","} else {","while (k < len && !(k in t)) k++;","if (k >= len) {","throw new TypeError('Reduce of empty array with no initial value');","}","value = t[k++];","}","for (; k < len; k++) {","if (k in t) value = callback(value, t[k], k, t);","}","return value;","}","});","Object.defineProperty(Array.prototype, 'reduceRight', {configurable: true, value:","function(callback /*, initialValue*/) {","if (null === this || 'undefined' === typeof this || 'function' !== typeof callback) throw new TypeError;","var t = Object(this), len = t.length >>> 0, k = len - 1, value;","if (arguments.length >= 2) {","value = arguments[1];","} else {","while (k >= 0 && !(k in t)) k--;","if (k < 0) {","throw new TypeError('Reduce of empty array with no initial value');","}","value = t[k--];","}","for (; k >= 0; k--) {","if (k in t) value = callback(value, t[k], k, t);","}","return value;","}","});","Object.defineProperty(Array.prototype, 'some', {configurable: true, value:","function(fun/*, thisArg*/) {","if (this == null || typeof fun !== 'function') throw new TypeError;","var t = Object(this);","var len = t.length >>> 0;","var thisArg = arguments.length >= 2 ? arguments[1] : void 0;","for (var i = 0; i < len; i++) {","if (i in t && fun.call(thisArg, t[i], i, t)) {","return true;","}","}","return false;","}","});","Object.defineProperty(Array.prototype, 'sort', {configurable: true, value:","function(opt_comp) {","for (var i = 0; i < this.length; i++) {","var changes = 0;","for (var j = 0; j < this.length - i - 1; j++) {","if (opt_comp ?opt_comp(this[j], this[j + 1]) > 0 : this[j] > this[j + 1]) {","var swap = this[j];","this[j] = this[j + 1];","this[j + 1] = swap;","changes++;","}","}","if (changes <= 1) break;","}","return this;","}","});","Object.defineProperty(Array.prototype, 'toLocaleString', {configurable: true, value:","function() {","var out = [];","for (var i = 0; i < this.length; i++) {","out[i] = (this[i] === null || this[i] === undefined) ? '' : this[i].toLocaleString();","}","return out.join(',');","}","});","")},s.prototype.initNumber=function(t){var e,r=this;e=function(t){return t=t?t.toNumber():0,this.parent!=r.NUMBER?r.createPrimitive(t):(this.data=t,this)},this.NUMBER=this.createNativeFunction(e),this.setProperty(t,"Number",this.NUMBER);for(var i=["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"],n=0;n<i.length;n++)this.setProperty(this.NUMBER,i[n],this.createPrimitive(Number[i[n]]));e=function(t){return t=t||r.UNDEFINED,r.createPrimitive(parseFloat(t.toString()))},this.setProperty(this.NUMBER,"parseFloat",this.createNativeFunction(e)),e=function(t,e){return t=t||r.UNDEFINED,e=e||r.UNDEFINED,r.createPrimitive(parseInt(t.toString(),e.toNumber()))},this.setProperty(this.NUMBER,"parseInt",this.createNativeFunction(e)),e=function(t){t=t?t.toNumber():void 0;var e=this.toNumber();return r.createPrimitive(e.toExponential(t))},this.setNativeFunctionPrototype(this.NUMBER,"toExponential",e),e=function(t){t=t?t.toNumber():void 0;var e=this.toNumber();return r.createPrimitive(e.toFixed(t))},this.setNativeFunctionPrototype(this.NUMBER,"toFixed",e),e=function(t){t=t?t.toNumber():void 0;var e=this.toNumber();return r.createPrimitive(e.toPrecision(t))},this.setNativeFunctionPrototype(this.NUMBER,"toPrecision",e),e=function(t){t=t?t.toNumber():10;var e=this.toNumber();return r.createPrimitive(e.toString(t))},this.setNativeFunctionPrototype(this.NUMBER,"toString",e),e=function(t,e){return t=t?r.pseudoToNative(t):void 0,e=e?r.pseudoToNative(e):void 0,r.createPrimitive(this.toNumber().toLocaleString(t,e))},this.setNativeFunctionPrototype(this.NUMBER,"toLocaleString",e)},s.prototype.initString=function(t){var e,r=this;e=function(t){return t=t?t.toString():"",this.parent!=r.STRING?r.createPrimitive(t):(this.data=t,this)},this.STRING=this.createNativeFunction(e),this.setProperty(t,"String",this.STRING),e=function(t){for(var e=0;e<arguments.length;e++)arguments[e]=arguments[e].toNumber();return r.createPrimitive(String.fromCharCode.apply(String,arguments))},this.setProperty(this.STRING,"fromCharCode",this.createNativeFunction(e),s.NONENUMERABLE_DESCRIPTOR);for(var i=["toLowerCase","toUpperCase","toLocaleLowerCase","toLocaleUpperCase"],n=0;n<i.length;n++)e=function(t){return function(){return r.createPrimitive(t.apply(this))}}(String.prototype[i[n]]),this.setNativeFunctionPrototype(this.STRING,i[n],e);e=function(){var t=this.toString();return r.createPrimitive(t.replace(/^\s+|\s+$/g,""))},this.setNativeFunctionPrototype(this.STRING,"trim",e),e=function(){var t=this.toString();return r.createPrimitive(t.replace(/^\s+/g,""))},this.setNativeFunctionPrototype(this.STRING,"trimLeft",e),e=function(){var t=this.toString();return r.createPrimitive(t.replace(/\s+$/g,""))},this.setNativeFunctionPrototype(this.STRING,"trimRight",e),i=["charAt","charCodeAt","substring","slice","substr"];for(n=0;n<i.length;n++)e=function(t){return function(){for(var e=0;e<arguments.length;e++)arguments[e]=arguments[e].toNumber();return r.createPrimitive(t.apply(this,arguments))}}(String.prototype[i[n]]),this.setNativeFunctionPrototype(this.STRING,i[n],e);e=function(t,e){var i=this.toString();return t=(t||r.UNDEFINED).toString(),e=e?e.toNumber():void 0,r.createPrimitive(i.indexOf(t,e))},this.setNativeFunctionPrototype(this.STRING,"indexOf",e),e=function(t,e){var i=this.toString();return t=(t||r.UNDEFINED).toString(),e=e?e.toNumber():void 0,r.createPrimitive(i.lastIndexOf(t,e))},this.setNativeFunctionPrototype(this.STRING,"lastIndexOf",e),e=function(t,e,i){return t=(t||r.UNDEFINED).toString(),e=e?r.pseudoToNative(e):void 0,i=i?r.pseudoToNative(i):void 0,r.createPrimitive(this.toString().localeCompare(t,e,i))},this.setNativeFunctionPrototype(this.STRING,"localeCompare",e),e=function(t,e){var i=this.toString();t=t?r.isa(t,r.REGEXP)?t.data:t.toString():void 0,e=e?e.toNumber():void 0;for(var n=i.split(t,e),o=r.createObject(r.ARRAY),s=0;s<n.length;s++)r.setProperty(o,s,r.createPrimitive(n[s]));return o},this.setNativeFunctionPrototype(this.STRING,"split",e),e=function(t){for(var e=this.toString(),i=0;i<arguments.length;i++)e+=arguments[i].toString();return r.createPrimitive(e)},this.setNativeFunctionPrototype(this.STRING,"concat",e),e=function(t){var e=this.toString();t=t?t.data:void 0;var i=e.match(t);if(null===i)return r.NULL;for(var n=r.createObject(r.ARRAY),o=0;o<i.length;o++)r.setProperty(n,o,r.createPrimitive(i[o]));return n},this.setNativeFunctionPrototype(this.STRING,"match",e),e=function(t){var e=this.toString();return t=t?t.data:void 0,r.createPrimitive(e.search(t))},this.setNativeFunctionPrototype(this.STRING,"search",e),e=function(t,e){var i=this.toString();return t=(t||r.UNDEFINED).valueOf(),e=(e||r.UNDEFINED).toString(),r.createPrimitive(i.replace(t,e))},this.setNativeFunctionPrototype(this.STRING,"replace",e)},s.prototype.initBoolean=function(t){var e,r=this;e=function(t){return t=!!t&&t.toBoolean(),this.parent!=r.BOOLEAN?r.createPrimitive(t):(this.data=t,this)},this.BOOLEAN=this.createNativeFunction(e),this.setProperty(t,"Boolean",this.BOOLEAN)},s.prototype.initDate=function(t){var e,r=this;e=function(t,e,i,n,o,s,a){if(this.parent!=r.DATE)return r.createPrimitive(Date());var l=this;if(arguments.length)if(1!=arguments.length||"string"!=t.type&&!r.isa(t,r.STRING)){for(var c=[null],u=0;u<arguments.length;u++)c[u+1]=arguments[u]?arguments[u].toNumber():void 0;l.data=new(Function.prototype.bind.apply(Date,c))}else l.data=new Date(t.toString());else l.data=new Date;return l},this.DATE=this.createNativeFunction(e),this.setProperty(t,"Date",this.DATE),e=function(){return r.createPrimitive((new Date).getTime())},this.setProperty(this.DATE,"now",this.createNativeFunction(e),s.NONENUMERABLE_DESCRIPTOR),e=function(t){return t=t?t.toString():void 0,r.createPrimitive(Date.parse(t))},this.setProperty(this.DATE,"parse",this.createNativeFunction(e),s.NONENUMERABLE_DESCRIPTOR),e=function(t,e,i,n,o,s,a){for(var l=[],c=0;c<arguments.length;c++)l[c]=arguments[c]?arguments[c].toNumber():void 0;return r.createPrimitive(Date.UTC.apply(Date,l))},this.setProperty(this.DATE,"UTC",this.createNativeFunction(e),s.NONENUMERABLE_DESCRIPTOR);for(var i=["getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear","toDateString","toISOString","toJSON","toGMTString","toLocaleDateString","toLocaleString","toLocaleTimeString","toTimeString","toUTCString"],n=0;n<i.length;n++)e=function(t){return function(e){for(var i=[],n=0;n<arguments.length;n++)i[n]=r.pseudoToNative(arguments[n]);return r.createPrimitive(this.data[t].apply(this.data,i))}}(i[n]),this.setNativeFunctionPrototype(this.DATE,i[n],e)},s.prototype.initMath=function(t){var e=this,r=this.createObject(this.OBJECT);this.setProperty(t,"Math",r);for(var i=["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],n=0;n<i.length;n++)this.setProperty(r,i[n],this.createPrimitive(Math[i[n]]),s.READONLY_NONENUMERABLE_DESCRIPTOR);var o=["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","random","round","sin","sqrt","tan"];for(n=0;n<o.length;n++){var a=function(t){return function(){for(var r=0;r<arguments.length;r++)arguments[r]=arguments[r].toNumber();return e.createPrimitive(t.apply(Math,arguments))}}(Math[o[n]]);this.setProperty(r,o[n],this.createNativeFunction(a),s.NONENUMERABLE_DESCRIPTOR)}},s.prototype.initRegExp=function(t){var e,r=this;e=function(t,e){if(this.parent==r.REGEXP)var i=this;else i=r.createObject(r.REGEXP);return t=t?t.toString():"",e=e?e.toString():"",r.populateRegExp_(i,new RegExp(t,e))},this.REGEXP=this.createNativeFunction(e),this.setProperty(t,"RegExp",this.REGEXP),this.setProperty(this.REGEXP.properties.prototype,"global",this.UNDEFINED,s.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"ignoreCase",this.UNDEFINED,s.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"multiline",this.UNDEFINED,s.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(this.REGEXP.properties.prototype,"source",this.createPrimitive("(?:)"),s.READONLY_NONENUMERABLE_DESCRIPTOR),e=function(t){return t=t.toString(),r.createPrimitive(this.data.test(t))},this.setNativeFunctionPrototype(this.REGEXP,"test",e),e=function(t){t=t.toString(),this.data.lastIndex=r.getProperty(this,"lastIndex").toNumber();var e=this.data.exec(t);if(r.setProperty(this,"lastIndex",r.createPrimitive(this.data.lastIndex)),e){for(var i=r.createObject(r.ARRAY),n=0;n<e.length;n++)r.setProperty(i,n,r.createPrimitive(e[n]));return r.setProperty(i,"index",r.createPrimitive(e.index)),r.setProperty(i,"input",r.createPrimitive(e.input)),i}return r.NULL},this.setNativeFunctionPrototype(this.REGEXP,"exec",e)},s.prototype.initJSON=function(t){var e=this,r=e.createObject(this.OBJECT);this.setProperty(t,"JSON",r);var i=function(t){try{var r=JSON.parse(t.toString())}catch(t){return void e.throwException(e.SYNTAX_ERROR,t.message)}return e.nativeToPseudo(r)};this.setProperty(r,"parse",this.createNativeFunction(i)),i=function(t){var r=e.pseudoToNative(t);return e.createPrimitive(JSON.stringify(r))},this.setProperty(r,"stringify",this.createNativeFunction(i))},s.prototype.initError=function(t){var e=this;this.ERROR=this.createNativeFunction(function(t){if(this.parent==e.ERROR)var r=this;else r=e.createObject(e.ERROR);return t&&e.setProperty(r,"message",e.createPrimitive(String(t)),s.NONENUMERABLE_DESCRIPTOR),r}),this.setProperty(t,"Error",this.ERROR),this.setProperty(this.ERROR.properties.prototype,"message",this.STRING_EMPTY,s.NONENUMERABLE_DESCRIPTOR),this.setProperty(this.ERROR.properties.prototype,"name",this.createPrimitive("Error"),s.NONENUMERABLE_DESCRIPTOR);var r=function(r){var i=e.createNativeFunction(function(t){if(e.isa(this.parent,e.ERROR))var r=this;else r=e.createObject(i);return t&&e.setProperty(r,"message",e.createPrimitive(String(t)),s.NONENUMERABLE_DESCRIPTOR),r});return e.setProperty(i,"prototype",e.createObject(e.ERROR)),e.setProperty(i.properties.prototype,"name",e.createPrimitive(r),s.NONENUMERABLE_DESCRIPTOR),e.setProperty(t,r,i),i};this.EVAL_ERROR=r("EvalError"),this.RANGE_ERROR=r("RangeError"),this.REFERENCE_ERROR=r("ReferenceError"),this.SYNTAX_ERROR=r("SyntaxError"),this.TYPE_ERROR=r("TypeError"),this.URI_ERROR=r("URIError")},s.prototype.isa=function(t,e){if(!t||!e)return!1;for(;t.parent!=e;){if(!t.parent||!t.parent.properties.prototype)return!1;t=t.parent.properties.prototype}return!0},s.prototype.comp=function(t,e){if(t.isPrimitive&&"number"==typeof t.data&&isNaN(t.data)||e.isPrimitive&&"number"==typeof e.data&&isNaN(e.data))return NaN;if(t===e)return 0;var r=t.isPrimitive?t.data:t.toString(),i=e.isPrimitive?e.data:e.toString();return r<i?-1:r>i?1:(t.isPrimitive||e.isPrimitive)&&r==i?0:NaN},s.prototype.arrayIndex=function(t){return t=Number(t),!isFinite(t)||t!=Math.floor(t)||t<0||t>=Math.pow(2,32)?NaN:t},(s.Primitive=function(t,e){var r=void 0===t?"undefined":i(t);this.data=t,this.type=r,"number"==r?this.parent=e.NUMBER:"string"==r?this.parent=e.STRING:"boolean"==r&&(this.parent=e.BOOLEAN)}).prototype.data=void 0,s.Primitive.prototype.type="undefined",s.Primitive.prototype.parent=null,s.Primitive.prototype.isPrimitive=!0,s.Primitive.prototype.toBoolean=function(){return Boolean(this.data)},s.Primitive.prototype.toNumber=function(){return Number(this.data)},s.Primitive.prototype.toString=function(){return String(this.data)},s.Primitive.prototype.valueOf=function(){return this.data},s.prototype.createPrimitive=function(t){return void 0===t?this.UNDEFINED:null===t?this.NULL:!0===t?this.TRUE:!1===t?this.FALSE:0===t?this.NUMBER_ZERO:1===t?this.NUMBER_ONE:""===t?this.STRING_EMPTY:t instanceof RegExp?this.populateRegExp_(this.createObject(this.REGEXP),t):new s.Primitive(t,this)},(s.Object=function(t){this.notConfigurable=Object.create(null),this.notEnumerable=Object.create(null),this.notWritable=Object.create(null),this.getter=Object.create(null),this.setter=Object.create(null),this.properties=Object.create(null),this.parent=t}).prototype.type="object",s.Object.prototype.parent=null,s.Object.prototype.isPrimitive=!1,s.Object.prototype.data=void 0,s.Object.prototype.toBoolean=function(){return!0},s.Object.prototype.toNumber=function(){return Number(void 0===this.data?this.toString():this.data)},s.Object.prototype.toString=function(){return void 0===this.data?"["+this.type+"]":String(this.data)},s.Object.prototype.valueOf=function(){return void 0===this.data?this:this.data},s.prototype.createObject=function(t){var e=new s.Object(t);if(this.isa(e,this.FUNCTION)&&(e.type="function",this.setProperty(e,"prototype",this.createObject(this.OBJECT||null))),this.isa(e,this.ARRAY)&&(e.length=0,e.toString=function(){for(var t=[],e=0;e<this.length;e++){var r=this.properties[e];t[e]=!r||r.isPrimitive&&(null===r.data||void 0===r.data)?"":r.toString()}return t.join(",")}),this.isa(e,this.ERROR)){var r=this;e.toString=function(){var t=r.getProperty(this,"name").toString(),e=r.getProperty(this,"message").toString();return e?t+": "+e:t}}return e},s.prototype.populateRegExp_=function(t,e){return t.data=e,this.setProperty(t,"lastIndex",this.createPrimitive(e.lastIndex),s.NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"source",this.createPrimitive(e.source),s.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"global",this.createPrimitive(e.global),s.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"ignoreCase",this.createPrimitive(e.ignoreCase),s.READONLY_NONENUMERABLE_DESCRIPTOR),this.setProperty(t,"multiline",this.createPrimitive(e.multiline),s.READONLY_NONENUMERABLE_DESCRIPTOR),t.toString=function(){return String(this.data)},t.valueOf=function(){return this.data},t},s.prototype.createFunction=function(t,e){var r=this.createObject(this.FUNCTION);return r.parentScope=e,r.node=t,this.setProperty(r,"length",this.createPrimitive(r.node.params.length),s.READONLY_DESCRIPTOR),r},s.prototype.createNativeFunction=function(t){var e=this.createObject(this.FUNCTION);return e.nativeFunc=t,this.setProperty(e,"length",this.createPrimitive(t.length),s.READONLY_DESCRIPTOR),e},s.prototype.createAsyncFunction=function(t){var e=this.createObject(this.FUNCTION);return e.asyncFunc=t,this.setProperty(e,"length",this.createPrimitive(t.length),s.READONLY_DESCRIPTOR),e},s.prototype.nativeToPseudo=function(t){if("boolean"==typeof t||"number"==typeof t||"string"==typeof t||null==t||t instanceof RegExp)return this.createPrimitive(t);if(t instanceof Function){var e=this;return this.createNativeFunction(function(){return e.nativeToPseudo(t.apply(e,Array.prototype.slice.call(arguments).map(function(t){return e.pseudoToNative(t)})))})}var r;if(t instanceof Array){r=this.createObject(this.ARRAY);for(var i=0;i<t.length;i++)this.setProperty(r,i,this.nativeToPseudo(t[i]))}else for(var n in r=this.createObject(this.OBJECT),t)this.setProperty(r,n,this.nativeToPseudo(t[n]));return r},s.prototype.pseudoToNative=function(t){if(t.isPrimitive||this.isa(t,this.NUMBER)||this.isa(t,this.STRING)||this.isa(t,this.BOOLEAN))return t.data;var e;if(this.isa(t,this.ARRAY)){e=[];for(var r=0;r<t.length;r++)e[r]=this.pseudoToNative(t.properties[r])}else for(var i in e={},t.properties)e[i]=this.pseudoToNative(t.properties[i]);return e},s.prototype.getProperty=function(t,e){if(e=e.toString(),t==this.UNDEFINED||t==this.NULL)return this.throwException(this.TYPE_ERROR,"Cannot read property '"+e+"' of "+t),null;if(this.isa(t,this.STRING)){if("length"==e)return this.createPrimitive(t.data.length);var r=this.arrayIndex(e);if(!isNaN(r)&&r<t.data.length)return this.createPrimitive(t.data[r])}else if(this.isa(t,this.ARRAY)&&"length"==e)return this.createPrimitive(t.length);for(;;){if(t.properties&&e in t.properties){var i=t.getter[e];return i?(i.isGetter=!0,i):t.properties[e]}if(!(t.parent&&t.parent.properties&&t.parent.properties.prototype))break;t=t.parent.properties.prototype}return this.UNDEFINED},s.prototype.hasProperty=function(t,e){if(e=e.toString(),t.isPrimitive)throw TypeError("Primitive data type has no properties");if("length"==e&&(this.isa(t,this.STRING)||this.isa(t,this.ARRAY)))return!0;if(this.isa(t,this.STRING)){var r=this.arrayIndex(e);if(!isNaN(r)&&r<t.data.length)return!0}for(;;){if(t.properties&&e in t.properties)return!0;if(!(t.parent&&t.parent.properties&&t.parent.properties.prototype))break;t=t.parent.properties.prototype}return!1},s.prototype.setProperty=function(t,e,r,n){if(e=e.toString(),n&&t.notConfigurable[e]&&this.throwException(this.TYPE_ERROR,"Cannot redefine property: "+e),"object"!=(void 0===r?"undefined":i(r)))throw Error("Failure to wrap a value: "+r);t!=this.UNDEFINED&&t!=this.NULL||this.throwException(this.TYPE_ERROR,"Cannot set property '"+e+"' of "+t),n&&(n.get||n.set)&&(r||void 0!==n.writable)&&this.throwException(this.TYPE_ERROR,"Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");var o=!this.stateStack||this.getScope().strict;if(t.isPrimitive)o&&this.throwException(this.TYPE_ERROR,"Can't create property '"+e+"' on '"+t.data+"'");else{if(this.isa(t,this.STRING)){var s=this.arrayIndex(e);if("length"==e||!isNaN(s)&&s<t.data.length)return void(o&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only property '"+e+"' of String '"+t.data+"'"))}if(this.isa(t,this.ARRAY)){var a;if("length"==e){var l=this.arrayIndex(r.toNumber());if(isNaN(l)&&this.throwException(this.RANGE_ERROR,"Invalid array length"),l<t.length)for(a in t.properties)a=this.arrayIndex(a),!isNaN(a)&&l<=a&&delete t.properties[a];return void(t.length=l)}isNaN(a=this.arrayIndex(e))||(t.length=Math.max(t.length,a+1))}if(t.properties[e]||!t.preventExtensions)if(n){t.properties[e]=r,n.configurable||(t.notConfigurable[e]=!0);var c=n.get;c?t.getter[e]=c:delete t.getter[e];var u=n.set;if(u?t.setter[e]=u:delete t.setter[e],n.enumerable||!1?delete t.notEnumerable[e]:t.notEnumerable[e]=!0,c||u)delete t.notWritable[e],t.properties[e]=this.UNDEFINED;else n.writable||!1?delete t.notWritable[e]:t.notWritable[e]=!0}else{for(var h=t;;){if(h.setter&&h.setter[e])return h.setter[e];if(!(h.parent&&h.parent.properties&&h.parent.properties.prototype))break;h=h.parent.properties.prototype}t.getter&&t.getter[e]?o&&this.throwException(this.TYPE_ERROR,"Cannot set property '"+e+"' of object '"+t+"' which only has a getter"):t.notWritable[e]?o&&this.throwException(this.TYPE_ERROR,"Cannot assign to read only property '"+e+"' of object '"+t+"'"):t.properties[e]=r}else o&&this.throwException(this.TYPE_ERROR,"Can't add property "+e+", object is not extensible")}},s.prototype.setNativeFunctionPrototype=function(t,e,r){this.setProperty(t.properties.prototype,e,this.createNativeFunction(r),s.NONENUMERABLE_DESCRIPTOR)},s.prototype.deleteProperty=function(t,e){return e=e.toString(),!t.isPrimitive&&!t.notWritable[e]&&(("length"!=e||!this.isa(t,this.ARRAY))&&delete t.properties[e])},s.prototype.getScope=function(){for(var t=this.stateStack.length-1;t>=0;t--)if(this.stateStack[t].scope)return this.stateStack[t].scope;throw Error("No scope found.")},s.prototype.createScope=function(t,e){var r=this.createObject(null);if(r.parentScope=e,e||this.initGlobalScope(r),this.populateScope_(t,r),r.strict=!1,e&&e.strict)r.strict=!0;else{var i=t.body&&t.body[0];i&&i.expression&&"Literal"==i.expression.type&&"use strict"==i.expression.value&&(r.strict=!0)}return r},s.prototype.createSpecialScope=function(t,e){if(!t)throw Error("parentScope required");var r=e||this.createObject(null);return r.parentScope=t,r.strict=t.strict,r},s.prototype.getValueFromScope=function(t){for(var e=this.getScope(),r=t.toString();e&&e!=this.global;){if(r in e.properties)return e.properties[r];e=e.parentScope}if(e==this.global&&this.hasProperty(e,r))return this.getProperty(e,r);var i=this.stateStack[this.stateStack.length-1].node;return"UnaryExpression"==i.type&&"typeof"==i.operator?this.UNDEFINED:(this.throwException(this.REFERENCE_ERROR,r+" is not defined"),null)},s.prototype.setValueToScope=function(t,e){for(var r=this.getScope(),i=t.toString();r&&r!=this.global;){if(i in r.properties)return void(r.properties[i]=e);r=r.parentScope}if(r==this.global&&(!r.strict||this.hasProperty(r,i)))return this.setProperty(r,i,e);this.throwException(this.REFERENCE_ERROR,i+" is not defined")},s.prototype.populateScope_=function(t,e){if("VariableDeclaration"==t.type)for(var r=0;r<t.declarations.length;r++)this.setProperty(e,t.declarations[r].id.name,this.UNDEFINED);else{if("FunctionDeclaration"==t.type)return void this.setProperty(e,t.id.name,this.createFunction(t,e));if("FunctionExpression"==t.type)return;if("ExpressionStatement"==t.type)return}var n=t.constructor;for(var o in t){var s=t[o];if(s&&"object"==(void 0===s?"undefined":i(s)))if(s instanceof Array)for(r=0;r<s.length;r++)s[r]&&s[r].constructor==n&&this.populateScope_(s[r],e);else s.constructor==n&&this.populateScope_(s,e)}},s.prototype.stripLocations_=function(t,e,r){for(var n in e?t.start=e:delete t.start,r?t.end=r:delete t.end,t)if(t.hasOwnProperty(n)){var o=t[n];o&&"object"==(void 0===o?"undefined":i(o))&&this.stripLocations_(o,e,r)}},s.prototype.getValue=function(t){if(t instanceof Array){var e=t[0],r=t[1];return this.getProperty(e,r)}return this.getValueFromScope(t)},s.prototype.setValue=function(t,e){if(t instanceof Array){var r=t[0],i=t[1];return this.setProperty(r,i,e)}return this.setValueToScope(t,e)},s.prototype.throwException=function(t,e){if(void 0===e)var r=t;else{r=this.createObject(t);this.setProperty(r,"message",this.createPrimitive(e),s.NONENUMERABLE_DESCRIPTOR)}this.executeException(r)},s.prototype.executeException=function(t){do{this.stateStack.pop();var e=this.stateStack[this.stateStack.length-1];if("TryStatement"==e.node.type)return void(e.throwValue=t)}while(e&&"Program"!=e.node.type);var r;if(this.isa(t,this.ERROR)){var i={EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError},n=this.getProperty(t,"name").toString(),o=this.getProperty(t,"message").valueOf();r=(i[n]||Error)(o)}else r=t.toString();throw r},s.prototype.pushGetter_=function(t,e){var r=e instanceof Array?e[0]:e;this.stateStack.push({node:{type:"CallExpression"},doneCallee_:!0,funcThis_:r,func_:t,doneArgs_:!0,arguments_:[]})},s.prototype.pushSetter_=function(t,e,r){var i=e instanceof Array?e[0]:this.global;this.stateStack.push({node:{type:"CallExpression"},doneCallee_:!0,funcThis_:i,func_:t,doneArgs_:!0,arguments_:[r]})},s.prototype.takeStateSnapshot=function(){var t=o(this.stateStack,void 0,void 0,void 0,!0);return this.global=t[0].scope,t},s.prototype.restoreStateSnapshot=function(t){this.stateStack=o(t,void 0,void 0,void 0,!0),this.global=this.stateStack[0].scope,this.initFunc_(this,this.global)},s.prototype.stepArrayExpression=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node,r=t.n_||0;t.array_?t.value&&this.setProperty(t.array_,r-1,t.value):t.array_=this.createObject(this.ARRAY),r<e.elements.length?(t.n_=r+1,e.elements[r]?this.stateStack.push({node:e.elements[r]}):t.value=void 0):(t.array_.length=t.n_||0,this.stateStack.pop(),this.stateStack[this.stateStack.length-1].value=t.array_)},s.prototype.stepAssignmentExpression=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node;if(!t.doneLeft_)return t.doneLeft_=!0,void this.stateStack.push({node:e.left,components:!0});if(!t.doneRight_){if(t.leftSide_||(t.leftSide_=t.value),t.doneGetter_&&(t.leftValue_=t.value),!t.doneGetter_&&"="!=e.operator&&(t.leftValue_=this.getValue(t.leftSide_),t.leftValue_.isGetter)){t.leftValue_.isGetter=!1,t.doneGetter_=!0;var r=t.leftValue_;return void this.pushGetter_(r,t.leftSide_)}return t.doneRight_=!0,void this.stateStack.push({node:e.right})}if(t.doneSetter_)return this.stateStack.pop(),void(this.stateStack[this.stateStack.length-1].value=t.doneSetter_);var i,n=t.value;if("="==e.operator)i=n;else{var o,s,a=n,l=t.leftValue_.toNumber(),c=a.toNumber();if("+="==e.operator)"string"==t.leftValue_.type||"string"==a.type?(o=t.leftValue_.toString(),s=a.toString()):(o=l,s=c),i=o+s;else if("-="==e.operator)i=l-c;else if("*="==e.operator)i=l*c;else if("/="==e.operator)i=l/c;else if("%="==e.operator)i=l%c;else if("<<="==e.operator)i=l<<c;else if(">>="==e.operator)i=l>>c;else if(">>>="==e.operator)i=l>>>c;else if("&="==e.operator)i=l&c;else if("^="==e.operator)i=l^c;else{if("|="!=e.operator)throw SyntaxError("Unknown assignment expression: "+e.operator);i=l|c}i=this.createPrimitive(i)}var u=this.setValue(t.leftSide_,i);if(u)return t.doneSetter_=i,void this.pushSetter_(u,t.leftSide_,i);this.stateStack.pop(),this.stateStack[this.stateStack.length-1].value=i},s.prototype.stepBinaryExpression=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node;if(!t.doneLeft_)return t.doneLeft_=!0,void this.stateStack.push({node:e.left});if(!t.doneRight_)return t.doneRight_=!0,t.leftValue_=t.value,void this.stateStack.push({node:e.right});this.stateStack.pop();var r,i=t.leftValue_,n=t.value,o=this.comp(i,n);if("=="==e.operator||"!="==e.operator)r=i.isPrimitive&&n.isPrimitive?i.data==n.data:0===o,"!="==e.operator&&(r=!r);else if("==="==e.operator||"!=="==e.operator)r=i.isPrimitive&&n.isPrimitive?i.data===n.data:i===n,"!=="==e.operator&&(r=!r);else if(">"==e.operator)r=1==o;else if(">="==e.operator)r=1==o||0===o;else if("<"==e.operator)r=-1==o;else if("<="==e.operator)r=-1==o||0===o;else if("+"==e.operator){r=(s=i.isPrimitive?i.data:i.toString())+(a=n.isPrimitive?n.data:n.toString())}else if("in"==e.operator)r=this.hasProperty(n,i);else if("instanceof"==e.operator)this.isa(n,this.FUNCTION)||this.throwException(this.TYPE_ERROR,"Expecting a function in instanceof check"),r=this.isa(i,n);else{var s=i.toNumber(),a=n.toNumber();if("-"==e.operator)r=s-a;else if("*"==e.operator)r=s*a;else if("/"==e.operator)r=s/a;else if("%"==e.operator)r=s%a;else if("&"==e.operator)r=s&a;else if("|"==e.operator)r=s|a;else if("^"==e.operator)r=s^a;else if("<<"==e.operator)r=s<<a;else if(">>"==e.operator)r=s>>a;else{if(">>>"!=e.operator)throw SyntaxError("Unknown binary operator: "+e.operator);r=s>>>a}}this.stateStack[this.stateStack.length-1].value=this.createPrimitive(r)},s.prototype.stepBlockStatement=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node,r=t.n_||0;e.body[r]?(t.n_=r+1,this.stateStack.push({node:e.body[r]})):this.stateStack.pop()},s.prototype.stepBreakStatement=function(){var t=this.stateStack.pop(),e=t.node,r=null;for(e.label&&(r=e.label.name),t=this.stateStack.pop();t&&"CallExpression"!=t.node.type&&"NewExpression"!=t.node.type;){if(r?r==t.label:t.isLoop||t.isSwitch)return;t=this.stateStack.pop()}throw SyntaxError("Illegal break statement")},s.prototype.stepCallExpression=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node;if(!t.doneCallee_)return t.doneCallee_=!0,void this.stateStack.push({node:e.callee,components:!0});if(!t.func_){if("function"==t.value.type)t.func_=t.value;else{if(t.func_=this.getValue(t.value),t.func_.isGetter)return t.func_.isGetter=!1,this.pushGetter_(t.func_,t.value),void(t.func_=null);if(!t.func_)return;if("function"!=t.func_.type)return void this.throwException(this.TYPE_ERROR,(t.func_&&t.func_.type)+" is not a function")}"NewExpression"==t.node.type?(t.funcThis_=this.createObject(t.func_),t.isConstructor_=!0):t.value.length?t.funcThis_=t.value[0]:t.funcThis_=this.getScope().strict?this.UNDEFINED:this.global,t.arguments_=[],t.n_=0}if(!t.doneArgs_){if(0!=t.n_&&t.arguments_.push(t.value),e.arguments[t.n_])return this.stateStack.push({node:e.arguments[t.n_]}),void t.n_++;t.doneArgs_=!0}if(t.doneExec_)this.stateStack.pop(),t.isConstructor_&&"object"!==t.value.type?this.stateStack[this.stateStack.length-1].value=t.funcThis_:this.stateStack[this.stateStack.length-1].value=t.value;else if(t.doneExec_=!0,t.func_.node){for(var r=this.createScope(t.func_.node.body,t.func_.parentScope),i=0;i<t.func_.node.params.length;i++){var o=this.createPrimitive(t.func_.node.params[i].name),a=t.arguments_.length>i?t.arguments_[i]:this.UNDEFINED;this.setProperty(r,o,a)}var l=this.createObject(this.ARRAY);for(i=0;i<t.arguments_.length;i++)this.setProperty(l,this.createPrimitive(i),t.arguments_[i]);this.setProperty(r,"arguments",l);var c={node:t.func_.node.body,scope:r,thisExpression:t.funcThis_};this.stateStack.push(c),t.value=this.UNDEFINED}else if(t.func_.nativeFunc)t.value=t.func_.nativeFunc.apply(t.funcThis_,t.arguments_);else{if(t.func_.asyncFunc){var u=this,h=t.arguments_.concat(function(e){t.value=e||u.UNDEFINED,u.paused_=!1});return t.func_.asyncFunc.apply(t.funcThis_,h),void(this.paused_=!0)}if(t.func_.eval){var p=t.arguments_[0];if(p)if(p.isPrimitive){var f=n.parse(p.toString(),s.PARSE_OPTIONS);t={node:{type:"EvalProgram_",body:f.body}},this.stripLocations_(t.node,e.start,e.end);r=this.getScope();this.populateScope_(f,r),this.stateStack.push(t)}else t.value=p;else t.value=this.UNDEFINED}else this.throwException(this.TYPE_ERROR,"function is not a function")}},s.prototype.stepCatchClause=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node;if(t.done_)this.stateStack.pop();else{var r;if(t.done_=!0,e.param){r=this.createSpecialScope(this.getScope());var i=this.createPrimitive(e.param.name);this.setProperty(r,i,t.throwValue)}this.stateStack.push({node:e.body,scope:r})}},s.prototype.stepConditionalExpression=function(){var t=this.stateStack[this.stateStack.length-1],e=t.mode_||0;if(0==e)return t.mode_=1,void this.stateStack.push({node:t.node.test});if(1==e){t.mode_=2;var r=t.value.toBoolean();if(r&&t.node.consequent)return void this.stateStack.push({node:t.node.consequent});if(!r&&t.node.alternate)return void this.stateStack.push({node:t.node.alternate});this.value=this.UNDEFINED}this.stateStack.pop(),"ConditionalExpression"==t.node.type&&(this.stateStack[this.stateStack.length-1].value=t.value)},s.prototype.stepContinueStatement=function(){var t=this.stateStack[this.stateStack.length-1],e=null;for(t.node.label&&(e=t.node.label.name);t&&"CallExpression"!=t.node.type&&"NewExpression"!=t.node.type;){if(t.isLoop&&(!e||e==t.label))return;this.stateStack.pop(),t=this.stateStack[this.stateStack.length-1]}throw SyntaxError("Illegal continue statement")},s.prototype.stepDoWhileStatement=function(){var t=this.stateStack[this.stateStack.length-1];"DoWhileStatement"==t.node.type&&void 0===t.test&&(t.value=this.TRUE,t.test_=!0),t.test_?t.value.toBoolean()?t.node.body&&(t.test_=!1,t.isLoop=!0,this.stateStack.push({node:t.node.body})):this.stateStack.pop():(t.test_=!0,this.stateStack.push({node:t.node.test}))},s.prototype.stepEmptyStatement=function(){this.stateStack.pop()},s.prototype.stepEvalProgram_=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node,r=t.n_||0;e.body[r]?(t.n_=r+1,this.stateStack.push({node:e.body[r]})):(this.stateStack.pop(),this.stateStack[this.stateStack.length-1].value=this.value)},s.prototype.stepExpressionStatement=function(){var t=this.stateStack[this.stateStack.length-1];t.done_?(this.stateStack.pop(),this.value=t.value):(t.done_=!0,this.stateStack.push({node:t.node.expression}))},s.prototype.stepForInStatement=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node;if(!t.doneVariable_){t.doneVariable_=!0;var r=e.left;return"VariableDeclaration"==r.type&&(r=r.declarations[0].id),void this.stateStack.push({node:r,components:!0})}if(!t.doneObject_)return t.doneObject_=!0,t.variable_=t.value,void this.stateStack.push({node:e.right});void 0===t.iterator_&&(t.object_=t.value,t.iterator_=0);var i=null;t:do{var n=t.iterator_;for(var o in t.object_.properties)if(!t.object_.notEnumerable[o]){if(0==n){i=o;break t}n--}t.object_=t.object_.parent&&t.object_.parent.properties.prototype,t.iterator_=0}while(t.object_);if(null===i)this.stateStack.pop();else{if(!t.doneSetter_){var s=this.createPrimitive(i),a=this.setValue(t.variable_,s);if(a)return t.doneSetter_=!0,void this.pushSetter_(a,t.variable_,s)}t.doneSetter_=!1,e.body&&(t.isLoop=!0,this.stateStack.push({node:e.body})),t.iterator_++}},s.prototype.stepForStatement=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node,r=t.mode_||0;0==r?(t.mode_=1,e.init&&this.stateStack.push({node:e.init})):1==r?(t.mode_=2,e.test&&this.stateStack.push({node:e.test})):2==r?(t.mode_=3,e.test&&t.value&&!t.value.toBoolean()?this.stateStack.pop():e.body&&(t.isLoop=!0,this.stateStack.push({node:e.body}))):3==r&&(t.mode_=1,e.update&&this.stateStack.push({node:e.update}))},s.prototype.stepFunctionDeclaration=function(){this.stateStack.pop()},s.prototype.stepFunctionExpression=function(){var t=this.stateStack.pop();this.stateStack[this.stateStack.length-1].value=this.createFunction(t.node,this.getScope())},s.prototype.stepIdentifier=function(){var t=this.stateStack.pop(),e=t.node.name,r=this.createPrimitive(e),i=t.components?r:this.getValueFromScope(r);if(i&&i.isGetter){i.isGetter=!1;for(var n=this.getScope();!this.hasProperty(n,e);)n=n.parentScope;var o=i;this.pushGetter_(o,this.global)}else this.stateStack[this.stateStack.length-1].value=i},s.prototype.stepIfStatement=s.prototype.stepConditionalExpression,s.prototype.stepLabeledStatement=function(){var t=this.stateStack.pop();this.stateStack.push({node:t.node.body,label:t.node.label.name})},s.prototype.stepLiteral=function(){var t=this.stateStack.pop();this.stateStack[this.stateStack.length-1].value=this.createPrimitive(t.node.value)},s.prototype.stepLogicalExpression=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node;if("&&"!=e.operator&&"||"!=e.operator)throw SyntaxError("Unknown logical operator: "+e.operator);t.doneLeft_?t.doneRight_?(this.stateStack.pop(),this.stateStack[this.stateStack.length-1].value=t.value):"&&"==e.operator&&!t.value.toBoolean()||"||"==e.operator&&t.value.toBoolean()?(this.stateStack.pop(),this.stateStack[this.stateStack.length-1].value=t.value):(t.doneRight_=!0,this.stateStack.push({node:e.right})):(t.doneLeft_=!0,this.stateStack.push({node:e.left}))},s.prototype.stepMemberExpression=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node;if(t.doneObject_)if(t.doneProperty_)if(this.stateStack.pop(),t.components)this.stateStack[this.stateStack.length-1].value=[t.object_,t.value];else{var r=this.getProperty(t.object_,t.value);if(!r)return this.stateStack.push({}),void this.throwException(this.TYPE_ERROR,"Cannot read property '"+t.value+"' of "+t.object_.toString());if(r.isGetter){r.isGetter=!1;var i=r;this.pushGetter_(i,t.object_)}else this.stateStack[this.stateStack.length-1].value=r}else t.doneProperty_=!0,t.object_=t.value,this.stateStack.push({node:e.property,components:!e.computed});else t.doneObject_=!0,this.stateStack.push({node:e.object})},s.prototype.stepNewExpression=s.prototype.stepCallExpression,s.prototype.stepObjectExpression=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node,r=t.valueToggle_,i=t.n_||0;if(t.object?r?t.key_=t.value:(t.properties[t.key_]||(t.properties[t.key_]={}),t.properties[t.key_][t.kind_]=t.value):(t.object=this.createObject(this.OBJECT),t.properties=Object.create(null)),e.properties[i])r?(t.n_=i+1,this.stateStack.push({node:e.properties[i].value})):(t.kind_=e.properties[i].kind,this.stateStack.push({node:e.properties[i].key,components:!0})),t.valueToggle_=!r;else{for(var n in t.properties){var o=t.properties[n];if("get"in o||"set"in o){var s={configurable:!0,enumerable:!0,get:o.get,set:o.set};this.setProperty(t.object,n,null,s)}else this.setProperty(t.object,n,o.init)}this.stateStack.pop(),this.stateStack[this.stateStack.length-1].value=t.object}},s.prototype.stepProgram=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node,r=t.n_||0;e.body[r]?(t.done=!1,t.n_=r+1,this.stateStack.push({node:e.body[r]})):t.done=!0},s.prototype.stepReturnStatement=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node;if(e.argument&&!t.done_)t.done_=!0,this.stateStack.push({node:e.argument});else{var r=t.value||this.UNDEFINED,i=this.stateStack.length-1;for(t=this.stateStack[i];"CallExpression"!=t.node.type&&"NewExpression"!=t.node.type;){if("TryStatement"!=t.node.type&&this.stateStack.splice(i,1),--i<0)throw SyntaxError("Illegal return statement");t=this.stateStack[i]}t.value=r}},s.prototype.stepSequenceExpression=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node,r=t.n_||0;e.expressions[r]?(t.n_=r+1,this.stateStack.push({node:e.expressions[r]})):(this.stateStack.pop(),this.stateStack[this.stateStack.length-1].value=t.value)},s.prototype.stepSwitchStatement=function(){var t=this.stateStack[this.stateStack.length-1];if(!t.test_)return t.test_=!0,void this.stateStack.push({node:t.node.discriminant});t.switchValue_||(t.switchValue_=t.value,t.checked_=[]);var e=t.index_||0,r=t.node.cases[e];if(r){if(!t.done_&&!t.checked_[e]&&r.test)return t.checked_[e]=!0,void this.stateStack.push({node:r.test});if(t.done_||!r.test||0==this.comp(t.value,t.switchValue_)){t.done_=!0;var i=t.n_||0;if(r.consequent[i])return t.isSwitch=!0,this.stateStack.push({node:r.consequent[i]}),void(t.n_=i+1)}t.n_=0,t.index_=e+1}else this.stateStack.pop()},s.prototype.stepThisExpression=function(){this.stateStack.pop();for(var t=this.stateStack.length-1;t>=0;t--)if(this.stateStack[t].thisExpression)return void(this.stateStack[this.stateStack.length-1].value=this.stateStack[t].thisExpression);throw Error("No this expression found.")},s.prototype.stepThrowStatement=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node;t.done_?this.throwException(t.value):(t.done_=!0,this.stateStack.push({node:e.argument}))},s.prototype.stepTryStatement=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node;t.doneBlock_?t.throwValue&&!t.doneHandler_&&e.handler?(t.doneHandler_=!0,this.stateStack.push({node:e.handler,throwValue:t.throwValue}),t.throwValue=null):!t.doneFinalizer_&&e.finalizer?(t.doneFinalizer_=!0,this.stateStack.push({node:e.finalizer})):t.throwValue?this.executeException(t.throwValue):this.stateStack.pop():(t.doneBlock_=!0,this.stateStack.push({node:e.block}))},s.prototype.stepUnaryExpression=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node;if(t.done_){this.stateStack.pop();var r=t.value;if("-"==e.operator)r=-r.toNumber();else if("+"==e.operator)r=r.toNumber();else if("!"==e.operator)r=!r.toBoolean();else if("~"==e.operator)r=~r.toNumber();else if("delete"==e.operator){if(r.length)var i=r[0],n=r[1];else i=this.getScope(),n=r;if(!(r=this.deleteProperty(i,n))&&this.getScope().strict)return void this.throwException(this.TYPE_ERROR,"Cannot delete property '"+n+"' of '"+i+"'")}else if("typeof"==e.operator)r=r.type;else{if("void"!=e.operator)throw SyntaxError("Unknown unary operator: "+e.operator);r=void 0}this.stateStack[this.stateStack.length-1].value=this.createPrimitive(r)}else{t.done_=!0;var o={node:e.argument,components:"delete"==e.operator};this.stateStack.push(o)}},s.prototype.stepUpdateExpression=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node;if(!t.doneLeft_)return t.doneLeft_=!0,void this.stateStack.push({node:e.argument,components:!0});if(t.leftSide_||(t.leftSide_=t.value),t.doneGetter_&&(t.leftValue_=t.value),!t.doneGetter_){if(t.leftValue_=this.getValue(t.leftSide_),!t.leftValue_)return;if(t.leftValue_.isGetter){t.leftValue_.isGetter=!1,t.doneGetter_=!0;var r=t.leftValue_;return void this.pushGetter_(r,t.leftSide_)}}if(t.doneSetter_)return this.stateStack.pop(),void(this.stateStack[this.stateStack.length-1].value=t.doneSetter_);var i,n=t.leftValue_.toNumber();if("++"==e.operator)i=this.createPrimitive(n+1);else{if("--"!=e.operator)throw SyntaxError("Unknown update expression: "+e.operator);i=this.createPrimitive(n-1)}var o=e.prefix?i:this.createPrimitive(n),s=this.setValue(t.leftSide_,i);if(s)return t.doneSetter_=o,void this.pushSetter_(s,t.leftSide_,i);this.stateStack.pop(),this.stateStack[this.stateStack.length-1].value=o},s.prototype.stepVariableDeclaration=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node,r=t.n_||0,i=e.declarations[r];for(t.value&&i&&(this.setValue(this.createPrimitive(i.id.name),t.value),t.value=null,i=e.declarations[++r]);i;){if(i.init)return t.n_=r,void this.stateStack.push({node:i.init});i=e.declarations[++r]}this.stateStack.pop()},s.prototype.stepWithStatement=function(){var t=this.stateStack[this.stateStack.length-1],e=t.node;if(t.doneObject_)if(t.doneBody_)this.stateStack.pop();else{t.doneBody_=!0;var r=this.createSpecialScope(this.getScope(),t.value);this.stateStack.push({node:e.body,scope:r})}else t.doneObject_=!0,this.stateStack.push({node:e.object})},s.prototype.stepWhileStatement=s.prototype.stepDoWhileStatement,"undefined"!=typeof window&&(window.Interpreter=s),s.prototype.appendCode=s.prototype.appendCode,s.prototype.createAsyncFunction=s.prototype.createAsyncFunction,s.prototype.step=s.prototype.step,s.prototype.run=s.prototype.run,t.exports=s},function(t,e,r){!function(t){"use strict";var e={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},r="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",i={5:r,6:r+" const class extends export import super"},n="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢴࢶ-ࢽऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡૹଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘ-ౚౠౡಀಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൔ-ൖൟ-ൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏽᏸ-ᏽᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᲀ-ᲈᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕ℘-ℝℤΩℨK-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖ゛-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿕ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞮꞰ-ꞷꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꣽꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭥꭰ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ",o="‌‍·̀-ͯ·҃-֑҇-ׇֽֿׁׂׅׄؐ-ًؚ-٩ٰۖ-ۜ۟-۪ۤۧۨ-ۭ۰-۹ܑܰ-݊ަ-ް߀-߉߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣔ-ࣣ࣡-ःऺ-़ा-ॏ॑-ॗॢॣ०-९ঁ-ঃ়া-ৄেৈো-্ৗৢৣ০-৯ਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୢୣ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఀ-ఃా-ౄె-ైొ-్ౕౖౢౣ౦-౯ಁ-ಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢೣ೦-೯ഁ-ഃാ-ൄെ-ൈൊ-്ൗൢൣ൦-൯ංඃ්ා-ුූෘ-ෟ෦-෯ෲෳัิ-ฺ็-๎๐-๙ັິ-ູົຼ່-ໍ໐-໙༘༙༠-༩༹༵༷༾༿ཱ-྄྆྇ྍ-ྗྙ-ྼ࿆ါ-ှ၀-၉ၖ-ၙၞ-ၠၢ-ၤၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟፩-፱ᜒ-᜔ᜲ-᜴ᝒᝓᝲᝳ឴-៓៝០-៩᠋-᠍᠐-᠙ᢩᤠ-ᤫᤰ-᤻᥆-᥏᧐-᧚ᨗ-ᨛᩕ-ᩞ᩠-᩿᩼-᪉᪐-᪙᪰-᪽ᬀ-ᬄ᬴-᭄᭐-᭙᭫-᭳ᮀ-ᮂᮡ-ᮭ᮰-᮹᯦-᯳ᰤ-᰷᱀-᱉᱐-᱙᳐-᳔᳒-᳨᳭ᳲ-᳴᳸᳹᷀-᷵᷻-᷿‿⁀⁔⃐-⃥⃜⃡-⃰⳯-⵿⳱ⷠ-〪ⷿ-゙゚〯꘠-꘩꙯ꙴ-꙽ꚞꚟ꛰꛱ꠂ꠆ꠋꠣ-ꠧꢀꢁꢴ-ꣅ꣐-꣙꣠-꣱꤀-꤉ꤦ-꤭ꥇ-꥓ꦀ-ꦃ꦳-꧀꧐-꧙ꧥ꧰-꧹ꨩ-ꨶꩃꩌꩍ꩐-꩙ꩻ-ꩽꪰꪲ-ꪴꪷꪸꪾ꪿꫁ꫫ-ꫯꫵ꫶ꯣ-ꯪ꯬꯭꯰-꯹ﬞ︀-️︠-︯︳︴﹍-﹏０-９＿",s=new RegExp("["+n+"]"),a=new RegExp("["+n+o+"]");n=o=null;var l=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,17,26,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,157,310,10,21,11,7,153,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,26,45,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,785,52,76,44,33,24,27,35,42,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,85,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,54,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,86,25,391,63,32,0,449,56,264,8,2,36,18,0,50,29,881,921,103,110,18,195,2749,1070,4050,582,8634,568,8,30,114,29,19,47,17,3,32,20,6,18,881,68,12,0,67,12,65,0,32,6124,20,754,9486,1,3071,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,4149,196,60,67,1213,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42710,42,4148,12,221,3,5761,10591,541],c=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,1306,2,54,14,32,9,16,3,46,10,54,9,7,2,37,13,2,9,52,0,13,2,49,13,10,2,4,9,83,11,7,0,161,11,6,9,7,3,57,0,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,87,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,423,9,838,7,2,7,17,9,57,21,2,13,19882,9,135,4,60,6,26,9,1016,45,17,3,19723,1,5319,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,2214,6,110,6,6,9,792487,239];function u(t,e){for(var r=65536,i=0;i<e.length;i+=2){if((r+=e[i])>t)return!1;if((r+=e[i+1])>=t)return!0}}function h(t,e){return t<65?36===t:t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&s.test(String.fromCharCode(t)):!1!==e&&u(t,l)))}function p(t,e){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&a.test(String.fromCharCode(t)):!1!==e&&(u(t,l)||u(t,c)))))}var f=function(t,e){void 0===e&&(e={}),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null};function d(t,e){return new f(t,{beforeExpr:!0,binop:e})}var g={beforeExpr:!0},v={startsExpr:!0},m={};function y(t,e){return void 0===e&&(e={}),e.keyword=t,m[t]=new f(t,e)}var b={num:new f("num",v),regexp:new f("regexp",v),string:new f("string",v),name:new f("name",v),eof:new f("eof"),bracketL:new f("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new f("]"),braceL:new f("{",{beforeExpr:!0,startsExpr:!0}),braceR:new f("}"),parenL:new f("(",{beforeExpr:!0,startsExpr:!0}),parenR:new f(")"),comma:new f(",",g),semi:new f(";",g),colon:new f(":",g),dot:new f("."),question:new f("?",g),arrow:new f("=>",g),template:new f("template"),ellipsis:new f("...",g),backQuote:new f("`",v),dollarBraceL:new f("${",{beforeExpr:!0,startsExpr:!0}),eq:new f("=",{beforeExpr:!0,isAssign:!0}),assign:new f("_=",{beforeExpr:!0,isAssign:!0}),incDec:new f("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new f("prefix",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:d("||",1),logicalAND:d("&&",2),bitwiseOR:d("|",3),bitwiseXOR:d("^",4),bitwiseAND:d("&",5),equality:d("==/!=",6),relational:d("</>",7),bitShift:d("<</>>",8),plusMin:new f("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:d("%",10),star:d("*",10),slash:d("/",10),starstar:new f("**",{beforeExpr:!0}),_break:y("break"),_case:y("case",g),_catch:y("catch"),_continue:y("continue"),_debugger:y("debugger"),_default:y("default",g),_do:y("do",{isLoop:!0,beforeExpr:!0}),_else:y("else",g),_finally:y("finally"),_for:y("for",{isLoop:!0}),_function:y("function",v),_if:y("if"),_return:y("return",g),_switch:y("switch"),_throw:y("throw",g),_try:y("try"),_var:y("var"),_const:y("const"),_while:y("while",{isLoop:!0}),_with:y("with"),_new:y("new",{beforeExpr:!0,startsExpr:!0}),_this:y("this",v),_super:y("super",v),_class:y("class"),_extends:y("extends",g),_export:y("export"),_import:y("import"),_null:y("null",v),_true:y("true",v),_false:y("false",v),_in:y("in",{beforeExpr:!0,binop:7}),_instanceof:y("instanceof",{beforeExpr:!0,binop:7}),_typeof:y("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:y("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:y("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},w=/\r\n?|\n|\u2028|\u2029/,x=new RegExp(w.source,"g");function k(t){return 10===t||13===t||8232===t||8233===t}var S=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/,E=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g;function C(t){return"[object Array]"===Object.prototype.toString.call(t)}function N(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var P=function(t,e){this.line=t,this.column=e};P.prototype.offset=function(t){return new P(this.line,this.column+t)};var T=function(t,e,r){this.start=e,this.end=r,null!==t.sourceFile&&(this.source=t.sourceFile)};function A(t,e){for(var r=1,i=0;;){x.lastIndex=i;var n=x.exec(t);if(!(n&&n.index<e))return new P(r,e-i);++r,i=n.index+n[0].length}}var R={ecmaVersion:7,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowHashBang:!1,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1,plugins:{}};function O(t){var e={};for(var r in R)e[r]=t&&N(t,r)?t[r]:R[r];if(e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),null==e.allowReserved&&(e.allowReserved=e.ecmaVersion<5),C(e.onToken)){var i=e.onToken;e.onToken=function(t){return i.push(t)}}return C(e.onComment)&&(e.onComment=function(t,e){return function(r,i,n,o,s,a){var l={type:r?"Block":"Line",value:i,start:n,end:o};t.locations&&(l.loc=new T(this,s,a)),t.ranges&&(l.range=[n,o]),e.push(l)}}(e,e.onComment)),e}var L={};function _(t){return new RegExp("^("+t.replace(/ /g,"|")+")$")}var M=function(t,r,n){this.options=t=O(t),this.sourceFile=t.sourceFile,this.keywords=_(i[t.ecmaVersion>=6?6:5]);var o="";if(!t.allowReserved){for(var s=t.ecmaVersion;!(o=e[s]);s--);"module"==t.sourceType&&(o+=" await")}this.reservedWords=_(o);var a=(o?o+" ":"")+e.strict;this.reservedWordsStrict=_(a),this.reservedWordsStrictBind=_(a+" "+e.strictBind),this.input=String(r),this.containsEsc=!1,this.loadPlugins(t.plugins),n?(this.pos=n,this.lineStart=this.input.lastIndexOf("\n",n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(w).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=b.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===t.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.inFunction=this.inGenerator=this.inAsync=!1,this.yieldPos=this.awaitPos=0,this.labels=[],0===this.pos&&t.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2)};M.prototype.isKeyword=function(t){return this.keywords.test(t)},M.prototype.isReservedWord=function(t){return this.reservedWords.test(t)},M.prototype.extend=function(t,e){this[t]=e(this[t])},M.prototype.loadPlugins=function(t){for(var e in t){var r=L[e];if(!r)throw new Error("Plugin '"+e+"' not found");r(this,t[e])}},M.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};var I=M.prototype,D=/^(?:'((?:[^\']|\.)*)'|"((?:[^\"]|\.)*)"|;)/;I.strictDirective=function(t){for(;;){E.lastIndex=t,t+=E.exec(this.input)[0].length;var e=D.exec(this.input.slice(t));if(!e)return!1;if("use strict"==(e[1]||e[2]))return!0;t+=e[0].length}},I.eat=function(t){return this.type===t&&(this.next(),!0)},I.isContextual=function(t){return this.type===b.name&&this.value===t},I.eatContextual=function(t){return this.value===t&&this.eat(b.name)},I.expectContextual=function(t){this.eatContextual(t)||this.unexpected()},I.canInsertSemicolon=function(){return this.type===b.eof||this.type===b.braceR||w.test(this.input.slice(this.lastTokEnd,this.start))},I.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},I.semicolon=function(){this.eat(b.semi)||this.insertSemicolon()||this.unexpected()},I.afterTrailingComma=function(t,e){if(this.type==t)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0},I.expect=function(t){this.eat(t)||this.unexpected()},I.unexpected=function(t){this.raise(null!=t?t:this.start,"Unexpected token")};var F=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=-1};I.checkPatternErrors=function(t,e){if(t){t.trailingComma>-1&&this.raiseRecoverable(t.trailingComma,"Comma is not permitted after the rest element");var r=e?t.parenthesizedAssign:t.parenthesizedBind;r>-1&&this.raiseRecoverable(r,"Parenthesized pattern")}},I.checkExpressionErrors=function(t,e){var r=t?t.shorthandAssign:-1;if(!e)return r>=0;r>-1&&this.raise(r,"Shorthand property assignments are valid only in destructuring patterns")},I.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},I.isSimpleAssignTarget=function(t){return"ParenthesizedExpression"===t.type?this.isSimpleAssignTarget(t.expression):"Identifier"===t.type||"MemberExpression"===t.type};var B=M.prototype;B.parseTopLevel=function(t){var e={};for(t.body||(t.body=[]);this.type!==b.eof;){var r=this.parseStatement(!0,!0,e);t.body.push(r)}return this.next(),this.options.ecmaVersion>=6&&(t.sourceType=this.options.sourceType),this.finishNode(t,"Program")};var U={kind:"loop"},j={kind:"switch"};B.isLet=function(){if(this.type!==b.name||this.options.ecmaVersion<6||"let"!=this.value)return!1;E.lastIndex=this.pos;var t=E.exec(this.input),e=this.pos+t[0].length,r=this.input.charCodeAt(e);if(91===r||123==r)return!0;if(h(r,!0)){for(var i=e+1;p(this.input.charCodeAt(i),!0);++i);var n=this.input.slice(e,i);if(!this.isKeyword(n))return!0}return!1},B.isAsyncFunction=function(){if(this.type!==b.name||this.options.ecmaVersion<8||"async"!=this.value)return!1;E.lastIndex=this.pos;var t=E.exec(this.input),e=this.pos+t[0].length;return!(w.test(this.input.slice(this.pos,e))||"function"!==this.input.slice(e,e+8)||e+8!=this.input.length&&p(this.input.charAt(e+8)))},B.parseStatement=function(t,e,r){var i,n=this.type,o=this.startNode();switch(this.isLet()&&(n=b._var,i="let"),n){case b._break:case b._continue:return this.parseBreakContinueStatement(o,n.keyword);case b._debugger:return this.parseDebuggerStatement(o);case b._do:return this.parseDoStatement(o);case b._for:return this.parseForStatement(o);case b._function:return!t&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(o,!1);case b._class:return t||this.unexpected(),this.parseClass(o,!0);case b._if:return this.parseIfStatement(o);case b._return:return this.parseReturnStatement(o);case b._switch:return this.parseSwitchStatement(o);case b._throw:return this.parseThrowStatement(o);case b._try:return this.parseTryStatement(o);case b._const:case b._var:return i=i||this.value,t||"var"==i||this.unexpected(),this.parseVarStatement(o,i);case b._while:return this.parseWhileStatement(o);case b._with:return this.parseWithStatement(o);case b.braceL:return this.parseBlock();case b.semi:return this.parseEmptyStatement(o);case b._export:case b._import:return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),n===b._import?this.parseImport(o):this.parseExport(o,r);default:if(this.isAsyncFunction()&&t)return this.next(),this.parseFunctionStatement(o,!0);var s=this.value,a=this.parseExpression();return n===b.name&&"Identifier"===a.type&&this.eat(b.colon)?this.parseLabeledStatement(o,s,a):this.parseExpressionStatement(o,a)}},B.parseBreakContinueStatement=function(t,e){var r="break"==e;this.next(),this.eat(b.semi)||this.insertSemicolon()?t.label=null:this.type!==b.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var i=0;i<this.labels.length;++i){var n=this.labels[i];if(null==t.label||n.name===t.label.name){if(null!=n.kind&&(r||"loop"===n.kind))break;if(t.label&&r)break}}return i===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,r?"BreakStatement":"ContinueStatement")},B.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")},B.parseDoStatement=function(t){return this.next(),this.labels.push(U),t.body=this.parseStatement(!1),this.labels.pop(),this.expect(b._while),t.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(b.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")},B.parseForStatement=function(t){if(this.next(),this.labels.push(U),this.expect(b.parenL),this.type===b.semi)return this.parseFor(t,null);var e=this.isLet();if(this.type===b._var||this.type===b._const||e){var r=this.startNode(),i=e?"let":this.value;return this.next(),this.parseVar(r,!0,i),this.finishNode(r,"VariableDeclaration"),!(this.type===b._in||this.options.ecmaVersion>=6&&this.isContextual("of"))||1!==r.declarations.length||"var"!==i&&r.declarations[0].init?this.parseFor(t,r):this.parseForIn(t,r)}var n=new F,o=this.parseExpression(!0,n);return this.type===b._in||this.options.ecmaVersion>=6&&this.isContextual("of")?(this.toAssignable(o),this.checkLVal(o),this.checkPatternErrors(n,!0),this.parseForIn(t,o)):(this.checkExpressionErrors(n,!0),this.parseFor(t,o))},B.parseFunctionStatement=function(t,e){return this.next(),this.parseFunction(t,!0,!1,e)},B.isFunction=function(){return this.type===b._function||this.isAsyncFunction()},B.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement(!this.strict&&this.isFunction()),t.alternate=this.eat(b._else)?this.parseStatement(!this.strict&&this.isFunction()):null,this.finishNode(t,"IfStatement")},B.parseReturnStatement=function(t){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(b.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")},B.parseSwitchStatement=function(t){this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(b.braceL),this.labels.push(j);for(var e,r=!1;this.type!=b.braceR;)if(this.type===b._case||this.type===b._default){var i=this.type===b._case;e&&this.finishNode(e,"SwitchCase"),t.cases.push(e=this.startNode()),e.consequent=[],this.next(),i?e.test=this.parseExpression():(r&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),r=!0,e.test=null),this.expect(b.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(!0));return e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")},B.parseThrowStatement=function(t){return this.next(),w.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var W=[];B.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===b._catch){var e=this.startNode();this.next(),this.expect(b.parenL),e.param=this.parseBindingAtom(),this.checkLVal(e.param,!0),this.expect(b.parenR),e.body=this.parseBlock(),t.handler=this.finishNode(e,"CatchClause")}return t.finalizer=this.eat(b._finally)?this.parseBlock():null,t.handler||t.finalizer||this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")},B.parseVarStatement=function(t,e){return this.next(),this.parseVar(t,!1,e),this.semicolon(),this.finishNode(t,"VariableDeclaration")},B.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(U),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,"WhileStatement")},B.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement(!1),this.finishNode(t,"WithStatement")},B.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")},B.parseLabeledStatement=function(t,e,r){for(var i=0;i<this.labels.length;++i)this.labels[i].name===e&&this.raise(r.start,"Label '"+e+"' is already declared");for(var n=this.type.isLoop?"loop":this.type===b._switch?"switch":null,o=this.labels.length-1;o>=0;o--){var s=this.labels[o];if(s.statementStart!=t.start)break;s.statementStart=this.start,s.kind=n}return this.labels.push({name:e,kind:n,statementStart:this.start}),t.body=this.parseStatement(!0),("ClassDeclaration"==t.body.type||"VariableDeclaration"==t.body.type&&(this.strict||"var"!=t.body.kind)||"FunctionDeclaration"==t.body.type&&(this.strict||t.body.generator))&&this.raiseRecoverable(t.body.start,"Invalid labeled declaration"),this.labels.pop(),t.label=r,this.finishNode(t,"LabeledStatement")},B.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")},B.parseBlock=function(){var t=this.startNode();for(t.body=[],this.expect(b.braceL);!this.eat(b.braceR);){var e=this.parseStatement(!0);t.body.push(e)}return this.finishNode(t,"BlockStatement")},B.parseFor=function(t,e){return t.init=e,this.expect(b.semi),t.test=this.type===b.semi?null:this.parseExpression(),this.expect(b.semi),t.update=this.type===b.parenR?null:this.parseExpression(),this.expect(b.parenR),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,"ForStatement")},B.parseForIn=function(t,e){var r=this.type===b._in?"ForInStatement":"ForOfStatement";return this.next(),t.left=e,t.right=this.parseExpression(),this.expect(b.parenR),t.body=this.parseStatement(!1),this.labels.pop(),this.finishNode(t,r)},B.parseVar=function(t,e,r){for(t.declarations=[],t.kind=r;;){var i=this.startNode();if(this.parseVarId(i),this.eat(b.eq)?i.init=this.parseMaybeAssign(e):"const"!==r||this.type===b._in||this.options.ecmaVersion>=6&&this.isContextual("of")?"Identifier"==i.id.type||e&&(this.type===b._in||this.isContextual("of"))?i.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),t.declarations.push(this.finishNode(i,"VariableDeclarator")),!this.eat(b.comma))break}return t},B.parseVarId=function(t){t.id=this.parseBindingAtom(),this.checkLVal(t.id,!0)},B.parseFunction=function(t,e,r,i){this.initFunction(t),this.options.ecmaVersion>=6&&!i&&(t.generator=this.eat(b.star)),this.options.ecmaVersion>=8&&(t.async=!!i),null==e&&(e=this.type==b.name),e&&(t.id=this.parseIdent());var n=this.inGenerator,o=this.inAsync,s=this.yieldPos,a=this.awaitPos,l=this.inFunction;return this.inGenerator=t.generator,this.inAsync=t.async,this.yieldPos=0,this.awaitPos=0,this.inFunction=!0,e||this.type!==b.name||(t.id=this.parseIdent()),this.parseFunctionParams(t),this.parseFunctionBody(t,r),this.inGenerator=n,this.inAsync=o,this.yieldPos=s,this.awaitPos=a,this.inFunction=l,this.finishNode(t,e?"FunctionDeclaration":"FunctionExpression")},B.parseFunctionParams=function(t){this.expect(b.parenL),t.params=this.parseBindingList(b.parenR,!1,this.options.ecmaVersion>=8,!0),this.checkYieldAwaitInDefaultParams()},B.parseClass=function(t,e){this.next(),null==e&&(e=this.type===b.name),this.parseClassId(t,e),this.parseClassSuper(t);var r=this.startNode(),i=!1;for(r.body=[],this.expect(b.braceL);!this.eat(b.braceR);)if(!this.eat(b.semi)){var n=this.startNode(),o=this.eat(b.star),s=!1,a=this.type===b.name&&"static"===this.value;this.parsePropertyName(n),n.static=a&&this.type!==b.parenL,n.static&&(o&&this.unexpected(),o=this.eat(b.star),this.parsePropertyName(n)),this.options.ecmaVersion>=8&&!o&&!n.computed&&"Identifier"===n.key.type&&"async"===n.key.name&&this.type!==b.parenL&&!this.canInsertSemicolon()&&(s=!0,this.parsePropertyName(n)),n.kind="method";var l=!1;if(!n.computed){var c=n.key;o||s||"Identifier"!==c.type||this.type===b.parenL||"get"!==c.name&&"set"!==c.name||(l=!0,n.kind=c.name,c=this.parsePropertyName(n)),!n.static&&("Identifier"===c.type&&"constructor"===c.name||"Literal"===c.type&&"constructor"===c.value)&&(i&&this.raise(c.start,"Duplicate constructor in the same class"),l&&this.raise(c.start,"Constructor can't have get/set modifier"),o&&this.raise(c.start,"Constructor can't be a generator"),s&&this.raise(c.start,"Constructor can't be an async method"),n.kind="constructor",i=!0)}if(this.parseClassMethod(r,n,o,s),l){var u="get"===n.kind?0:1;if(n.value.params.length!==u){var h=n.value.start;"get"===n.kind?this.raiseRecoverable(h,"getter should have no params"):this.raiseRecoverable(h,"setter should have exactly one param")}else"set"===n.kind&&"RestElement"===n.value.params[0].type&&this.raiseRecoverable(n.value.params[0].start,"Setter cannot use rest params")}}return t.body=this.finishNode(r,"ClassBody"),this.finishNode(t,e?"ClassDeclaration":"ClassExpression")},B.parseClassMethod=function(t,e,r,i){e.value=this.parseMethod(r,i),t.body.push(this.finishNode(e,"MethodDefinition"))},B.parseClassId=function(t,e){t.id=this.type===b.name?this.parseIdent():e?this.unexpected():null},B.parseClassSuper=function(t){t.superClass=this.eat(b._extends)?this.parseExprSubscripts():null},B.parseExport=function(t,e){if(this.next(),this.eat(b.star))return this.expectContextual("from"),t.source=this.type===b.string?this.parseExprAtom():this.unexpected(),this.semicolon(),this.finishNode(t,"ExportAllDeclaration");if(this.eat(b._default)){var r;if(this.checkExport(e,"default",this.lastTokStart),this.type===b._function||(r=this.isAsyncFunction())){var i=this.startNode();this.next(),r&&this.next(),t.declaration=this.parseFunction(i,null,!1,r)}else if(this.type===b._class){var n=this.startNode();t.declaration=this.parseClass(n,null)}else t.declaration=this.parseMaybeAssign(),this.semicolon();return this.finishNode(t,"ExportDefaultDeclaration")}if(this.shouldParseExportStatement())t.declaration=this.parseStatement(!0),"VariableDeclaration"===t.declaration.type?this.checkVariableExport(e,t.declaration.declarations):this.checkExport(e,t.declaration.id.name,t.declaration.id.start),t.specifiers=[],t.source=null;else{if(t.declaration=null,t.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))t.source=this.type===b.string?this.parseExprAtom():this.unexpected();else{for(var o=0;o<t.specifiers.length;o++)(this.keywords.test(t.specifiers[o].local.name)||this.reservedWords.test(t.specifiers[o].local.name))&&this.unexpected(t.specifiers[o].local.start);t.source=null}this.semicolon()}return this.finishNode(t,"ExportNamedDeclaration")},B.checkExport=function(t,e,r){t&&(Object.prototype.hasOwnProperty.call(t,e)&&this.raiseRecoverable(r,"Duplicate export '"+e+"'"),t[e]=!0)},B.checkPatternExport=function(t,e){var r=e.type;if("Identifier"==r)this.checkExport(t,e.name,e.start);else if("ObjectPattern"==r)for(var i=0;i<e.properties.length;++i)this.checkPatternExport(t,e.properties[i].value);else if("ArrayPattern"==r)for(var n=0;n<e.elements.length;++n){var o=e.elements[n];o&&this.checkPatternExport(t,o)}else"AssignmentPattern"==r?this.checkPatternExport(t,e.left):"ParenthesizedExpression"==r&&this.checkPatternExport(t,e.expression)},B.checkVariableExport=function(t,e){if(t)for(var r=0;r<e.length;r++)this.checkPatternExport(t,e[r].id)},B.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},B.parseExportSpecifiers=function(t){var e=[],r=!0;for(this.expect(b.braceL);!this.eat(b.braceR);){if(r)r=!1;else if(this.expect(b.comma),this.afterTrailingComma(b.braceR))break;var i=this.startNode();i.local=this.parseIdent(!0),i.exported=this.eatContextual("as")?this.parseIdent(!0):i.local,this.checkExport(t,i.exported.name,i.exported.start),e.push(this.finishNode(i,"ExportSpecifier"))}return e},B.parseImport=function(t){return this.next(),this.type===b.string?(t.specifiers=W,t.source=this.parseExprAtom()):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===b.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(t,"ImportDeclaration")},B.parseImportSpecifiers=function(){var t=[],e=!0;if(this.type===b.name){var r=this.startNode();if(r.local=this.parseIdent(),this.checkLVal(r.local,!0),t.push(this.finishNode(r,"ImportDefaultSpecifier")),!this.eat(b.comma))return t}if(this.type===b.star){var i=this.startNode();return this.next(),this.expectContextual("as"),i.local=this.parseIdent(),this.checkLVal(i.local,!0),t.push(this.finishNode(i,"ImportNamespaceSpecifier")),t}for(this.expect(b.braceL);!this.eat(b.braceR);){if(e)e=!1;else if(this.expect(b.comma),this.afterTrailingComma(b.braceR))break;var n=this.startNode();n.imported=this.parseIdent(!0),this.eatContextual("as")?n.local=this.parseIdent():(n.local=n.imported,this.isKeyword(n.local.name)&&this.unexpected(n.local.start),this.reservedWordsStrict.test(n.local.name)&&this.raiseRecoverable(n.local.start,"The keyword '"+n.local.name+"' is reserved")),this.checkLVal(n.local,!0),t.push(this.finishNode(n,"ImportSpecifier"))}return t};var V=M.prototype;V.toAssignable=function(t,e){if(this.options.ecmaVersion>=6&&t)switch(t.type){case"Identifier":this.inAsync&&"await"===t.name&&this.raise(t.start,"Can not use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":break;case"ObjectExpression":t.type="ObjectPattern";for(var r=0;r<t.properties.length;r++){var i=t.properties[r];"init"!==i.kind&&this.raise(i.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(i.value,e)}break;case"ArrayExpression":t.type="ArrayPattern",this.toAssignableList(t.elements,e);break;case"AssignmentExpression":if("="!==t.operator){this.raise(t.left.end,"Only '=' operator can be used for specifying default value.");break}t.type="AssignmentPattern",delete t.operator,this.toAssignable(t.left,e);case"AssignmentPattern":break;case"ParenthesizedExpression":t.expression=this.toAssignable(t.expression,e);break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}return t},V.toAssignableList=function(t,e){var r=t.length;if(r){var i=t[r-1];if(i&&"RestElement"==i.type)--r;else if(i&&"SpreadElement"==i.type){i.type="RestElement";var n=i.argument;this.toAssignable(n,e),"Identifier"!==n.type&&"MemberExpression"!==n.type&&"ArrayPattern"!==n.type&&this.unexpected(n.start),--r}e&&i&&"RestElement"===i.type&&"Identifier"!==i.argument.type&&this.unexpected(i.argument.start)}for(var o=0;o<r;o++){var s=t[o];s&&this.toAssignable(s,e)}return t},V.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,t),this.finishNode(e,"SpreadElement")},V.parseRest=function(t){var e=this.startNode();return this.next(),e.argument=t?this.type===b.name?this.parseIdent():this.unexpected():this.type===b.name||this.type===b.bracketL?this.parseBindingAtom():this.unexpected(),this.finishNode(e,"RestElement")},V.parseBindingAtom=function(){if(this.options.ecmaVersion<6)return this.parseIdent();switch(this.type){case b.name:return this.parseIdent();case b.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(b.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case b.braceL:return this.parseObj(!0);default:this.unexpected()}},V.parseBindingList=function(t,e,r,i){for(var n=[],o=!0;!this.eat(t);)if(o?o=!1:this.expect(b.comma),e&&this.type===b.comma)n.push(null);else{if(r&&this.afterTrailingComma(t))break;if(this.type===b.ellipsis){var s=this.parseRest(i);this.parseBindingListItem(s),n.push(s),this.type===b.comma&&this.raise(this.start,"Comma is not permitted after the rest element"),this.expect(t);break}var a=this.parseMaybeDefault(this.start,this.startLoc);this.parseBindingListItem(a),n.push(a)}return n},V.parseBindingListItem=function(t){return t},V.parseMaybeDefault=function(t,e,r){if(r=r||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(b.eq))return r;var i=this.startNodeAt(t,e);return i.left=r,i.right=this.parseMaybeAssign(),this.finishNode(i,"AssignmentPattern")},V.checkLVal=function(t,e,r){switch(t.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(t.name)&&this.raiseRecoverable(t.start,(e?"Binding ":"Assigning to ")+t.name+" in strict mode"),r&&(N(r,t.name)&&this.raiseRecoverable(t.start,"Argument name clash"),r[t.name]=!0);break;case"MemberExpression":e&&this.raiseRecoverable(t.start,(e?"Binding":"Assigning to")+" member expression");break;case"ObjectPattern":for(var i=0;i<t.properties.length;i++)this.checkLVal(t.properties[i].value,e,r);break;case"ArrayPattern":for(var n=0;n<t.elements.length;n++){var o=t.elements[n];o&&this.checkLVal(o,e,r)}break;case"AssignmentPattern":this.checkLVal(t.left,e,r);break;case"RestElement":this.checkLVal(t.argument,e,r);break;case"ParenthesizedExpression":this.checkLVal(t.expression,e,r);break;default:this.raise(t.start,(e?"Binding":"Assigning to")+" rvalue")}};var z=M.prototype;z.checkPropClash=function(t,e){if(!(this.options.ecmaVersion>=6&&(t.computed||t.method||t.shorthand))){var r,i=t.key;switch(i.type){case"Identifier":r=i.name;break;case"Literal":r=String(i.value);break;default:return}var n=t.kind;if(this.options.ecmaVersion>=6)"__proto__"===r&&"init"===n&&(e.proto&&this.raiseRecoverable(i.start,"Redefinition of __proto__ property"),e.proto=!0);else{var o=e[r="$"+r];if(o){var s="init"!==n;(!this.strict&&!s||!o[n])&&s^o.init||this.raiseRecoverable(i.start,"Redefinition of property")}else o=e[r]={init:!1,get:!1,set:!1};o[n]=!0}}},z.parseExpression=function(t,e){var r=this.start,i=this.startLoc,n=this.parseMaybeAssign(t,e);if(this.type===b.comma){var o=this.startNodeAt(r,i);for(o.expressions=[n];this.eat(b.comma);)o.expressions.push(this.parseMaybeAssign(t,e));return this.finishNode(o,"SequenceExpression")}return n},z.parseMaybeAssign=function(t,e,r){if(this.inGenerator&&this.isContextual("yield"))return this.parseYield();var i=!1,n=-1;e?(n=e.parenthesizedAssign,e.parenthesizedAssign=-1):(e=new F,i=!0);var o=this.start,s=this.startLoc;this.type!=b.parenL&&this.type!=b.name||(this.potentialArrowAt=this.start);var a=this.parseMaybeConditional(t,e);if(r&&(a=r.call(this,a,o,s)),this.type.isAssign){this.checkPatternErrors(e,!0),i||F.call(e);var l=this.startNodeAt(o,s);return l.operator=this.value,l.left=this.type===b.eq?this.toAssignable(a):a,e.shorthandAssign=-1,this.checkLVal(a),this.next(),l.right=this.parseMaybeAssign(t),this.finishNode(l,"AssignmentExpression")}return i&&this.checkExpressionErrors(e,!0),n>-1&&(e.parenthesizedAssign=n),a},z.parseMaybeConditional=function(t,e){var r=this.start,i=this.startLoc,n=this.parseExprOps(t,e);if(this.checkExpressionErrors(e))return n;if(this.eat(b.question)){var o=this.startNodeAt(r,i);return o.test=n,o.consequent=this.parseMaybeAssign(),this.expect(b.colon),o.alternate=this.parseMaybeAssign(t),this.finishNode(o,"ConditionalExpression")}return n},z.parseExprOps=function(t,e){var r=this.start,i=this.startLoc,n=this.parseMaybeUnary(e,!1);return this.checkExpressionErrors(e)?n:this.parseExprOp(n,r,i,-1,t)},z.parseExprOp=function(t,e,r,i,n){var o=this.type.binop;if(null!=o&&(!n||this.type!==b._in)&&o>i){var s=this.type===b.logicalOR||this.type===b.logicalAND,a=this.value;this.next();var l=this.start,c=this.startLoc,u=this.parseExprOp(this.parseMaybeUnary(null,!1),l,c,o,n),h=this.buildBinary(e,r,t,u,a,s);return this.parseExprOp(h,e,r,i,n)}return t},z.buildBinary=function(t,e,r,i,n,o){var s=this.startNodeAt(t,e);return s.left=r,s.operator=n,s.right=i,this.finishNode(s,o?"LogicalExpression":"BinaryExpression")},z.parseMaybeUnary=function(t,e){var r,i=this.start,n=this.startLoc;if(this.inAsync&&this.isContextual("await"))r=this.parseAwait(t),e=!0;else if(this.type.prefix){var o=this.startNode(),s=this.type===b.incDec;o.operator=this.value,o.prefix=!0,this.next(),o.argument=this.parseMaybeUnary(null,!0),this.checkExpressionErrors(t,!0),s?this.checkLVal(o.argument):this.strict&&"delete"===o.operator&&"Identifier"===o.argument.type?this.raiseRecoverable(o.start,"Deleting local variable in strict mode"):e=!0,r=this.finishNode(o,s?"UpdateExpression":"UnaryExpression")}else{if(r=this.parseExprSubscripts(t),this.checkExpressionErrors(t))return r;for(;this.type.postfix&&!this.canInsertSemicolon();){var a=this.startNodeAt(i,n);a.operator=this.value,a.prefix=!1,a.argument=r,this.checkLVal(r),this.next(),r=this.finishNode(a,"UpdateExpression")}}return!e&&this.eat(b.starstar)?this.buildBinary(i,n,r,this.parseMaybeUnary(null,!1),"**",!1):r},z.parseExprSubscripts=function(t){var e=this.start,r=this.startLoc,i=this.parseExprAtom(t),n="ArrowFunctionExpression"===i.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd);if(this.checkExpressionErrors(t)||n)return i;var o=this.parseSubscripts(i,e,r);return t&&"MemberExpression"===o.type&&(t.parenthesizedAssign>=o.start&&(t.parenthesizedAssign=-1),t.parenthesizedBind>=o.start&&(t.parenthesizedBind=-1)),o},z.parseSubscripts=function(t,e,r,i){for(var n,o=this.options.ecmaVersion>=8&&"Identifier"===t.type&&"async"===t.name&&this.lastTokEnd==t.end&&!this.canInsertSemicolon();;)if((n=this.eat(b.bracketL))||this.eat(b.dot)){var s=this.startNodeAt(e,r);s.object=t,s.property=n?this.parseExpression():this.parseIdent(!0),s.computed=!!n,n&&this.expect(b.bracketR),t=this.finishNode(s,"MemberExpression")}else if(!i&&this.eat(b.parenL)){var a=new F,l=this.yieldPos,c=this.awaitPos;this.yieldPos=0,this.awaitPos=0;var u=this.parseExprList(b.parenR,this.options.ecmaVersion>=8,!1,a);if(o&&!this.canInsertSemicolon()&&this.eat(b.arrow))return this.checkPatternErrors(a,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=l,this.awaitPos=c,this.parseArrowExpression(this.startNodeAt(e,r),u,!0);this.checkExpressionErrors(a,!0),this.yieldPos=l||this.yieldPos,this.awaitPos=c||this.awaitPos;var h=this.startNodeAt(e,r);h.callee=t,h.arguments=u,t=this.finishNode(h,"CallExpression")}else{if(this.type!==b.backQuote)return t;var p=this.startNodeAt(e,r);p.tag=t,p.quasi=this.parseTemplate(),t=this.finishNode(p,"TaggedTemplateExpression")}},z.parseExprAtom=function(t){var e,r=this.potentialArrowAt==this.start;switch(this.type){case b._super:this.inFunction||this.raise(this.start,"'super' outside of function or class");case b._this:var i=this.type===b._this?"ThisExpression":"Super";return e=this.startNode(),this.next(),this.finishNode(e,i);case b.name:var n=this.start,o=this.startLoc,s=this.parseIdent(this.type!==b.name);if(this.options.ecmaVersion>=8&&"async"===s.name&&!this.canInsertSemicolon()&&this.eat(b._function))return this.parseFunction(this.startNodeAt(n,o),!1,!1,!0);if(r&&!this.canInsertSemicolon()){if(this.eat(b.arrow))return this.parseArrowExpression(this.startNodeAt(n,o),[s],!1);if(this.options.ecmaVersion>=8&&"async"===s.name&&this.type===b.name)return s=this.parseIdent(),!this.canInsertSemicolon()&&this.eat(b.arrow)||this.unexpected(),this.parseArrowExpression(this.startNodeAt(n,o),[s],!0)}return s;case b.regexp:var a=this.value;return(e=this.parseLiteral(a.value)).regex={pattern:a.pattern,flags:a.flags},e;case b.num:case b.string:return this.parseLiteral(this.value);case b._null:case b._true:case b._false:return(e=this.startNode()).value=this.type===b._null?null:this.type===b._true,e.raw=this.type.keyword,this.next(),this.finishNode(e,"Literal");case b.parenL:var l=this.start,c=this.parseParenAndDistinguishExpression(r);return t&&(t.parenthesizedAssign<0&&!this.isSimpleAssignTarget(c)&&(t.parenthesizedAssign=l),t.parenthesizedBind<0&&(t.parenthesizedBind=l)),c;case b.bracketL:return e=this.startNode(),this.next(),e.elements=this.parseExprList(b.bracketR,!0,!0,t),this.finishNode(e,"ArrayExpression");case b.braceL:return this.parseObj(!1,t);case b._function:return e=this.startNode(),this.next(),this.parseFunction(e,!1);case b._class:return this.parseClass(this.startNode(),!1);case b._new:return this.parseNew();case b.backQuote:return this.parseTemplate();default:this.unexpected()}},z.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),this.next(),this.finishNode(e,"Literal")},z.parseParenExpression=function(){this.expect(b.parenL);var t=this.parseExpression();return this.expect(b.parenR),t},z.parseParenAndDistinguishExpression=function(t){var e,r=this.start,i=this.startLoc,n=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var o,s,a=this.start,l=this.startLoc,c=[],u=!0,h=!1,p=new F,f=this.yieldPos,d=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==b.parenR;){if(u?u=!1:this.expect(b.comma),n&&this.afterTrailingComma(b.parenR,!0)){h=!0;break}if(this.type===b.ellipsis){o=this.start,c.push(this.parseParenItem(this.parseRest())),this.type===b.comma&&this.raise(this.start,"Comma is not permitted after the rest element");break}this.type!==b.parenL||s||(s=this.start),c.push(this.parseMaybeAssign(!1,p,this.parseParenItem))}var g=this.start,v=this.startLoc;if(this.expect(b.parenR),t&&!this.canInsertSemicolon()&&this.eat(b.arrow))return this.checkPatternErrors(p,!1),this.checkYieldAwaitInDefaultParams(),s&&this.unexpected(s),this.yieldPos=f,this.awaitPos=d,this.parseParenArrowList(r,i,c);c.length&&!h||this.unexpected(this.lastTokStart),o&&this.unexpected(o),this.checkExpressionErrors(p,!0),this.yieldPos=f||this.yieldPos,this.awaitPos=d||this.awaitPos,c.length>1?((e=this.startNodeAt(a,l)).expressions=c,this.finishNodeAt(e,"SequenceExpression",g,v)):e=c[0]}else e=this.parseParenExpression();if(this.options.preserveParens){var m=this.startNodeAt(r,i);return m.expression=e,this.finishNode(m,"ParenthesizedExpression")}return e},z.parseParenItem=function(t){return t},z.parseParenArrowList=function(t,e,r){return this.parseArrowExpression(this.startNodeAt(t,e),r)};var H=[];z.parseNew=function(){var t=this.startNode(),e=this.parseIdent(!0);if(this.options.ecmaVersion>=6&&this.eat(b.dot))return t.meta=e,t.property=this.parseIdent(!0),"target"!==t.property.name&&this.raiseRecoverable(t.property.start,"The only valid meta property for new is new.target"),this.inFunction||this.raiseRecoverable(t.start,"new.target can only be used in functions"),this.finishNode(t,"MetaProperty");var r=this.start,i=this.startLoc;return t.callee=this.parseSubscripts(this.parseExprAtom(),r,i,!0),this.eat(b.parenL)?t.arguments=this.parseExprList(b.parenR,this.options.ecmaVersion>=8,!1):t.arguments=H,this.finishNode(t,"NewExpression")},z.parseTemplateElement=function(){var t=this.startNode();return t.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),t.tail=this.type===b.backQuote,this.finishNode(t,"TemplateElement")},z.parseTemplate=function(){var t=this.startNode();this.next(),t.expressions=[];var e=this.parseTemplateElement();for(t.quasis=[e];!e.tail;)this.expect(b.dollarBraceL),t.expressions.push(this.parseExpression()),this.expect(b.braceR),t.quasis.push(e=this.parseTemplateElement());return this.next(),this.finishNode(t,"TemplateLiteral")},z.parseObj=function(t,e){var r=this.startNode(),i=!0,n={};for(r.properties=[],this.next();!this.eat(b.braceR);){if(i)i=!1;else if(this.expect(b.comma),this.afterTrailingComma(b.braceR))break;var o,s,a,l,c=this.startNode();this.options.ecmaVersion>=6&&(c.method=!1,c.shorthand=!1,(t||e)&&(a=this.start,l=this.startLoc),t||(o=this.eat(b.star))),this.parsePropertyName(c),t||!(this.options.ecmaVersion>=8)||o||c.computed||"Identifier"!==c.key.type||"async"!==c.key.name||this.type===b.parenL||this.type===b.colon||this.canInsertSemicolon()?s=!1:(s=!0,this.parsePropertyName(c,e)),this.parsePropertyValue(c,t,o,s,a,l,e),this.checkPropClash(c,n),r.properties.push(this.finishNode(c,"Property"))}return this.finishNode(r,t?"ObjectPattern":"ObjectExpression")},z.parsePropertyValue=function(t,e,r,i,n,o,s){if((r||i)&&this.type===b.colon&&this.unexpected(),this.eat(b.colon))t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,s),t.kind="init";else if(this.options.ecmaVersion>=6&&this.type===b.parenL)e&&this.unexpected(),t.kind="init",t.method=!0,t.value=this.parseMethod(r,i);else if(this.options.ecmaVersion>=5&&!t.computed&&"Identifier"===t.key.type&&("get"===t.key.name||"set"===t.key.name)&&this.type!=b.comma&&this.type!=b.braceR){(r||i||e)&&this.unexpected(),t.kind=t.key.name,this.parsePropertyName(t),t.value=this.parseMethod(!1);var a="get"===t.kind?0:1;if(t.value.params.length!==a){var l=t.value.start;"get"===t.kind?this.raiseRecoverable(l,"getter should have no params"):this.raiseRecoverable(l,"setter should have exactly one param")}else"set"===t.kind&&"RestElement"===t.value.params[0].type&&this.raiseRecoverable(t.value.params[0].start,"Setter cannot use rest params")}else this.options.ecmaVersion>=6&&!t.computed&&"Identifier"===t.key.type?((this.keywords.test(t.key.name)||(this.strict?this.reservedWordsStrict:this.reservedWords).test(t.key.name)||this.inGenerator&&"yield"==t.key.name||this.inAsync&&"await"==t.key.name)&&this.raiseRecoverable(t.key.start,"'"+t.key.name+"' can not be used as shorthand property"),t.kind="init",e?t.value=this.parseMaybeDefault(n,o,t.key):this.type===b.eq&&s?(s.shorthandAssign<0&&(s.shorthandAssign=this.start),t.value=this.parseMaybeDefault(n,o,t.key)):t.value=t.key,t.shorthand=!0):this.unexpected()},z.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(b.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(b.bracketR),t.key;t.computed=!1}return t.key=this.type===b.num||this.type===b.string?this.parseExprAtom():this.parseIdent(!0)},z.initFunction=function(t){t.id=null,this.options.ecmaVersion>=6&&(t.generator=!1,t.expression=!1),this.options.ecmaVersion>=8&&(t.async=!1)},z.parseMethod=function(t,e){var r=this.startNode(),i=this.inGenerator,n=this.inAsync,o=this.yieldPos,s=this.awaitPos,a=this.inFunction;return this.initFunction(r),this.options.ecmaVersion>=6&&(r.generator=t),this.options.ecmaVersion>=8&&(r.async=!!e),this.inGenerator=r.generator,this.inAsync=r.async,this.yieldPos=0,this.awaitPos=0,this.inFunction=!0,this.expect(b.parenL),r.params=this.parseBindingList(b.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(r,!1),this.inGenerator=i,this.inAsync=n,this.yieldPos=o,this.awaitPos=s,this.inFunction=a,this.finishNode(r,"FunctionExpression")},z.parseArrowExpression=function(t,e,r){var i=this.inGenerator,n=this.inAsync,o=this.yieldPos,s=this.awaitPos,a=this.inFunction;return this.initFunction(t),this.options.ecmaVersion>=8&&(t.async=!!r),this.inGenerator=!1,this.inAsync=t.async,this.yieldPos=0,this.awaitPos=0,this.inFunction=!0,t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0),this.inGenerator=i,this.inAsync=n,this.yieldPos=o,this.awaitPos=s,this.inFunction=a,this.finishNode(t,"ArrowFunctionExpression")},z.parseFunctionBody=function(t,e){var r=e&&this.type!==b.braceL,i=this.strict,n=!1;if(r)t.body=this.parseMaybeAssign(),t.expression=!0;else{var o=this.options.ecmaVersion>=7&&!this.isSimpleParamList(t.params);i&&!o||(n=this.strictDirective(this.end))&&o&&this.raiseRecoverable(t.start,"Illegal 'use strict' directive in function with non-simple parameter list");var s=this.labels;this.labels=[],n&&(this.strict=!0),t.body=this.parseBlock(!0),t.expression=!1,this.labels=s}i||n?(this.strict=!0,t.id&&this.checkLVal(t.id,!0),this.checkParams(t),this.strict=i):!e&&this.isSimpleParamList(t.params)||this.checkParams(t)},z.isSimpleParamList=function(t){for(var e=0;e<t.length;e++)if("Identifier"!==t[e].type)return!1;return!0},z.checkParams=function(t){for(var e={},r=0;r<t.params.length;r++)this.checkLVal(t.params[r],!0,e)},z.parseExprList=function(t,e,r,i){for(var n=[],o=!0;!this.eat(t);){if(o)o=!1;else if(this.expect(b.comma),e&&this.afterTrailingComma(t))break;var s;r&&this.type===b.comma?s=null:this.type===b.ellipsis?(s=this.parseSpread(i),i&&this.type===b.comma&&i.trailingComma<0&&(i.trailingComma=this.start)):s=this.parseMaybeAssign(!1,i),n.push(s)}return n},z.parseIdent=function(t){var e=this.startNode();return t&&"never"==this.options.allowReserved&&(t=!1),this.type===b.name?(!t&&(this.strict?this.reservedWordsStrict:this.reservedWords).test(this.value)&&(this.options.ecmaVersion>=6||-1==this.input.slice(this.start,this.end).indexOf("\\"))&&this.raiseRecoverable(this.start,"The keyword '"+this.value+"' is reserved"),this.inGenerator&&"yield"===this.value&&this.raiseRecoverable(this.start,"Can not use 'yield' as identifier inside a generator"),this.inAsync&&"await"===this.value&&this.raiseRecoverable(this.start,"Can not use 'await' as identifier inside an async function"),e.name=this.value):t&&this.type.keyword?e.name=this.type.keyword:this.unexpected(),this.next(),this.finishNode(e,"Identifier")},z.parseYield=function(){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type==b.semi||this.canInsertSemicolon()||this.type!=b.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(b.star),t.argument=this.parseMaybeAssign()),this.finishNode(t,"YieldExpression")},z.parseAwait=function(){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0),this.finishNode(t,"AwaitExpression")};var Y=M.prototype;Y.raise=function(t,e){var r=A(this.input,t);e+=" ("+r.line+":"+r.column+")";var i=new SyntaxError(e);throw i.pos=t,i.loc=r,i.raisedAt=this.pos,i},Y.raiseRecoverable=Y.raise,Y.curPosition=function(){if(this.options.locations)return new P(this.curLine,this.pos-this.lineStart)};var G=function(t,e,r){this.type="",this.start=e,this.end=0,t.options.locations&&(this.loc=new T(t,r)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[e,0])},q=M.prototype;function X(t,e,r,i){return t.type=e,t.end=r,this.options.locations&&(t.loc.end=i),this.options.ranges&&(t.range[1]=r),t}q.startNode=function(){return new G(this,this.start,this.startLoc)},q.startNodeAt=function(t,e){return new G(this,t,e)},q.finishNode=function(t,e){return X.call(this,t,e,this.lastTokEnd,this.lastTokEndLoc)},q.finishNodeAt=function(t,e,r,i){return X.call(this,t,e,r,i)};var K=function(t,e,r,i){this.token=t,this.isExpr=!!e,this.preserveSpace=!!r,this.override=i},$={b_stat:new K("{",!1),b_expr:new K("{",!0),b_tmpl:new K("${",!0),p_stat:new K("(",!1),p_expr:new K("(",!0),q_tmpl:new K("`",!0,!0,function(t){return t.readTmplToken()}),f_expr:new K("function",!0)},J=M.prototype;J.initialContext=function(){return[$.b_stat]},J.braceIsBlock=function(t){if(t===b.colon){var e=this.curContext();if(e===$.b_stat||e===$.b_expr)return!e.isExpr}return t===b._return?w.test(this.input.slice(this.lastTokEnd,this.start)):t===b._else||t===b.semi||t===b.eof||t===b.parenR||(t==b.braceL?this.curContext()===$.b_stat:!this.exprAllowed)},J.updateContext=function(t){var e,r=this.type;r.keyword&&t==b.dot?this.exprAllowed=!1:(e=r.updateContext)?e.call(this,t):this.exprAllowed=r.beforeExpr},b.parenR.updateContext=b.braceR.updateContext=function(){if(1!=this.context.length){var t=this.context.pop();t===$.b_stat&&this.curContext()===$.f_expr?(this.context.pop(),this.exprAllowed=!1):this.exprAllowed=t===$.b_tmpl||!t.isExpr}else this.exprAllowed=!0},b.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?$.b_stat:$.b_expr),this.exprAllowed=!0},b.dollarBraceL.updateContext=function(){this.context.push($.b_tmpl),this.exprAllowed=!0},b.parenL.updateContext=function(t){var e=t===b._if||t===b._for||t===b._with||t===b._while;this.context.push(e?$.p_stat:$.p_expr),this.exprAllowed=!0},b.incDec.updateContext=function(){},b._function.updateContext=function(t){t.beforeExpr&&t!==b.semi&&t!==b._else&&(t!==b.colon&&t!==b.braceL||this.curContext()!==$.b_stat)&&this.context.push($.f_expr),this.exprAllowed=!1},b.backQuote.updateContext=function(){this.curContext()===$.q_tmpl?this.context.pop():this.context.push($.q_tmpl),this.exprAllowed=!1};var Z=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new T(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},Q=M.prototype,tt="object"==typeof Packages&&"[object JavaPackage]"==Object.prototype.toString.call(Packages);function et(t,e,r,i){try{return new RegExp(t,e)}catch(t){if(void 0!==r)throw t instanceof SyntaxError&&i.raise(r,"Error parsing regular expression: "+t.message),t}}Q.next=function(){this.options.onToken&&this.options.onToken(new Z(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},Q.getToken=function(){return this.next(),new Z(this)},"undefined"!=typeof Symbol&&(Q[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===b.eof,value:e}}}}),Q.curContext=function(){return this.context[this.context.length-1]},Q.nextToken=function(){var t=this.curContext();return t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(b.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},Q.readToken=function(t){return h(t,this.options.ecmaVersion>=6)||92===t?this.readWord():this.getTokenFromCode(t)},Q.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);if(t<=55295||t>=57344)return t;var e=this.input.charCodeAt(this.pos+1);return(t<<10)+e-56613888},Q.skipBlockComment=function(){var t,e=this.options.onComment&&this.curPosition(),r=this.pos,i=this.input.indexOf("*/",this.pos+=2);if(-1===i&&this.raise(this.pos-2,"Unterminated comment"),this.pos=i+2,this.options.locations)for(x.lastIndex=r;(t=x.exec(this.input))&&t.index<this.pos;)++this.curLine,this.lineStart=t.index+t[0].length;this.options.onComment&&this.options.onComment(!0,this.input.slice(r+2,i),r,this.pos,e,this.curPosition())},Q.skipLineComment=function(t){for(var e=this.pos,r=this.options.onComment&&this.curPosition(),i=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&10!==i&&13!==i&&8232!==i&&8233!==i;)++this.pos,i=this.input.charCodeAt(this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+t,this.pos),e,this.pos,r,this.curPosition())},Q.skipSpace=function(){t:for(;this.pos<this.input.length;){var t=this.input.charCodeAt(this.pos);switch(t){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(!(t>8&&t<14||t>=5760&&S.test(String.fromCharCode(t))))break t;++this.pos}}},Q.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var r=this.type;this.type=t,this.value=e,this.updateContext(r)},Q.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===t&&46===e?(this.pos+=3,this.finishToken(b.ellipsis)):(++this.pos,this.finishToken(b.dot))},Q.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(b.assign,2):this.finishOp(b.slash,1)},Q.readToken_mult_modulo_exp=function(t){var e=this.input.charCodeAt(this.pos+1),r=1,i=42===t?b.star:b.modulo;return this.options.ecmaVersion>=7&&42===e&&(++r,i=b.starstar,e=this.input.charCodeAt(this.pos+2)),61===e?this.finishOp(b.assign,r+1):this.finishOp(i,r)},Q.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?this.finishOp(124===t?b.logicalOR:b.logicalAND,2):61===e?this.finishOp(b.assign,2):this.finishOp(124===t?b.bitwiseOR:b.bitwiseAND,1)},Q.readToken_caret=function(){var t=this.input.charCodeAt(this.pos+1);return 61===t?this.finishOp(b.assign,2):this.finishOp(b.bitwiseXOR,1)},Q.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?45==e&&62==this.input.charCodeAt(this.pos+2)&&w.test(this.input.slice(this.lastTokEnd,this.pos))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(b.incDec,2):61===e?this.finishOp(b.assign,2):this.finishOp(b.plusMin,1)},Q.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),r=1;return e===t?(r=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+r)?this.finishOp(b.assign,r+1):this.finishOp(b.bitShift,r)):33==e&&60==t&&45==this.input.charCodeAt(this.pos+2)&&45==this.input.charCodeAt(this.pos+3)?(this.inModule&&this.unexpected(),this.skipLineComment(4),this.skipSpace(),this.nextToken()):(61===e&&(r=2),this.finishOp(b.relational,r))},Q.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(b.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===e&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(b.arrow)):this.finishOp(61===t?b.eq:b.prefix,1)},Q.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(b.parenL);case 41:return++this.pos,this.finishToken(b.parenR);case 59:return++this.pos,this.finishToken(b.semi);case 44:return++this.pos,this.finishToken(b.comma);case 91:return++this.pos,this.finishToken(b.bracketL);case 93:return++this.pos,this.finishToken(b.bracketR);case 123:return++this.pos,this.finishToken(b.braceL);case 125:return++this.pos,this.finishToken(b.braceR);case 58:return++this.pos,this.finishToken(b.colon);case 63:return++this.pos,this.finishToken(b.question);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(b.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(120===e||88===e)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===e||79===e)return this.readRadixNumber(8);if(98===e||66===e)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 126:return this.finishOp(b.prefix,1)}this.raise(this.pos,"Unexpected character '"+it(t)+"'")},Q.finishOp=function(t,e){var r=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,r)};var rt=!!et("￿","u");function it(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}Q.readRegexp=function(){for(var t,e,r=this,i=this.pos;;){r.pos>=r.input.length&&r.raise(i,"Unterminated regular expression");var n=r.input.charAt(r.pos);if(w.test(n)&&r.raise(i,"Unterminated regular expression"),t)t=!1;else{if("["===n)e=!0;else if("]"===n&&e)e=!1;else if("/"===n&&!e)break;t="\\"===n}++r.pos}var o=this.input.slice(i,this.pos);++this.pos;var s=this.readWord1(),a=o,l="";if(s){var c=/^[gim]*$/;this.options.ecmaVersion>=6&&(c=/^[gimuy]*$/),c.test(s)||this.raise(i,"Invalid regular expression flag"),s.indexOf("u")>=0&&(rt?l="u":(a=(a=a.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(t,e,n){return(e=Number("0x"+e))>1114111&&r.raise(i+n+3,"Code point out of bounds"),"x"})).replace(/\\u([a-fA-F0-9]{4})|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"),l=l.replace("u","")))}var u=null;return tt||(et(a,l,i,this),u=et(o,s)),this.finishToken(b.regexp,{pattern:o,flags:s,value:u})},Q.readInt=function(t,e){for(var r=this.pos,i=0,n=0,o=null==e?1/0:e;n<o;++n){var s,a=this.input.charCodeAt(this.pos);if((s=a>=97?a-97+10:a>=65?a-65+10:a>=48&&a<=57?a-48:1/0)>=t)break;++this.pos,i=i*t+s}return this.pos===r||null!=e&&this.pos-r!==e?null:i},Q.readRadixNumber=function(t){this.pos+=2;var e=this.readInt(t);return null==e&&this.raise(this.start+2,"Expected number in radix "+t),h(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(b.num,e)},Q.readNumber=function(t){var e=this.pos,r=!1,i=48===this.input.charCodeAt(this.pos);t||null!==this.readInt(10)||this.raise(e,"Invalid number"),i&&this.pos==e+1&&(i=!1);var n=this.input.charCodeAt(this.pos);46!==n||i||(++this.pos,this.readInt(10),r=!0,n=this.input.charCodeAt(this.pos)),69!==n&&101!==n||i||(43!==(n=this.input.charCodeAt(++this.pos))&&45!==n||++this.pos,null===this.readInt(10)&&this.raise(e,"Invalid number"),r=!0),h(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var o,s=this.input.slice(e,this.pos);return r?o=parseFloat(s):i&&1!==s.length?/[89]/.test(s)||this.strict?this.raise(e,"Invalid number"):o=parseInt(s,8):o=parseInt(s,10),this.finishToken(b.num,o)},Q.readCodePoint=function(){var t,e=this.input.charCodeAt(this.pos);if(123===e){this.options.ecmaVersion<6&&this.unexpected();var r=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.raise(r,"Code point out of bounds")}else t=this.readHexChar(4);return t},Q.readString=function(t){for(var e="",r=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var i=this.input.charCodeAt(this.pos);if(i===t)break;92===i?(e+=this.input.slice(r,this.pos),e+=this.readEscapedChar(!1),r=this.pos):(k(i)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(r,this.pos++),this.finishToken(b.string,e)},Q.readTmplToken=function(){for(var t="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var r=this.input.charCodeAt(this.pos);if(96===r||36===r&&123===this.input.charCodeAt(this.pos+1))return this.pos===this.start&&this.type===b.template?36===r?(this.pos+=2,this.finishToken(b.dollarBraceL)):(++this.pos,this.finishToken(b.backQuote)):(t+=this.input.slice(e,this.pos),this.finishToken(b.template,t));if(92===r)t+=this.input.slice(e,this.pos),t+=this.readEscapedChar(!0),e=this.pos;else if(k(r)){switch(t+=this.input.slice(e,this.pos),++this.pos,r){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:t+="\n";break;default:t+=String.fromCharCode(r)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}},Q.readEscapedChar=function(t){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return it(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";default:if(e>=48&&e<=55){var r=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],i=parseInt(r,8);return i>255&&(r=r.slice(0,-1),i=parseInt(r,8)),"0"!==r&&(this.strict||t)&&this.raise(this.pos-2,"Octal literal in strict mode"),this.pos+=r.length-1,String.fromCharCode(i)}return String.fromCharCode(e)}},Q.readHexChar=function(t){var e=this.pos,r=this.readInt(16,t);return null===r&&this.raise(e,"Bad character escape sequence"),r},Q.readWord1=function(){this.containsEsc=!1;for(var t="",e=!0,r=this.pos,i=this.options.ecmaVersion>=6;this.pos<this.input.length;){var n=this.fullCharCodeAtPos();if(p(n,i))this.pos+=n<=65535?1:2;else{if(92!==n)break;this.containsEsc=!0,t+=this.input.slice(r,this.pos);var o=this.pos;117!=this.input.charCodeAt(++this.pos)&&this.raise(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var s=this.readCodePoint();(e?h:p)(s,i)||this.raise(o,"Invalid Unicode escape"),t+=it(s),r=this.pos}e=!1}return t+this.input.slice(r,this.pos)},Q.readWord=function(){var t=this.readWord1(),e=b.name;return this.keywords.test(t)&&(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+t),e=m[t]),this.finishToken(e,t)},t.version="4.0.11",t.parse=function(t,e){return new M(e,t).parse()},t.parseExpressionAt=function(t,e,r){var i=new M(r,t,e);return i.nextToken(),i.parseExpression()},t.tokenizer=function(t,e){return new M(e,t)},t.addLooseExports=function(e,r,i){t.parse_dammit=e,t.LooseParser=r,t.pluginsLoose=i},t.Parser=M,t.plugins=L,t.defaultOptions=R,t.Position=P,t.SourceLocation=T,t.getLineInfo=A,t.Node=G,t.TokenType=f,t.tokTypes=b,t.keywordTypes=m,t.TokContext=K,t.tokContexts=$,t.isIdentifierChar=p,t.isIdentifierStart=h,t.Token=Z,t.isNewLine=k,t.lineBreak=w,t.lineBreakG=x,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,r){"use strict";e.byteLength=function(t){return 3*t.length/4-c(t)},e.toByteArray=function(t){var e,r,i,s,a,l,u=t.length;a=c(t),l=new o(3*u/4-a),i=a>0?u-4:u;var h=0;for(e=0,r=0;e<i;e+=4,r+=3)s=n[t.charCodeAt(e)]<<18|n[t.charCodeAt(e+1)]<<12|n[t.charCodeAt(e+2)]<<6|n[t.charCodeAt(e+3)],l[h++]=s>>16&255,l[h++]=s>>8&255,l[h++]=255&s;2===a?(s=n[t.charCodeAt(e)]<<2|n[t.charCodeAt(e+1)]>>4,l[h++]=255&s):1===a&&(s=n[t.charCodeAt(e)]<<10|n[t.charCodeAt(e+1)]<<4|n[t.charCodeAt(e+2)]>>2,l[h++]=s>>8&255,l[h++]=255&s);return l},e.fromByteArray=function(t){for(var e,r=t.length,n=r%3,o="",s=[],a=0,l=r-n;a<l;a+=16383)s.push(u(t,a,a+16383>l?l:a+16383));1===n?(e=t[r-1],o+=i[e>>2],o+=i[e<<4&63],o+="=="):2===n&&(e=(t[r-2]<<8)+t[r-1],o+=i[e>>10],o+=i[e>>4&63],o+=i[e<<2&63],o+="=");return s.push(o),s.join("")};for(var i=[],n=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,l=s.length;a<l;++a)i[a]=s[a],n[s.charCodeAt(a)]=a;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function u(t,e,r){for(var n,o,s=[],a=e;a<r;a+=3)n=(t[a]<<16)+(t[a+1]<<8)+t[a+2],s.push(i[(o=n)>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},function(t,e,r){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var i=r(2),n=r(5),o=r(6);function s(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(t,e){if(s()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,r){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,r);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return h(this,t)}return c(this,t,e,r)}function c(t,e,r,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,r,i){if(e.byteLength,r<0||e.byteLength<r)throw new RangeError("'offset' is out of bounds");if(e.byteLength<r+(i||0))throw new RangeError("'length' is out of bounds");e=void 0===r&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,r):new Uint8Array(e,r,i);l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=p(t,e);return t}(t,e,r,i):"string"==typeof e?function(t,e,r){"string"==typeof r&&""!==r||(r="utf8");if(!l.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var i=0|d(e,r),n=(t=a(t,i)).write(e,r);n!==i&&(t=t.slice(0,n));return t}(t,e,r):function(t,e){if(l.isBuffer(e)){var r=0|f(e.length);return 0===(t=a(t,r)).length?t:(e.copy(t,0,0,r),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?a(t,0):p(t,e);if("Buffer"===e.type&&o(e.data))return p(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e){if(u(e),t=a(t,e<0?0:0|f(e)),!l.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)t[r]=0;return t}function p(t,e){var r=e.length<0?0:0|f(e.length);t=a(t,r);for(var i=0;i<r;i+=1)t[i]=255&e[i];return t}function f(t){if(t>=s())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s().toString(16)+" bytes");return 0|t}function d(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var r=t.length;if(0===r)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return j(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return W(t).length;default:if(i)return j(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function v(t,e,r,i,n){if(0===t.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof e&&(e=l.from(e,i)),l.isBuffer(e))return 0===e.length?-1:m(t,e,r,i,n);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):m(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function m(t,e,r,i,n){var o,s=1,a=t.length,l=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;s=2,a/=2,l/=2,r/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(n){var u=-1;for(o=r;o<a;o++)if(c(t,o)===c(e,-1===u?0:o-u)){if(-1===u&&(u=o),o-u+1===l)return u*s}else-1!==u&&(o-=o-u),u=-1}else for(r+l>a&&(r=a-l),o=r;o>=0;o--){for(var h=!0,p=0;p<l;p++)if(c(t,o+p)!==c(e,p)){h=!1;break}if(h)return o}return-1}function y(t,e,r,i){r=Number(r)||0;var n=t.length-r;i?(i=Number(i))>n&&(i=n):i=n;var o=e.length;if(o%2!=0)throw new TypeError("Invalid hex string");i>o/2&&(i=o/2);for(var s=0;s<i;++s){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))return s;t[r+s]=a}return s}function b(t,e,r,i){return V(j(e,t.length-r),t,r,i)}function w(t,e,r,i){return V(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,i)}function x(t,e,r,i){return w(t,e,r,i)}function k(t,e,r,i){return V(W(e),t,r,i)}function S(t,e,r,i){return V(function(t,e){for(var r,i,n,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),i=r>>8,n=r%256,o.push(n),o.push(i);return o}(e,t.length-r),t,r,i)}function E(t,e,r){return 0===e&&r===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,r))}function C(t,e,r){r=Math.min(t.length,r);for(var i=[],n=e;n<r;){var o,s,a,l,c=t[n],u=null,h=c>239?4:c>223?3:c>191?2:1;if(n+h<=r)switch(h){case 1:c<128&&(u=c);break;case 2:128==(192&(o=t[n+1]))&&(l=(31&c)<<6|63&o)>127&&(u=l);break;case 3:o=t[n+1],s=t[n+2],128==(192&o)&&128==(192&s)&&(l=(15&c)<<12|(63&o)<<6|63&s)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:o=t[n+1],s=t[n+2],a=t[n+3],128==(192&o)&&128==(192&s)&&128==(192&a)&&(l=(15&c)<<18|(63&o)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(u=l)}null===u?(u=65533,h=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),n+=h}return function(t){var e=t.length;if(e<=N)return String.fromCharCode.apply(String,t);var r="",i=0;for(;i<e;)r+=String.fromCharCode.apply(String,t.slice(i,i+=N));return r}(i)}e.Buffer=l,e.SlowBuffer=function(t){+t!=t&&(t=0);return l.alloc(+t)},e.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=s(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,r){return c(null,t,e,r)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,r){return function(t,e,r,i){return u(e),e<=0?a(t,e):void 0!==r?"string"==typeof i?a(t,e).fill(r,i):a(t,e).fill(r):a(t,e)}(null,t,e,r)},l.allocUnsafe=function(t){return h(null,t)},l.allocUnsafeSlow=function(t){return h(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,i=e.length,n=0,o=Math.min(r,i);n<o;++n)if(t[n]!==e[n]){r=t[n],i=e[n];break}return r<i?-1:i<r?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!o(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var i=l.allocUnsafe(e),n=0;for(r=0;r<t.length;++r){var s=t[r];if(!l.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,n),n+=s.length}return i},l.byteLength=d,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)g(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?C(this,0,t):function(t,e,r){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return A(this,e,r);case"utf8":case"utf-8":return C(this,e,r);case"ascii":return P(this,e,r);case"latin1":case"binary":return T(this,e,r);case"base64":return E(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,r,i,n){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),e<0||r>t.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&e>=r)return 0;if(i>=n)return-1;if(e>=r)return 1;if(this===t)return 0;for(var o=(n>>>=0)-(i>>>=0),s=(r>>>=0)-(e>>>=0),a=Math.min(o,s),c=this.slice(i,n),u=t.slice(e,r),h=0;h<a;++h)if(c[h]!==u[h]){o=c[h],s=u[h];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},l.prototype.indexOf=function(t,e,r){return v(this,t,e,r,!0)},l.prototype.lastIndexOf=function(t,e,r){return v(this,t,e,r,!1)},l.prototype.write=function(t,e,r,i){if(void 0===e)i="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)i=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(r)?(r|=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-e;if((void 0===r||r>n)&&(r=n),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var o=!1;;)switch(i){case"hex":return y(this,t,e,r);case"utf8":case"utf-8":return b(this,t,e,r);case"ascii":return w(this,t,e,r);case"latin1":case"binary":return x(this,t,e,r);case"base64":return k(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var N=4096;function P(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(127&t[n]);return i}function T(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function A(t,e,r){var i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);for(var n="",o=e;o<r;++o)n+=U(t[o]);return n}function R(t,e,r){for(var i=t.slice(e,r),n="",o=0;o<i.length;o+=2)n+=String.fromCharCode(i[o]+256*i[o+1]);return n}function O(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function L(t,e,r,i,n,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<o)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}function _(t,e,r,i){e<0&&(e=65535+e+1);for(var n=0,o=Math.min(t.length-r,2);n<o;++n)t[r+n]=(e&255<<8*(i?n:1-n))>>>8*(i?n:1-n)}function M(t,e,r,i){e<0&&(e=4294967295+e+1);for(var n=0,o=Math.min(t.length-r,4);n<o;++n)t[r+n]=e>>>8*(i?n:3-n)&255}function I(t,e,r,i,n,o){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function D(t,e,r,i,o){return o||I(t,0,r,4),n.write(t,e,r,i,23,4),r+4}function F(t,e,r,i,o){return o||I(t,0,r,8),n.write(t,e,r,i,52,8),r+8}l.prototype.slice=function(t,e){var r,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(r=this.subarray(t,e)).__proto__=l.prototype;else{var n=e-t;r=new l(n,void 0);for(var o=0;o<n;++o)r[o]=this[o+t]}return r},l.prototype.readUIntLE=function(t,e,r){t|=0,e|=0,r||O(t,e,this.length);for(var i=this[t],n=1,o=0;++o<e&&(n*=256);)i+=this[t+o]*n;return i},l.prototype.readUIntBE=function(t,e,r){t|=0,e|=0,r||O(t,e,this.length);for(var i=this[t+--e],n=1;e>0&&(n*=256);)i+=this[t+--e]*n;return i},l.prototype.readUInt8=function(t,e){return e||O(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||O(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||O(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,r){t|=0,e|=0,r||O(t,e,this.length);for(var i=this[t],n=1,o=0;++o<e&&(n*=256);)i+=this[t+o]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*e)),i},l.prototype.readIntBE=function(t,e,r){t|=0,e|=0,r||O(t,e,this.length);for(var i=e,n=1,o=this[t+--i];i>0&&(n*=256);)o+=this[t+--i]*n;return o>=(n*=128)&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||O(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(t,e){e||O(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(t,e){return e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||O(t,4,this.length),n.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||O(t,4,this.length),n.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||O(t,8,this.length),n.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||O(t,8,this.length),n.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,r,i){(t=+t,e|=0,r|=0,i)||L(this,t,e,r,Math.pow(2,8*r)-1,0);var n=1,o=0;for(this[e]=255&t;++o<r&&(n*=256);)this[e+o]=t/n&255;return e+r},l.prototype.writeUIntBE=function(t,e,r,i){(t=+t,e|=0,r|=0,i)||L(this,t,e,r,Math.pow(2,8*r)-1,0);var n=r-1,o=1;for(this[e+n]=255&t;--n>=0&&(o*=256);)this[e+n]=t/o&255;return e+r},l.prototype.writeUInt8=function(t,e,r){return t=+t,e|=0,r||L(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,r){return t=+t,e|=0,r||L(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):_(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,r){return t=+t,e|=0,r||L(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):_(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,r){return t=+t,e|=0,r||L(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):M(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,r){return t=+t,e|=0,r||L(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,r,i){if(t=+t,e|=0,!i){var n=Math.pow(2,8*r-1);L(this,t,e,r,n-1,-n)}var o=0,s=1,a=0;for(this[e]=255&t;++o<r&&(s*=256);)t<0&&0===a&&0!==this[e+o-1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},l.prototype.writeIntBE=function(t,e,r,i){if(t=+t,e|=0,!i){var n=Math.pow(2,8*r-1);L(this,t,e,r,n-1,-n)}var o=r-1,s=1,a=0;for(this[e+o]=255&t;--o>=0&&(s*=256);)t<0&&0===a&&0!==this[e+o+1]&&(a=1),this[e+o]=(t/s>>0)-a&255;return e+r},l.prototype.writeInt8=function(t,e,r){return t=+t,e|=0,r||L(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,r){return t=+t,e|=0,r||L(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):_(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,r){return t=+t,e|=0,r||L(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):_(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,r){return t=+t,e|=0,r||L(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):M(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,r){return t=+t,e|=0,r||L(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):M(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,r){return D(this,t,e,!0,r)},l.prototype.writeFloatBE=function(t,e,r){return D(this,t,e,!1,r)},l.prototype.writeDoubleLE=function(t,e,r){return F(this,t,e,!0,r)},l.prototype.writeDoubleBE=function(t,e,r){return F(this,t,e,!1,r)},l.prototype.copy=function(t,e,r,i){if(r||(r=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var n,o=i-r;if(this===t&&r<e&&e<i)for(n=o-1;n>=0;--n)t[n+e]=this[n+r];else if(o<1e3||!l.TYPED_ARRAY_SUPPORT)for(n=0;n<o;++n)t[n+e]=this[n+r];else Uint8Array.prototype.set.call(t,this.subarray(r,r+o),e);return o},l.prototype.fill=function(t,e,r,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),1===t.length){var n=t.charCodeAt(0);n<256&&(t=n)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var o;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(o=e;o<r;++o)this[o]=t;else{var s=l.isBuffer(t)?t:j(new l(t,i).toString()),a=s.length;for(o=0;o<r-e;++o)this[o+e]=s[o%a]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function U(t){return t<16?"0"+t.toString(16):t.toString(16)}function j(t,e){var r;e=e||1/0;for(var i=t.length,n=null,o=[],s=0;s<i;++s){if((r=t.charCodeAt(s))>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===i){(e-=3)>-1&&o.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(e-=3)>-1&&o.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function W(t){return i.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function V(t,e,r,i){for(var n=0;n<i&&!(n+r>=e.length||n>=t.length);++n)e[n+r]=t[n];return n}}).call(e,r(7))},function(t,e,r){(function(e){var r=function(){"use strict";function t(t,e){return null!=e&&t instanceof e}var r,i,n;try{r=Map}catch(t){r=function(){}}try{i=Set}catch(t){i=function(){}}try{n=Promise}catch(t){n=function(){}}function o(s,l,c,u,h){"object"==typeof l&&(c=l.depth,u=l.prototype,h=l.includeNonEnumerable,l=l.circular);var p=[],f=[],d=void 0!==e;return void 0===l&&(l=!0),void 0===c&&(c=1/0),function s(c,g){if(null===c)return null;if(0===g)return c;var v,m;if("object"!=typeof c)return c;if(t(c,r))v=new r;else if(t(c,i))v=new i;else if(t(c,n))v=new n(function(t,e){c.then(function(e){t(s(e,g-1))},function(t){e(s(t,g-1))})});else if(o.__isArray(c))v=[];else if(o.__isRegExp(c))v=new RegExp(c.source,a(c)),c.lastIndex&&(v.lastIndex=c.lastIndex);else if(o.__isDate(c))v=new Date(c.getTime());else{if(d&&e.isBuffer(c))return v=new e(c.length),c.copy(v),v;t(c,Error)?v=Object.create(c):void 0===u?(m=Object.getPrototypeOf(c),v=Object.create(m)):(v=Object.create(u),m=u)}if(l){var y=p.indexOf(c);if(-1!=y)return f[y];p.push(c),f.push(v)}for(var b in t(c,r)&&c.forEach(function(t,e){var r=s(e,g-1),i=s(t,g-1);v.set(r,i)}),t(c,i)&&c.forEach(function(t){var e=s(t,g-1);v.add(e)}),c){var w;m&&(w=Object.getOwnPropertyDescriptor(m,b)),Object.keys(c).indexOf(b)<0&&w&&null==w.set||(v[b]=s(c[b],g-1))}if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(c);for(b=0;b<x.length;b++){var k=x[b];(!(E=Object.getOwnPropertyDescriptor(c,k))||E.enumerable||h)&&(v[k]=s(c[k],g-1),E.enumerable||Object.defineProperty(v,k,{enumerable:!1}))}}if(h){var S=Object.getOwnPropertyNames(c);for(b=0;b<S.length;b++){var E,C=S[b];(E=Object.getOwnPropertyDescriptor(c,C))&&E.enumerable||(v[C]=s(c[C],g-1),Object.defineProperty(v,C,{enumerable:!1}))}}return v}(s,c)}function s(t){return Object.prototype.toString.call(t)}function a(t){var e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),e}return o.clonePrototype=function(t){if(null===t)return null;var e=function(){};return e.prototype=t,new e},o.__objToStr=s,o.__isDate=function(t){return"object"==typeof t&&"[object Date]"===s(t)},o.__isArray=function(t){return"object"==typeof t&&"[object Array]"===s(t)},o.__isRegExp=function(t){return"object"==typeof t&&"[object RegExp]"===s(t)},o.__getRegExpFlags=a,o}();"object"==typeof t&&t.exports&&(t.exports=r)}).call(e,r(3).Buffer)},function(t,e){e.read=function(t,e,r,i,n){var o,s,a=8*n-i-1,l=(1<<a)-1,c=l>>1,u=-7,h=r?n-1:0,p=r?-1:1,f=t[e+h];for(h+=p,o=f&(1<<-u)-1,f>>=-u,u+=a;u>0;o=256*o+t[e+h],h+=p,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=i;u>0;s=256*s+t[e+h],h+=p,u-=8);if(0===o)o=1-c;else{if(o===l)return s?NaN:1/0*(f?-1:1);s+=Math.pow(2,i),o-=c}return(f?-1:1)*s*Math.pow(2,o-i)},e.write=function(t,e,r,i,n,o){var s,a,l,c=8*o-n-1,u=(1<<c)-1,h=u>>1,p=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:o-1,d=i?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?p/l:p*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(e*l-1)*Math.pow(2,n),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,n),s=0));n>=8;t[r+f]=255&a,f+=d,a/=256,n-=8);for(s=s<<n|a,c+=n;c>0;t[r+f]=255&s,f+=d,s/=256,c-=8);t[r+f-d]|=128*g}},function(t,e){var r={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){t.exports=r(0)}])},t.exports=i()},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(0),n=function(){function t(t,e){void 0===e&&(e=[]),this.painter=t,this.drawing=e}return t.prototype.update=function(e){return new t(e.painter?this.painter.update(e.painter):this.painter,e.drawing?this.drawing.concat(e.drawing):this.drawing)},t}();e.SceneState=n;var o=function(){function t(t,e,r){void 0===r&&(r=""),this.from=t,this.to=e,this.color=r,this.segment=new i.Segment(t,e)}return t.prototype.defaultColor=function(e){return this.color?this:new t(this.from,this.to,e)},t.prototype.draw=function(t,e){void 0===e&&(e=1),t.save(),this.color&&(t.strokeStyle=this.color),this.segment.scaled(e).draw(t),t.restore()},t}();e.Stroke=o;var s=function(){function t(t,e){var r=void 0===e?{}:e,i=r.position,n=void 0===i?t.position:i,o=r.facing,s=void 0===o?t.facing:o,a=r.height,l=void 0===a?t.height:a,c=r.opacity,u=void 0===c?t.opacity:c;this.position=n,this.facing=s,this.height=l,this.opacity=u}return Object.defineProperty(t.prototype,"facingRadians",{get:function(){return i.deg2rad(this.facing)},enumerable:!0,configurable:!0}),t.prototype.update=function(e){return new t(this,e)},t}();e.PainterState=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(0);e.ZOOM_DOWN=1,e.ZOOM_UP=1.5;var n=function(){function t(){this.position=i.Vector2d.ORIGIN,this.facing=0,this.z=e.ZOOM_DOWN,this.zoom=.5,this.scale=3.2,this.opacity=1,this.brushColor="black"}return t.prototype.update=function(t){this.position=t.position.scale(this.scale),this.facing=t.facing,this.z=e.ZOOM_DOWN+t.height*(e.ZOOM_UP-e.ZOOM_DOWN),this.opacity=t.opacity,this.brushColor=t.foreground},t.prototype.draw=function(t){var r=this.position.x,n=this.position.y,o=5*this.scale*this.zoom*this.z,s=3*this.scale*this.zoom*this.z;t.save(),t.translate(r,n),t.rotate(i.deg2rad(this.facing));var a=(this.z-e.ZOOM_DOWN)/(e.ZOOM_UP-e.ZOOM_DOWN);t.save(),t.strokeStyle=this.brushColor,t.globalAlpha=1-a,t.beginPath(),t.moveTo(0,0),t.lineTo(0,0),t.stroke(),t.restore();var l=160+95*(1-a)|0,c=160*a|0,u=160+95*(1-a)|0;t.strokeStyle="rgba("+l+","+c+","+u+","+this.opacity+")",t.beginPath(),t.moveTo(o,-s),t.lineTo(-o,-s),t.lineTo(0,s),t.lineTo(o,-s),t.stroke(),t.restore()},t}();e.Painter=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i,n,o=document.getElementById("load"),s=document.getElementById("save"),a=document.getElementById("disk"),l=document.getElementById("saves");function c(){l.innerHTML="",u().forEach(function(t){var e=t.name,r=document.createElement("li");e==n.name&&r.classList.add("currently-loaded"),r.textContent=e,r.addEventListener("click",function(){var t,r;(r=h(t=e))&&(g(r),i.setValue(r.code),alert('Save restored: "'+t+'"'),d(),c())}),l.appendChild(r);var o=document.createElement("a");o.classList.add("delete"),o.addEventListener("click",function(t){t.stopPropagation(),function(t){if(confirm('Delete "'+t+'" permanently?')){var e=u().filter(function(e){var r=e.name;return r!=t});localStorage.setItem("saves",JSON.stringify(e)),n.name==t&&g({code:n.code}),c()}}(e)}),r.appendChild(o)})}function u(){var t=localStorage.getItem("saves");return t?JSON.parse(t):[]}function h(t){return u().find(function(e){return e.name==t})}e.initialize=function(t){var e,r,o,s;i=t,n=JSON.parse(localStorage.getItem("ram")||'{"code":""}'),i.setValue(n.code),c(),i.on("change",(e=function(){return g(Object.assign(n,{code:i.getValue()}))},r=400,function(){var t=this,i=arguments,n=o&&!s;clearTimeout(s),s=setTimeout(function(){s=null,o||e.apply(t,i)},r),n&&e.apply(t,i)}))};var p="hidden";function f(){i.getWrapperElement().style.display="none",a.style.display="block",p="visible",o.className="red"}function d(){i.getWrapperElement().style.display=null,a.style.display=null,o.className="blue",p="hidden"}function g(t){n=t,localStorage.setItem("ram",JSON.stringify(t))}function v(t,e){g({name:t,code:e});var r=u().filter(function(e){return e.name!=t}).concat(n).sort(function(t,e){var r=t.name,i=e.name;return r.localeCompare(i)});localStorage.setItem("saves",JSON.stringify(r)),c()}function m(){var t;if(n&&n.name){if(t=n.name,confirm('Overwrite: "'+t+'" ?'))v(t,i.getValue());else if(t=prompt("Enter new name:")){if(h(t)&&!confirm('Overwrite: "'+t+'" ?'))return;v(t,i.getValue())}}else if(t=prompt("Enter name:")){if(h(t)&&!confirm('Overwrite: "'+t+'" ?'))return;v(t,i.getValue())}}o.addEventListener("click",function(){"hidden"==p?f():d()}),e.showDiskContent=f,s.addEventListener("click",m),e.saveOperation=m}]);
//# sourceMappingURL=app.js.map